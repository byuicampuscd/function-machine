"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;n>=e;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var e=$("<option></option>").append(n.name);$(e).val(n.equation),$("select").append(e)}$.getJSON("../funcMachineSettings.json",function(e){window.professorConfigFile=e,$.each(e,function(e,o){n(o),0===e&&changePlot(o.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 0;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:55,startLeftOff:300,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,a={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation},o={datapoints:[],currentRound:0,graphOpt:a};t.each(function(t){var n=+$(this).val();if(n){var e=a.equation.replace("x","("+n+")"),i=math.eval(e),f=(this.getBoundingClientRect(),{x:n,y:i,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});f.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,o.datapoints.push(f)}}),animatorControl(o)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,a){a.equation===t&&(n=a)}),n}function changePlot(t){window.profOpt=checkConfig(t);var n="y = ",e=""+t,a=$("#functionMachine #equ")[0],o=$("#functionMachine #y");$(a).empty(""),katex.render(n,o[0]),katex.render(e,a)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;inputCount>i;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(a){var e=a.datapoints[a.currentRound],i=e.element;return new Promise(function(e){$(i).html(t).css({animation:""+n+a.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){e(a)})})}}function statusMessage(n){return function(t){return new Promise(function(a){statusBar.html("<p>"+n+"</p>"),a(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],a=t.changeEqu;return new Promise(function(t){katex.render(""+a,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),a(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){var e=$("td#yval"+(t.id+1))[0];$(e).html(""),$(e).append("<p>"+t.y+"</p>"),a(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){n.currentRound+=1,t.updatePoint=!1,a(n)})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),a=Promise.resolve(n);t.innerHTML="",console.log(n),n.graphOpt.animateHide?noAniPromiseChain(n,a):aniPromiseChain(n,a)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwiZ2V0SlNPTiIsInJlc3VsdCIsIndpbmRvdyIsInByb2Zlc3NvckNvbmZpZ0ZpbGUiLCJlYWNoIiwiaSIsImNoYW5nZVBsb3QiLCJzdGFpclN0ZXAiLCJvcHRpb25zIiwiaGlnaHdheVBhdGgiLCJsYXN0U2hlZXQiLCJpbnNlcnRSdWxlIiwic3RhcnRUb3BPZmYiLCJzdGFydExlZnRPZmYiLCJlbmRUb3BPZmYiLCJlbmRMZWZ0T2ZmIiwiY3NzUnVsZXMiLCJsZW5ndGgiLCJtYWtlWFRvTWFjaGluZSIsImlucHV0Q29yZHMiLCJpbmRleCIsInRvcCIsImxlZnQiLCJtYWtlTWFjaGluZVRvWSIsInJpZ2h0IiwibWFrZVlUb1N0YXR1c0JhciIsInN0YXJ0RnVuY01hY2giLCJ4aW5wdXRzIiwiaGlkZUFuaW1hdGlvbkNoZWNrZWQiLCJoaWRlR3JhcGhDaGVja2VkIiwiZ3JhcGhPcHQiLCJjYWxsYmFjayIsImFuaVNldHRpbmdzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb25zb2xlIiwibG9nIiwiYW5pbWF0ZUhpZGUiLCJncmFwaEhpZGUiLCJwcm9mT3B0IiwiZGF0YXBvaW50cyIsImN1cnJlbnRSb3VuZCIsInh2YWwiLCJ0aGlzIiwicmVwbGFjZVgiLCJyZXBsYWNlIiwieXZhbCIsIm1hdGgiLCJldmFsIiwicG9pbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ4IiwieSIsImlkIiwiY2hhbmdlRXF1IiwidXBkYXRlUG9pbnQiLCJ4TWVtb3J5IiwiZWxlbWVudCIsImdldCIsImh0bWwiLCJwdXNoIiwiYW5pbWF0b3JDb250cm9sIiwiY2hlY2tDb25maWciLCJpdGVtIiwiZXF1YXQiLCJlcXVQYXJhIiwieVBhcmEiLCJlbXB0eSIsImthdGV4IiwicmVuZGVyIiwiaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0Q291bnQiLCJzdHlsZVNoZWV0cyIsImlucHV0Q29vciIsImNoYW5nZSIsImUiLCJ0YXJnZXQiLCJ2YWx1ZSIsImtleXByZXNzIiwid2hpY2giLCJjbGljayIsInJ1bkFuaW1hdGlvbiIsImRhdGFwb2ludCIsIm51bVBhcmEiLCJjc3MiLCJhbmltYXRpb24iLCJhbmlEdXJhdGlvbiIsIm9uZSIsInN0YXR1c01lc3NhZ2UiLCJtZXNzYWdlIiwic3RhdHVzQmFyIiwicmVwbGFjZVhFcXUiLCJkYXRhIiwic2hvd0V2YWx1YXRlRXF1IiwicG9pbnREYXRhIiwic2hvd1lBbnMiLCJzaG93RXF1YXRpb25BZ2FpbiIsInBsYWNlWVZhbHVlIiwicmVzZXRSb3VuZCIsInNob3dEZWZhdWx0RXF1IiwicGxvdHRlciIsInVwZGF0ZVJvdW5kIiwicGxhY2Vob2xkZXIiLCJhbmlQcm9taXNlQ2hhaW4iLCJkcHMiLCJjaGFpbiIsImZvckVhY2giLCJ0aGVuIiwibm9BbmlQcm9taXNlQ2hhaW4iLCJudW1Db250YWluZXIiLCJpbm5lckhUTUwiXSwibWFwcGluZ3MiOiJBQUFBLGNBQUMsV0FhRyxJQUFLLEdBTkRBLEdBQ0FDLEVBQ0FDLEVBQ0FDLEVBSkFDLEVBQVFDLEVBQUUsU0FLVkMsRUFBVyxHQUVOQyxFQUFJLEVBQVFELEdBQUxDLEVBQWVBLElBQzNCSixFQUFRRSxFQUFFLFdBQ1ZMLEVBQU1LLEVBQUUsYUFDUkosRUFBTUksRUFBRSxhQUNSSCxFQUFLRyxFQUFFLGFBRVBBLEVBQUVILEdBQUlNLEtBQUssS0FBWCxNQUF1QkQsR0FFdkJGLEVBQUVGLEdBQU9LLEtBQUssT0FBZCxRQUE4QkQsR0FBS0MsS0FBSyxPQUFRLFVBRWhESCxFQUFFSixHQUFLTyxLQUFLLEtBQVosT0FBeUJELEdB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IiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcbiAgICBNYWtlIHRoZSB3aG9sZSB0YWJsZSBhbmQgY2VsbHMgZm9yIHRoZSBpbnB1dCBib3hlcyBhbmQgdXNlciBpbnRlcmFjdGlvbi5cbiAgICAqL1xuICAgIHZhciB0Ym9keSA9ICQoXCJ0Ym9keVwiKSxcclxuICAgICAgICB0ZDEsXHJcbiAgICAgICAgdGQyLFxyXG4gICAgICAgIHRyLFxyXG4gICAgICAgIGlucHV0LFxyXG4gICAgICAgIHJvd0NvdW50ID0gMTk7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xyXG4gICAgICAgIGlucHV0ID0gJChcIjxpbnB1dD5cIik7XHJcbiAgICAgICAgdGQxID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRyID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHJcbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XHJcblxyXG4gICAgICAgICQoaW5wdXQpLmF0dHIoXCJuYW1lXCIsIGBpbnB1dCR7an1gKS5hdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcclxuXHJcbiAgICAgICAgJCh0ZDIpLmF0dHIoXCJpZFwiLCBgeXZhbCR7an1gKTtcclxuXHJcbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgJCh0cikuYXBwZW5kKHRkMSkuYXBwZW5kKHRkMik7XHJcbiAgICAgICAgJCh0Ym9keSkuYXBwZW5kKHRyKTtcclxuICAgIH1cclxufSgpKTtcclxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBzaG93UHJvZk9wdGlvbnMgKGZpZWxkKSB7XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIEFwcGVuZCB0aGUgcHJvZmVzc29yJ3MgY2hvc2VuIGVxdWF0aW9ucyB0byB0aGUgYXBwbGljYXRpb25cclxuICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIHZhciBvcHQgPSAkKFwiPG9wdGlvbj48L29wdGlvbj5cIikuYXBwZW5kKGZpZWxkLm5hbWUpO1xyXG5cclxuICAgICAgICAgICAgJChvcHQpLnZhbChmaWVsZC5lcXVhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIHRoZSBwcm9mZXNzb3IgY29uZmlndXJhdGlvbiBmaWxlXHJcbiAgICAqL1xyXG5cclxuICAgICQuZ2V0SlNPTihcIi4uL2Z1bmNNYWNoaW5lU2V0dGluZ3MuanNvblwiLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcblxyXG4gICAgICAgIHdpbmRvdy5wcm9mZXNzb3JDb25maWdGaWxlID0gcmVzdWx0O1xyXG5cclxuICAgICAgICAkLmVhY2gocmVzdWx0LCBmdW5jdGlvbiAoaSwgZmllbGQpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHNob3dQcm9mT3B0aW9ucyhmaWVsZCk7XHJcblxyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICBEaXNwbGF5IHRoZSBkZWZhdWx0IGVxdWF0aW9uIHRvIHRoZSBmdW5jdGlvbiBtYWNoaW5lXHJcbiAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlUGxvdChmaWVsZC5lcXVhdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59KTtcclxuIiwiICAgIHZhciB4TWVtb3J5ID0gW10sXHJcbiAgICAgICAgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxyXG4gICAgICAgIGlucHV0Q291bnQgPSBpbnB1dHMubGVuZ3RoLFxyXG4gICAgICAgIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdO1xyXG5cclxuICAgIC8qXHJcbiAgICBBbmltYXRpb24gcGF0aCBmb3IgdGhlIHN0YWlyc3RlcFxyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIHN0YWlyU3RlcChvcHRpb25zKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgdmFyIGhpZ2h3YXlQYXRoID0gMjQ2LjU7XHJcbiAgICAgICAgbGFzdFNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtvcHRpb25zLm5hbWV9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLnN0YXJ0VG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5zdGFydExlZnRPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAzMyUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLnN0YXJ0VG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7aGlnaHdheVBhdGh9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NiUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLmVuZFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOTAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtvcHRpb25zLmVuZExlZnRPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1gLCBsYXN0U2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgQSBzZXQgb2YgZnVuY3Rpb25zIHVzaW5nIHRoZSBzdGFpcnN0ZXAgYW5pbWF0aW9uIHRlbXBsYXRlXHJcbiAgICB0byBjcmVhdGUgcGF0aHdheXMgd2l0aCBjb29yZGluYXRlIGRhdGFcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBtYWtlWFRvTWFjaGluZShpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHN0YWlyU3RlcCh7XHJcbiAgICAgICAgICAgIHN0YXJ0VG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXHJcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5sZWZ0ICsgMzAsXHJcbiAgICAgICAgICAgIGVuZFRvcE9mZjogNTUsXHJcbiAgICAgICAgICAgIGVuZExlZnRPZmY6IDMwMCxcclxuICAgICAgICAgICAgbmFtZTogYHhUb01hY2hpbmUke2luZGV4fWBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtYWtlTWFjaGluZVRvWShpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHN0YWlyU3RlcCh7XHJcbiAgICAgICAgICAgIHN0YXJ0VG9wT2ZmOiA1NSxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIGVuZFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiBpbnB1dENvcmRzLnJpZ2h0ICsgNSxcclxuICAgICAgICAgICAgbmFtZTogYG1hY2hpbmVUb1kke2luZGV4fWBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtYWtlWVRvU3RhdHVzQmFyKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiBpbnB1dENvcmRzLnJpZ2h0ICsgMTAsXHJcbiAgICAgICAgICAgIGVuZFRvcE9mZjogMTUwLFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIG5hbWU6IGB5VG9TdGF0dXNCYXIke2luZGV4fWBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IHVwIHRoZSB4TWVtb3J5IGFycmF5IGFuZCB0aGUgYW5pbWF0aW9uIHBhdGhzIGZvciBlYWNoIGlucHV0IGJveC5cclxuXHJcbiAgICBOT1RFOiBTZXR0aW5nIHVwIHRoZSB4TWVtb3J5IGFycmF5IGFsc28gbWFrZXMgaXQgc28gdGhhdCBubyBhbmltYXRpb25zIFxyXG4gICAgICAgICAgYXJlIHJlcGVhdGVkIGJ5IG11bHRpcGxlIGNsaWNrcyBvbiB0aGUgXCJHbyFcIiBidXR0b24uXHJcbiAgICAqL1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dENvdW50OyBpKyspIHtcclxuICAgICAgICB4TWVtb3J5W2ldID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGlucHV0Q29vciA9IGlucHV0c1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgbWFrZVhUb01hY2hpbmUoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICBtYWtlTWFjaGluZVRvWShpbnB1dENvb3IsIGkpO1xyXG4gICAgICAgIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICAkKFwiI251bUNvbnRhaW5lclwiKS5hcHBlbmQoJChgPHA+PC9wPmApKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IGFsbCB0aGUgZGF0YSB0byBhbiBhcnJheSBvZiBvYmplY3RzIHRvIGJlIGl0ZXJhdGVkXHJcbiAgICBvdmVyIGJ5IHRoZSBwcm9taXNlIGNoYWluIGluIGFuaW1hdG9yY29udHJvbC5qc1xyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIHN0YXJ0RnVuY01hY2goKSB7XHJcblxyXG4gICAgICAgIHZhciB4aW5wdXRzID0gJChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxyXG4gICAgICAgICAgICBoaWRlQW5pbWF0aW9uQ2hlY2tlZCA9ICQoXCIjYW5pbWF0ZTpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGhpZGVHcmFwaENoZWNrZWQgPSAkKFwiI3Nob3dHcmFwaDpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGdyYXBoT3B0ID0ge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmlzaGVkIHBsb3R0aW5nIGRhdGFwb2ludCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGFuaW1hdGVIaWRlOiBoaWRlQW5pbWF0aW9uQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoSGlkZTogaGlkZUdyYXBoQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGVxdWF0aW9uOiBwcm9mT3B0LmVxdWF0aW9uXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFuaVNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YXBvaW50czogW10sXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Um91bmQ6IDAsXHJcbiAgICAgICAgICAgICAgICBncmFwaE9wdDogZ3JhcGhPcHRcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgeGlucHV0cy5lYWNoKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgIHZhciB4dmFsID0gKyQodGhpcykudmFsKCk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIGVxdWF0aW9uID0gcHJvZk9wdC5lcXVhdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmICh4dmFsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZVggPSBncmFwaE9wdC5lcXVhdGlvbi5yZXBsYWNlKFwieFwiLCBgKCR7eHZhbH0pYCksXHJcbiAgICAgICAgICAgICAgICAgICAgeXZhbCA9IG1hdGguZXZhbChyZXBsYWNlWCksXHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRDb29yID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogeHZhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogeXZhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUVxdTogcHJvZk9wdC5lcXVhdGlvbi5yZXBsYWNlKFwieFwiLCBgKCR7eHZhbH0pYCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBvaW50OiB4TWVtb3J5W2ldICE9PSB4dmFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiAkKFwiI251bUNvbnRhaW5lciBwXCIpLmdldChpKVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgIENsZWFyIG91dCB0aGUgWXMgd2hlbiB0aGV5IGRvbid0IGVxdWFsIGVhY2ggb3RoZXIgYW5kIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIGlmIChwb2ludC51cGRhdGVQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoYHRkI3l2YWwke2kgKyAxfWApLmh0bWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLypVcGRhdGUgdGhlIHhtZW1vcnkqL1xyXG4gICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHh2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgYW5pU2V0dGluZ3MuZGF0YXBvaW50cy5wdXNoKHBvaW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBhbmltYXRvckNvbnRyb2woYW5pU2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vRnVuY3Rpb24gdG8gc2VsZWN0IHRoZSBjaG9zZW4gZXF1YXRpb24gd2l0aCBpdHMgbmFtZSBhbmQgZ3JhcGggd2luZG93IGJvdW5kYXJpZXMuXHJcbiAgICBmdW5jdGlvbiBjaGVja0NvbmZpZyh2YWwpIHtcclxuICAgICAgICB2YXIgcHJvZk9wdDtcclxuICAgICAgICAkLmVhY2gocHJvZmVzc29yQ29uZmlnRmlsZSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZXF1YXRpb24gPT09IHZhbCkge1xyXG4gICAgICAgICAgICAgICAgcHJvZk9wdCA9IGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBwcm9mT3B0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vRGlwc2xheSBLYXRleCBlcXVhdGlvblxyXG4gICAgZnVuY3Rpb24gY2hhbmdlUGxvdCh2YWwpIHtcclxuXHJcbiAgICAgICAgd2luZG93LnByb2ZPcHQgPSBjaGVja0NvbmZpZyh2YWwpO1xyXG5cclxuICAgICAgICB2YXIgeSA9IGB5ID0gYCxcclxuICAgICAgICAgICAgZXF1YXQgPSBgJHt2YWx9YCxcclxuICAgICAgICAgICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICAgICAgICAgIHlQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI3lcIik7XHJcblxyXG4gICAgICAgICQoZXF1UGFyYSkuZW1wdHkoXCJcIik7XHJcblxyXG4gICAgICAgIGthdGV4LnJlbmRlcih5LCB5UGFyYVswXSk7XHJcbiAgICAgICAga2F0ZXgucmVuZGVyKGVxdWF0LCBlcXVQYXJhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgT25jaGFuZ2UgZXZlbnQgaGFuZGxlciBmb3IgdGhlIHNlbGVjdCBodG1sIGVsZW1lbnQuXHJcbiAgICAqL1xyXG4gICAgJChcInNlbGVjdFwiKS5jaGFuZ2UoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBjaGFuZ2VQbG90KGUudGFyZ2V0LnZhbHVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBET0NVTUVOVCBrZXlkb3duIGV2ZW50IGhhbmRsZXJcclxuICAgICovXHJcbiAgICAkKGRvY3VtZW50KS5rZXlwcmVzcyhmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChlLndoaWNoID09IDEzKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgR08hIENsaWNrIGV2ZW50IGhhbmRsZXJcclxuICAgICovXHJcbiAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzdGFydEZ1bmNNYWNoKCk7XHJcbiAgICB9KTsiLCJ2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKSxcclxuICAgIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLFxyXG4gICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICBhbmlEdXJhdGlvbiA9IDI7XHJcblxyXG4vL1RPRE86IEZpeCBUYWJsZSBoZWFkZXIgQ1NTIHRvIGEgZml4ZWQgd2lkdGhcclxuLy9UT0RPOiBTdHlsZSB0aGUgd2hvbGUgdGhpbmcuXHJcbi8vVE9ETzogR2V0IHRoZSBmdW5jdGlvbiBtYWNoaW5lIGluIHRoZXJlLlxyXG4vL1RPRE86IENsZWFyIChyZWNyZWF0ZSB0aGUgdGFibGUpIG91dCB0aGUgeCB2YWx1ZXMgd2hlbiBlcXVhdGlvbiBpcyBjaGFuZ2VkLlxyXG4vL1RPRE86IFZhbGlkYXRlIHggdmFsdWVzIHdpdGhpbiB0aGUgc2V0IGRvbWFpbiBvZiB0aGUgcHJvZk9wdFxyXG4vL1RPRE86IENoZWNrIGJyb3dzZXIgY29tcGF0aWJpbGl0eSAoUHJvbWlzZXMgaW4gSUUpLlxyXG5cclxuZnVuY3Rpb24gcnVuQW5pbWF0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAvKlxyXG4gICAgVGhpcyBpcyBhIGZ1bmN0aW9uIGZhY3Rvcnkgd2hpY2ggd2lsbCBncmFiIHRoZVxyXG4gICAgbmVjZXNzYXJ5IGRhdGEgYW5kIHRoZW4gcmV0dXJuIHRoZSBmdW5jdGlvbiBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGFuaW1hdGlvbihhbmlTZXR0aW5ncykge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHZhciBkYXRhcG9pbnQgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF0sXHJcbiAgICAgICAgICAgIG51bVBhcmEgPSBkYXRhcG9pbnQuZWxlbWVudDtcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICBNYWtlIHRoZSBwcm9taXNlIHRoYXQgd2hlbiB0aGUgZHluYW1pY1xyXG4gICAgICAgIGFuaW1hdGlvbiBwYXRoIGlzIGRvbmUgdGhlbiB0aGlzIHByb21pc2UgaXMgZmluaXNoZWRcclxuICAgICAgICAqL1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAkKG51bVBhcmEpXHJcbiAgICAgICAgICAgICAgICAuaHRtbCh2YWx1ZSlcclxuICAgICAgICAgICAgICAgIC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIFwiYW5pbWF0aW9uXCI6IGAke25hbWV9JHthbmlTZXR0aW5ncy5jdXJyZW50Um91bmR9ICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGAsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm9uZSgnYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0YXR1c01lc3NhZ2UobWVzc2FnZSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAvKlxyXG4gICAgVGhpcyBpcyBhIGZ1bmN0aW9uIGZhY3Rvcnkgd2hpY2ggd2lsbCBncmFiIHRoZVxyXG4gICAgbmVjZXNzYXJ5IGRhdGEgYW5kIHRoZW4gcmV0dXJuIHRoZSBmdW5jdGlvbiBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICBzdGF0dXNCYXIuaHRtbChgPHA+JHttZXNzYWdlfTwvcD5gKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVwbGFjZVhFcXUoZGF0YSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIFJlcGxhY2UgdGhlIHggaW4gdGhlIGRpc2FwcGVhcmVkIGVxdWF0aW9uIHdpdGhvdXQgaGF2aW5nIHRoZSB5IGRpc2FwcGVhci5cclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0V2YWx1YXRlRXF1KGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgR2V0IHRoZSB5IGFuc3dlciBhbmQgdGhlIHgtY2hhbmdlZCBlcXVhdGlvblxyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF0sXHJcbiAgICAgICAgY2hhbmdlRXF1ID0gcG9pbnREYXRhLmNoYW5nZUVxdTtcclxuXHJcbiAgICAvKlxyXG4gICAgU2hvdyB0aGUgbmV3IGVxdWF0aW9uIHdpdGggdGhlIHJlcGxhY2VkIHgtdmFsdWUgZXF1YXRpb25cclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBrYXRleC5yZW5kZXIoYCR7Y2hhbmdlRXF1fWAsIGVxdVBhcmEpO1xyXG5cclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd1lBbnMoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBBbmltYXRlIHRoZSBuZXcgeSB2YWx1ZSB0byB0aGUgY29vcmRpbmF0ZWQgeSBjb2x1bW4gYW5kIG9uY2VcclxuICAgIGFuaW1hdGlvbiBpcyBkb25lIHRoZW4gcmV0dXJuIHRoZSBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICBrYXRleC5yZW5kZXIoYCR7cG9pbnREYXRhLnl9YCwgZXF1UGFyYSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0VxdWF0aW9uQWdhaW4oYW5pU2V0dGluZ3MpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGxhY2VZVmFsdWUoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICAvKlxyXG4gICAgT25jZSB0aGUgeS12YWx1ZSBhcHBlYXJzIGluIHRoZSBjb3JyZWN0IHktY29sdW1uIHRoZW4gZnVsZmlsbCB0aGUgcHJvbWlzZS5cclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICB2YXIgaW5wdXQgPSAkKGB0ZCN5dmFsJHtwb2ludERhdGEuaWQgKyAxfWApWzBdO1xyXG4gICAgICAgICQoaW5wdXQpLmh0bWwoXCJcIik7XHJcbiAgICAgICAgJChpbnB1dCkuYXBwZW5kKGA8cD4ke3BvaW50RGF0YS55fTwvcD5gKTtcclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXNldFJvdW5kKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgR2V0IHRoZSBjdXJyZW50IHJvdW5kIGFuZCBjdXJyZW50IGRhdGEgcG9pbnRzXHJcbiAgICAqL1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICAvKlxyXG4gICAgT25jZSB0aGUgZXF1YXRpb24gaXMgY2xlYXJlZCBhbmQgcmVzZXQgdG8gdGhlIGRlZmF1bHQgZXF1YXRpb25cclxuICAgIHRoZW4gZnVsZmlsbCB0aGUgcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICBrYXRleC5yZW5kZXIoYCR7cHJvZk9wdC5lcXVhdGlvbn1gLCBlcXVQYXJhKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RGVmYXVsdEVxdShhbmlTZXR0aW5ncykge1xyXG4gICAgLypcclxuICAgIFJldHVybiB0byBkZWZhdWx0IGJlZ2lubmluZyBlcXVhdGlvbiBmb3IgdGhlIG5leHQgYW5pbWF0aW9uIG9yIGZvciB0aGUgZW5kXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKlxyXG5BY2NlcHQgdGhlIGRhdGFwb2ludCBhbmQgaXRzIGl0ZXJhdG9yIGFuZCBwbG90IHRoYXQgcG9pbnQgYmVpbmcgcGFzc2VkIHRocm91Z2hcclxuKi9cclxuZnVuY3Rpb24gcGxvdHRlcihhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGFuaVNldHRpbmdzLmdyYXBoT3B0LmNhbGxiYWNrKCk7XHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlUm91bmQoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBwbGFjZWhvbGRlciA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICAvKlxyXG4gICAgVGhpcyBmdW5jdGlvbiBhY3RzIGFzIGFuIGl0ZXJhdG9yIHNvIHRoYXQgdGhlIHByb21pc2UgY2hhaW4ga25vd3Mgd2hpY2hcclxuICAgIGRhdGFwb2ludCB0byBoYW5kbGUgYW5kIHRvIGFuaW1hdGVcclxuICAgICovXHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kICs9IDE7XHJcbiAgICAgICAgcGxhY2Vob2xkZXIudXBkYXRlUG9pbnQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKSB7XHJcbiAgICBkcHMuZGF0YXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhcG9pbnQpIHtcclxuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoYWluID0gY2hhaW5cclxuICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcInhUb01hY2hpbmVcIiwgZGF0YXBvaW50LngpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShcIkNhbGN1bGF0aW5nXCIpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVwbGFjZVhFcXUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RXZhbHVhdGVFcXUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93WUFucylcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dFcXVhdGlvbkFnYWluKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwibWFjaGluZVRvWVwiLCBkYXRhcG9pbnQueSkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbGFjZVlWYWx1ZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcInlUb1N0YXR1c0JhclwiLCBgKCR7ZGF0YXBvaW50Lnh9LCR7ZGF0YXBvaW50Lnl9KWApKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShgUGxvdHRpbmcgKCR7ZGF0YXBvaW50Lnh9LCR7ZGF0YXBvaW50Lnl9KWApKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxvdHRlcilcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlc2V0Um91bmQpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBgKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dEZWZhdWx0RXF1KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKSB7XHJcbiAgICBkcHMuZGF0YXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhcG9pbnQpIHtcclxuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoYWluID0gY2hhaW5cclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxvdHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoYWluID0gY2hhaW4udGhlbih1cGRhdGVSb3VuZCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuSGFuZGxlIGFsbCBDU1MgYW5pbWF0aW9ucyBieSBjcmVhdGluZyBhIFByb21pc2UgY2hhaW4gdGhyb3VnaCBhIGZvciBsb29wLlxyXG4qL1xyXG5mdW5jdGlvbiBhbmltYXRvckNvbnRyb2woZHBzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBudW1Db250YWluZXIgPSAkKFwiI251bUNvbnRhaW5lclwiKSxcclxuICAgICAgICBjaGFpbiA9IFByb21pc2UucmVzb2x2ZShkcHMpO1xyXG5cclxuICAgIG51bUNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGRwcylcclxuXHJcbiAgICBpZiAoZHBzLmdyYXBoT3B0LmFuaW1hdGVIaWRlKSB7XHJcbiAgICAgICAgbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH1cclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
