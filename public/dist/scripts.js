"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;n>=e;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var o=$("<option></option>").append(n.name);$(o).val(n.equation),$("select").append(o)}var o=location.search.substring(1),e=o.split("=")[1]+".json";console.log(e),$.getJSON(e,function(o){window.professorConfigFile=o,$.each(o,function(o,e){n(e),0===o&&changePlot(e.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:55,startLeftOff:300,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,a={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},o={datapoints:[],currentRound:0,graphOpt:a};t.each(function(t){var n=+$(this).val();if(n){var e=a.equation.replace("x","("+n+")"),i=math.eval(e),f=(this.getBoundingClientRect(),{x:n,y:i,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});f.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,o.datapoints.push(f)}}),animatorControl(o)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,a){a.equation===t&&(n=a)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,a=$("#functionMachine #equ")[0],o=$("#functionMachine #y");$(a).empty(""),katex.render(n,o[0]),katex.render(e,a)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;inputCount>i;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(a){var e=a.datapoints[a.currentRound],i=e.element;return new Promise(function(e){$(i).html(t).css({animation:""+n+a.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){e(a)})})}}function statusMessage(n){return function(t){return new Promise(function(a){statusBar.html("<p>"+n+"</p>"),a(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],a=t.changeEqu;return new Promise(function(t){katex.render(""+a,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),a(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){var e=$("td#yval"+(t.id+1))[0];$(e).html(""),$(e).append("<p>"+t.y+"</p>"),a(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){n.currentRound+=1,t.updatePoint=!1,a(n)})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),a=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,a):aniPromiseChain(n,a)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwicXVlcnlTdHJpbmciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5Iiwic3BsaXQiLCJjb25zb2xlIiwibG9nIiwiZ2V0SlNPTiIsInJlc3VsdCIsIndpbmRvdyIsInByb2Zlc3NvckNvbmZpZ0ZpbGUiLCJlYWNoIiwiaSIsImNoYW5nZVBsb3QiLCJzdGFpclN0ZXAiLCJvcHRpb25zIiwiaGlnaHdheVBhdGgiLCJsYXN0U2hlZXQiLCJpbnNlcnRSdWxlIiwic3RhcnRUb3BPZmYiLCJzdGFydExlZnRPZmYiLCJlbmRUb3BPZmYiLCJlbmRMZWZ0T2ZmIiwiY3NzUnVsZXMiLCJsZW5ndGgiLCJtYWtlWFRvTWFjaGluZSIsImlucHV0Q29yZHMiLCJpbmRleCIsInRvcCIsImxlZnQiLCJtYWtlTWFjaGluZVRvWSIsInJpZ2h0IiwibWFrZVlUb1N0YXR1c0JhciIsInN0YXJ0RnVuY01hY2giLCJ4aW5wdXRzIiwiaGlkZUFuaW1hdGlvbkNoZWNrZWQiLCJoaWRlR3JhcGhDaGVja2VkIiwiZ3JhcGhPcHQiLCJjYWxsYmFjayIsImFuaVNldHRpbmdzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJhbmltYXRlSGlkZSIsImdyYXBoSGlkZSIsInByb2ZPcHQiLCJ2aWV3IiwiZGF0YXBvaW50cyIsImN1cnJlbnRSb3VuZCIsInh2YWwiLCJ0aGlzIiwicmVwbGFjZVgiLCJyZXBsYWNlIiwieXZhbCIsIm1hdGgiLCJldmFsIiwicG9pbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ4IiwieSIsImlkIiwiY2hhbmdlRXF1IiwidXBkYXRlUG9pbnQiLCJ4TWVtb3J5IiwiZWxlbWVudCIsImdldCIsImh0bWwiLCJwdXNoIiwiYW5pbWF0b3JDb250cm9sIiwiY2hlY2tDb25maWciLCJpdGVtIiwiY2xlYXJWYWx1ZXMiLCJ5aW5wdXRzIiwidmFsdWUiLCJpbm5lckhUTUwiLCJlcXVhdCIsImVxdVBhcmEiLCJ5UGFyYSIsImVtcHR5Iiwia2F0ZXgiLCJyZW5kZXIiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRDb3VudCIsInN0eWxlU2hlZXRzIiwiaW5wdXRDb29yIiwiY2hhbmdlIiwiZSIsInRhcmdldCIsImtleXByZXNzIiwid2hpY2giLCJjbGljayIsInJ1bkFuaW1hdGlvbiIsImRhdGFwb2ludCIsIm51bVBhcmEiLCJjc3MiLCJhbmltYXRpb24iLCJhbmlEdXJhdGlvbiIsIm9uZSIsInN0YXR1c01lc3NhZ2UiLCJtZXNzYWdlIiwic3RhdHVzQmFyIiwicmVwbGFjZVhFcXUiLCJkYXRhIiwic2hvd0V2YWx1YXRlRXF1IiwicG9pbnREYXRhIiwic2hvd1lBbnMiLCJzaG93RXF1YXRpb25BZ2FpbiIsInBsYWNlWVZhbHVlIiwicmVzZXRSb3VuZCIsInNob3dEZWZhdWx0RXF1IiwicGxvdHRlciIsInVwZGF0ZVJvdW5kIiwicGxhY2Vob2xkZXIiLCJhbmlQcm9taXNlQ2hhaW4iLCJkcHMiLCJjaGFpbiIsImZvckVhY2giLCJ0aGVuIiwibm9BbmlQcm9taXNlQ2hhaW4iLCJudW1Db250YWluZXIiXSwibWFwcGluZ3MiOiJBQUFBLGNBQUMsV0FhRyxJQUFLLEdBTkRBLEdBQ0FDLEVBQ0FDLEVBQ0FDLEVBSkFDLEVBQVFDLEVBQUUsU0FLVkMsRUFBVyxHQUVOQyxFQUFJLEVBQVFELEdBQUxDLEVBQWVBLElBQzNCSixFQUFRRSxFQUFFLFdBQ1ZMLEVBQU1LLEVBQUUsYUFDUkosRUFBTUksRUFBRSxhQUNSSCxFQUFLRyxFQUFFLGFBRVBBLEVBQUVILEdBQUlNLEtBQUssS0FBWCxNQUF1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c0UsUUFBUSxTQUFVeEIsR0FDekJBLEVBQVUvQixlQUFnQixJQUMxQnNELEVBQVFBLEVBQ0hFLEtBQUtWLGFBQ0xVLEtBQUtQLFVBRWRLLEVBQVFBLEVBQU1FLEtBQUtOLGVBTzNCLFFBQVM1QyxpQkFBZ0IrQyxHQUVyQixHQUFJSyxHQUFlckksRUFBRSxpQkFDakJpSSxFQUFRM0UsUUFBUUMsUUFBUXlFLEVBRTVCSyxHQUFhOUMsVUFBWSxHQUVyQnlDLEVBQUk3RSxTQUFTSyxZQUNiNEUsa0JBQWtCSixFQUFLQyxHQUV2QkYsZ0JBQWdCQyxFQUFLQyxHQTlQN0IsR0FBSWYsV0FBWWxILEVBQUUsYUFDZCtCLFVBQVkxQixTQUFTNEYsWUFBWTVGLFNBQVM0RixZQUFZM0QsT0FBUyxHQUMvRG1ELFFBQVV6RixFQUFFLHlCQUF5QixHQUNyQzhHLFlBQWMiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxuICAgIE1ha2UgdGhlIHdob2xlIHRhYmxlIGFuZCBjZWxscyBmb3IgdGhlIGlucHV0IGJveGVzIGFuZCB1c2VyIGludGVyYWN0aW9uLlxuICAgICovXG4gICAgdmFyIHRib2R5ID0gJChcInRib2R5XCIpLFxyXG4gICAgICAgIHRkMSxcclxuICAgICAgICB0ZDIsXHJcbiAgICAgICAgdHIsXHJcbiAgICAgICAgaW5wdXQsXHJcbiAgICAgICAgcm93Q291bnQgPSAxOTtcclxuXHJcbiAgICBmb3IgKHZhciBqID0gMTsgaiA8PSByb3dDb3VudDsgaisrKSB7XHJcbiAgICAgICAgaW5wdXQgPSAkKFwiPGlucHV0PlwiKTtcclxuICAgICAgICB0ZDEgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRkMiA9ICQoXCI8dGQ+PC90ZD5cIik7XHJcbiAgICAgICAgdHIgPSAkKFwiPHRyPjwvdHI+XCIpO1xyXG5cclxuICAgICAgICAkKHRyKS5hdHRyKFwiaWRcIiwgYHJvdyR7an1gKTtcclxuXHJcbiAgICAgICAgJChpbnB1dCkuYXR0cihcIm5hbWVcIiwgYGlucHV0JHtqfWApLmF0dHIoXCJ0eXBlXCIsIFwibnVtYmVyXCIpO1xyXG5cclxuICAgICAgICAkKHRkMikuYXR0cihcImlkXCIsIGB5dmFsJHtqfWApO1xyXG5cclxuICAgICAgICAkKHRkMSkuYXBwZW5kKGlucHV0KTtcclxuICAgICAgICAkKHRyKS5hcHBlbmQodGQxKS5hcHBlbmQodGQyKTtcclxuICAgICAgICAkKHRib2R5KS5hcHBlbmQodHIpO1xyXG4gICAgfVxyXG59KCkpO1xyXG4iLCIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgLypcclxuICAgIExvYWQgUXVlcnkgc3Vic3RyaW5nXHJcbiAgICAqL1xyXG4gICAgdmFyIHF1ZXJ5U3RyaW5nID0gbG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKSxcclxuICAgICAgICBxdWVyeSA9IHF1ZXJ5U3RyaW5nLnNwbGl0KFwiPVwiKVsxXSArIFwiLmpzb25cIjtcclxuICAgICAgICBcclxuICAgIGNvbnNvbGUubG9nKHF1ZXJ5KTtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gc2hvd1Byb2ZPcHRpb25zKGZpZWxkKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBBcHBlbmQgdGhlIHByb2Zlc3NvcidzIGNob3NlbiBlcXVhdGlvbnMgdG8gdGhlIGFwcGxpY2F0aW9uXHJcbiAgICAgICAgKi9cclxuXHJcbiAgICAgICAgdmFyIG9wdCA9ICQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hcHBlbmQoZmllbGQubmFtZSk7XHJcblxyXG4gICAgICAgICQob3B0KS52YWwoZmllbGQuZXF1YXRpb24pO1xyXG5cclxuICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIHRoZSBwcm9mZXNzb3IgY29uZmlndXJhdGlvbiBmaWxlXHJcbiAgICAqL1xyXG5cclxuICAgICQuZ2V0SlNPTihxdWVyeSwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZmVzc29yQ29uZmlnRmlsZSA9IHJlc3VsdDtcclxuXHJcbiAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGksIGZpZWxkKSB7XHJcblxyXG4gICAgICAgICAgICBzaG93UHJvZk9wdGlvbnMoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QoZmllbGQuZXF1YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxufSk7IiwiICAgIHZhciB4TWVtb3J5ID0gW10sXHJcbiAgICAgICAgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxuICAgICAgICBpbnB1dENvdW50ID0gaW5wdXRzLmxlbmd0aCxcbiAgICAgICAgbGFzdFNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoIC0gMV07XG5cclxuICAgIC8qXHJcbiAgICBBbmltYXRpb24gcGF0aCBmb3IgdGhlIHN0YWlyc3RlcFxyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIHN0YWlyU3RlcChvcHRpb25zKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgIHZhciBoaWdod2F5UGF0aCA9IDI0Ni41O1xuICAgICAgICBsYXN0U2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke29wdGlvbnMubmFtZX0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLnN0YXJ0VG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5zdGFydExlZnRPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAzMyUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLnN0YXJ0VG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7aGlnaHdheVBhdGh9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NiUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLmVuZFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOTAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtvcHRpb25zLmVuZExlZnRPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1gLCBsYXN0U2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgQSBzZXQgb2YgZnVuY3Rpb25zIHVzaW5nIHRoZSBzdGFpcnN0ZXAgYW5pbWF0aW9uIHRlbXBsYXRlXHJcbiAgICB0byBjcmVhdGUgcGF0aHdheXMgd2l0aCBjb29yZGluYXRlIGRhdGFcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBtYWtlWFRvTWFjaGluZShpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICBzdGFpclN0ZXAoe1xuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5sZWZ0ICsgMzAsXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDU1LFxuICAgICAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxuICAgICAgICAgICAgbmFtZTogYHhUb01hY2hpbmUke2luZGV4fWBcbiAgICAgICAgfSk7XG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgIHN0YWlyU3RlcCh7XG4gICAgICAgICAgICBzdGFydFRvcE9mZjogNTUsXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IDMwMCxcbiAgICAgICAgICAgIGVuZFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxuICAgICAgICAgICAgZW5kTGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDUsXG4gICAgICAgICAgICBuYW1lOiBgbWFjaGluZVRvWSR7aW5kZXh9YFxuICAgICAgICB9KTtcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZVlUb1N0YXR1c0JhcihpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICBzdGFpclN0ZXAoe1xuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDEwLFxuICAgICAgICAgICAgZW5kVG9wT2ZmOiAxNTAsXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXG4gICAgICAgICAgICBuYW1lOiBgeVRvU3RhdHVzQmFyJHtpbmRleH1gXG4gICAgICAgIH0pO1xuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IHVwIHRoZSB4TWVtb3J5IGFycmF5IGFuZCB0aGUgYW5pbWF0aW9uIHBhdGhzIGZvciBlYWNoIGlucHV0IGJveC5cclxuXHJcbiAgICBOT1RFOiBTZXR0aW5nIHVwIHRoZSB4TWVtb3J5IGFycmF5IGFsc28gbWFrZXMgaXQgc28gdGhhdCBubyBhbmltYXRpb25zXHJcbiAgICAgICAgICBhcmUgcmVwZWF0ZWQgYnkgbXVsdGlwbGUgY2xpY2tzIG9uIHRoZSBcIkdvIVwiIGJ1dHRvbi5cclxuICAgICovXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Q291bnQ7IGkrKykge1xyXG4gICAgICAgIHhNZW1vcnlbaV0gPSBudWxsO1xuXHJcbiAgICAgICAgdmFyIGlucHV0Q29vciA9IGlucHV0c1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxyXG4gICAgICAgIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29vciwgaSk7XG4gICAgICAgIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29vciwgaSk7XG4gICAgICAgIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb29yLCBpKTtcbiAgICAgICAgJChcIiNudW1Db250YWluZXJcIikuYXBwZW5kKCQoYDxwPjwvcD5gKSk7XG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBTZXQgYWxsIHRoZSBkYXRhIHRvIGFuIGFycmF5IG9mIG9iamVjdHMgdG8gYmUgaXRlcmF0ZWRcclxuICAgIG92ZXIgYnkgdGhlIHByb21pc2UgY2hhaW4gaW4gYW5pbWF0b3Jjb250cm9sLmpzXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3RhcnRGdW5jTWFjaCgpIHtcclxuXHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXG4gICAgICAgICAgICBoaWRlQW5pbWF0aW9uQ2hlY2tlZCA9ICQoXCIjYW5pbWF0ZTpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICBoaWRlR3JhcGhDaGVja2VkID0gJChcIiNzaG93R3JhcGg6Y2hlY2tlZFwiKS5sZW5ndGggPiAwLFxuICAgICAgICAgICAgZ3JhcGhPcHQgPSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmluaXNoZWQgcGxvdHRpbmcgZGF0YXBvaW50IVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGFuaW1hdGVIaWRlOiBoaWRlQW5pbWF0aW9uQ2hlY2tlZCxcbiAgICAgICAgICAgICAgICBncmFwaEhpZGU6IGhpZGVHcmFwaENoZWNrZWQsXG4gICAgICAgICAgICAgICAgZXF1YXRpb246IHByb2ZPcHQuZXF1YXRpb24sXG4gICAgICAgICAgICAgICAgdmlldzogcHJvZk9wdC52aWV3XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYW5pU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgZGF0YXBvaW50czogW10sXG4gICAgICAgICAgICAgICAgY3VycmVudFJvdW5kOiAwLFxuICAgICAgICAgICAgICAgIGdyYXBoT3B0OiBncmFwaE9wdFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciB4dmFsID0gKyQodGhpcykudmFsKCk7XG5cbiAgICAgICAgICAgIGlmICh4dmFsKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VYID0gZ3JhcGhPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3h2YWx9KWApLFxuICAgICAgICAgICAgICAgICAgICB5dmFsID0gbWF0aC5ldmFsKHJlcGxhY2VYKSxcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRDb29yID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB4dmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogeXZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlRXF1OiBwcm9mT3B0LmVxdWF0aW9uLnJlcGxhY2UoXCJ4XCIsIGAoJHt4dmFsfSlgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBvaW50OiB4TWVtb3J5W2ldICE9PSB4dmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogJChcIiNudW1Db250YWluZXIgcFwiKS5nZXQoaSlcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgQ2xlYXIgb3V0IHRoZSBZcyB3aGVuIHRoZXkgZG9uJ3QgZXF1YWwgZWFjaCBvdGhlciBhbmQgbmVlZCB0byBiZSB1cGRhdGVkXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAocG9pbnQudXBkYXRlUG9pbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgJChgdGQjeXZhbCR7aSArIDF9YCkuaHRtbChcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKlVwZGF0ZSB0aGUgeG1lbW9yeSovXG4gICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHh2YWw7XG5cbiAgICAgICAgICAgICAgICBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzLnB1c2gocG9pbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XG4gICAgfVxyXG5cclxuICAgIC8vRnVuY3Rpb24gdG8gc2VsZWN0IHRoZSBjaG9zZW4gZXF1YXRpb24gd2l0aCBpdHMgbmFtZSBhbmQgZ3JhcGggd2luZG93IGJvdW5kYXJpZXMuXHJcbiAgICBmdW5jdGlvbiBjaGVja0NvbmZpZyh2YWwpIHtcclxuICAgICAgICB2YXIgcHJvZk9wdDtcbiAgICAgICAgJC5lYWNoKHByb2Zlc3NvckNvbmZpZ0ZpbGUsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5lcXVhdGlvbiA9PT0gdmFsKSB7XG4gICAgICAgICAgICAgICAgcHJvZk9wdCA9IGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBwcm9mT3B0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFyVmFsdWVzKCkge1xuICAgICAgICB2YXIgeGlucHV0cyA9ICQoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcbiAgICAgICAgICAgIHlpbnB1dHMgPSAkKGB0ciB0ZDpudGgtb2YtdHlwZSgyKWApO1xuXG4gICAgICAgIHhpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICAgICAgaXRlbS52YWx1ZSA9IFwiXCI7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB9KTtcbiAgICB9XHJcblxyXG4gICAgLy9EaXBzbGF5IEthdGV4IGVxdWF0aW9uXHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xyXG5cclxuICAgICAgICBjbGVhclZhbHVlcygpO1xuXG4gICAgICAgIHdpbmRvdy5wcm9mT3B0ID0gY2hlY2tDb25maWcodmFsKTtcblxyXG4gICAgICAgIHZhciB5ID0gYHkgPSBgLFxuICAgICAgICAgICAgZXF1YXQgPSBgJHt2YWx9YCxcbiAgICAgICAgICAgIGVxdVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjZXF1XCIpWzBdLFxuICAgICAgICAgICAgeVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjeVwiKTtcblxyXG4gICAgICAgICQoZXF1UGFyYSkuZW1wdHkoXCJcIik7XG5cclxuICAgICAgICBrYXRleC5yZW5kZXIoeSwgeVBhcmFbMF0pO1xuICAgICAgICBrYXRleC5yZW5kZXIoZXF1YXQsIGVxdVBhcmEpO1xuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgT25jaGFuZ2UgZXZlbnQgaGFuZGxlciBmb3IgdGhlIHNlbGVjdCBodG1sIGVsZW1lbnQuXHJcbiAgICAqL1xyXG4gICAgJChcInNlbGVjdFwiKS5jaGFuZ2UoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBjaGFuZ2VQbG90KGUudGFyZ2V0LnZhbHVlKTtcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgRE9DVU1FTlQga2V5ZG93biBldmVudCBoYW5kbGVyXHJcbiAgICAqL1xyXG4gICAgJChkb2N1bWVudCkua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PSAxMykge1xuICAgICAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xuICAgICAgICB9XG4gICAgfSk7XHJcblxyXG4gICAgLypcclxuICAgIEdPISBDbGljayBldmVudCBoYW5kbGVyXHJcbiAgICAqL1xyXG4gICAgJChcImlucHV0W3R5cGU9J2J1dHRvbiddW3ZhbHVlPSdHbyEnXVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xuICAgIH0pO1xuIiwidmFyIHN0YXR1c0JhciA9ICQoXCIjc3RhdHVzIHBcIiksXHJcbiAgICBsYXN0U2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXSxcclxuICAgIGVxdVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjZXF1XCIpWzBdLFxyXG4gICAgYW5pRHVyYXRpb24gPSAyO1xyXG5cbi8vVE9ETzogU3R5bGUgdGhlIHdob2xlIHRoaW5nLlxyXG4vL1RPRE86IEdldCB0aGUgZnVuY3Rpb24gbWFjaGluZSBpbiB0aGVyZS5cbi8vVE9ETzogVmFsaWRhdGUgeCB2YWx1ZXMgd2l0aGluIHRoZSBzZXQgZG9tYWluIG9mIHRoZSBwcm9mT3B0XHJcbi8vVE9ETzogQ2hlY2sgYnJvd3NlciBjb21wYXRpYmlsaXR5IChQcm9taXNlcyBpbiBJRSkuXHJcblxyXG5mdW5jdGlvbiBydW5BbmltYXRpb24obmFtZSwgdmFsdWUpIHtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gYW5pbWF0aW9uKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgdmFyIGRhdGFwb2ludCA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICAgICAgbnVtUGFyYSA9IGRhdGFwb2ludC5lbGVtZW50O1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgIE1ha2UgdGhlIHByb21pc2UgdGhhdCB3aGVuIHRoZSBkeW5hbWljXHJcbiAgICAgICAgYW5pbWF0aW9uIHBhdGggaXMgZG9uZSB0aGVuIHRoaXMgcHJvbWlzZSBpcyBmaW5pc2hlZFxyXG4gICAgICAgICovXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICQobnVtUGFyYSlcclxuICAgICAgICAgICAgICAgIC5odG1sKHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhbmltYXRpb25cIjogYCR7bmFtZX0ke2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZH0gJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YCxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAub25lKCdhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RhdHVzTWVzc2FnZShtZXNzYWdlKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIHN0YXR1c0Jhci5odG1sKGA8cD4ke21lc3NhZ2V9PC9wPmApO1xyXG4gICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXBsYWNlWEVxdShkYXRhKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgUmVwbGFjZSB0aGUgeCBpbiB0aGUgZGlzYXBwZWFyZWQgZXF1YXRpb24gd2l0aG91dCBoYXZpbmcgdGhlIHkgZGlzYXBwZWFyLlxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXZhbHVhdGVFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIHkgYW5zd2VyIGFuZCB0aGUgeC1jaGFuZ2VkIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICBjaGFuZ2VFcXUgPSBwb2ludERhdGEuY2hhbmdlRXF1O1xyXG5cclxuICAgIC8qXHJcbiAgICBTaG93IHRoZSBuZXcgZXF1YXRpb24gd2l0aCB0aGUgcmVwbGFjZWQgeC12YWx1ZSBlcXVhdGlvblxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGthdGV4LnJlbmRlcihgJHtjaGFuZ2VFcXV9YCwgZXF1UGFyYSk7XHJcblxyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93WUFucyhhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEFuaW1hdGUgdGhlIG5ldyB5IHZhbHVlIHRvIHRoZSBjb29yZGluYXRlZCB5IGNvbHVtbiBhbmQgb25jZVxyXG4gICAgYW5pbWF0aW9uIGlzIGRvbmUgdGhlbiByZXR1cm4gdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwb2ludERhdGEueX1gLCBlcXVQYXJhKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXF1YXRpb25BZ2FpbihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwbGFjZVlWYWx1ZShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSB5LXZhbHVlIGFwcGVhcnMgaW4gdGhlIGNvcnJlY3QgeS1jb2x1bW4gdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlLlxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIHZhciBpbnB1dCA9ICQoYHRkI3l2YWwke3BvaW50RGF0YS5pZCArIDF9YClbMF07XHJcbiAgICAgICAgJChpbnB1dCkuaHRtbChcIlwiKTtcclxuICAgICAgICAkKGlucHV0KS5hcHBlbmQoYDxwPiR7cG9pbnREYXRhLnl9PC9wPmApO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0Um91bmQoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIGN1cnJlbnQgcm91bmQgYW5kIGN1cnJlbnQgZGF0YSBwb2ludHNcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSBlcXVhdGlvbiBpcyBjbGVhcmVkIGFuZCByZXNldCB0byB0aGUgZGVmYXVsdCBlcXVhdGlvblxyXG4gICAgdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwcm9mT3B0LmVxdWF0aW9ufWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dEZWZhdWx0RXF1KGFuaVNldHRpbmdzKSB7XHJcbiAgICAvKlxyXG4gICAgUmV0dXJuIHRvIGRlZmF1bHQgYmVnaW5uaW5nIGVxdWF0aW9uIGZvciB0aGUgbmV4dCBhbmltYXRpb24gb3IgZm9yIHRoZSBlbmRcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbkFjY2VwdCB0aGUgZGF0YXBvaW50IGFuZCBpdHMgaXRlcmF0b3IgYW5kIHBsb3QgdGhhdCBwb2ludCBiZWluZyBwYXNzZWQgdGhyb3VnaFxyXG4qL1xyXG5mdW5jdGlvbiBwbG90dGVyKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgYW5pU2V0dGluZ3MuZ3JhcGhPcHQuY2FsbGJhY2soKTtcclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIHBsYWNlaG9sZGVyID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBUaGlzIGZ1bmN0aW9uIGFjdHMgYXMgYW4gaXRlcmF0b3Igc28gdGhhdCB0aGUgcHJvbWlzZSBjaGFpbiBrbm93cyB3aGljaFxyXG4gICAgZGF0YXBvaW50IHRvIGhhbmRsZSBhbmQgdG8gYW5pbWF0ZVxyXG4gICAgKi9cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5jdXJyZW50Um91bmQgKz0gMTtcclxuICAgICAgICBwbGFjZWhvbGRlci51cGRhdGVQb2ludCA9IGZhbHNlO1xyXG5cclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pIHtcclxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xyXG4gICAgICAgIGlmIChkYXRhcG9pbnQudXBkYXRlUG9pbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieFRvTWFjaGluZVwiLCBkYXRhcG9pbnQueCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKFwiQ2FsY3VsYXRpbmdcIikpXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXBsYWNlWEVxdSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dFdmFsdWF0ZUVxdSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dZQW5zKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0VxdWF0aW9uQWdhaW4pXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJtYWNoaW5lVG9ZXCIsIGRhdGFwb2ludC55KSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieVRvU3RhdHVzQmFyXCIsIGAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBQbG90dGluZyAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzZXRSb3VuZClcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoYGApKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0RlZmF1bHRFcXUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjaGFpbiA9IGNoYWluLnRoZW4odXBkYXRlUm91bmQpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vQW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pIHtcclxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xyXG4gICAgICAgIGlmIChkYXRhcG9pbnQudXBkYXRlUG9pbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKlxyXG5IYW5kbGUgYWxsIENTUyBhbmltYXRpb25zIGJ5IGNyZWF0aW5nIGEgUHJvbWlzZSBjaGFpbiB0aHJvdWdoIGEgZm9yIGxvb3AuXHJcbiovXHJcbmZ1bmN0aW9uIGFuaW1hdG9yQ29udHJvbChkcHMpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIG51bUNvbnRhaW5lciA9ICQoXCIjbnVtQ29udGFpbmVyXCIpLFxyXG4gICAgICAgIGNoYWluID0gUHJvbWlzZS5yZXNvbHZlKGRwcyk7XHJcblxyXG4gICAgbnVtQ29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcblxuICAgIGlmIChkcHMuZ3JhcGhPcHQuYW5pbWF0ZUhpZGUpIHtcclxuICAgICAgICBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pO1xyXG4gICAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
