"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;e<=n;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var o=$("<option></option>").append(n.name);$(o).val(n.equation),$("select").append(o)}var o=location.search.substring(1),t=o.split("=")[1]+".json";$.getJSON(t,function(o){window.professorConfigFile=o,$.each(o,function(o,t){n(t),0===o&&changePlot(t.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:100,startLeftOff:530,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,o={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},a={datapoints:[],currentRound:0,graphOpt:o};t.each(function(t){var n,e=$(this).val();if(e&&(n=+e,profOpt.view.x.min<=n&&n<=profOpt.view.x.max)){var i=o.equation.replace("x","("+n+")"),p=math.eval(i),r=(this.getBoundingClientRect(),{x:n,y:p,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});r.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,a.datapoints.push(r)}}),animatorControl(a)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,o){o.equation===t&&(n=o)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){xMemory=[],clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,o=$("#functionMachine #equ")[0],a=$("#functionMachine #y");$(o).empty(""),katex.render(n,a[0]),katex.render(e,o)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;i<inputCount;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}for(var inputs=document.querySelectorAll("input[type='number']"),run=!0,i=0;i<inputs.length;i++)inputs[i].oninput=function(t){var n=t.srcElement.value;profOpt.view.x.min<=n&&n<=profOpt.view.x.max?(run=!0,$("input[type='button'][value='Go!']").prop("disabled",!1).css({cursor:"pointer"}),console.log("Validated!")):(run=!1,$("input[type='button'][value='Go!']").prop("disabled",!0).css({cursor:"not-allowed"}),$("#status p").html("<p>"+n+" x-value out of domains.</p>"),console.log("Not Validated!"))};$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&run&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(e){var a=e.datapoints[e.currentRound],i=a.element;return new Promise(function(a){$(i).html(t).css({animation:""+n+e.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){a(e)})})}}function statusMessage(n){return function(t){return new Promise(function(e){statusBar.html("<p>"+n+"</p>"),e(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],e=t.changeEqu;return new Promise(function(t){katex.render(""+e,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),e(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){var a=$("td#yval"+(t.id+1))[0];$(a).html(""),$(a).append("<p>"+t.y+"</p>"),e(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){n.currentRound+=1,t.updatePoint=!1,e(n)})}function animateGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../functionMachineAni.gif)"}),t(n)})}function stopAniGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../functionMachineStill.gif)"}),t(n)})}function miniAni(n){return new Promise(function(t){var e=n.datapoints[n.currentRound],a=e.y,i=$("<p>"+a+"</p>");$("body").append(i),i.css({position:"absolute",opacity:0,left:550,top:50}).animate({opacity:1,top:100},function(e){i.css({display:"none"}),t(n)})})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(animateGif).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(stopAniGif).then(miniAni).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),e=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,e):aniPromiseChain(n,e)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwicXVlcnlTdHJpbmciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5Iiwic3BsaXQiLCJnZXRKU09OIiwicmVzdWx0Iiwid2luZG93IiwicHJvZmVzc29yQ29uZmlnRmlsZSIsImVhY2giLCJpIiwiY2hhbmdlUGxvdCIsInN0YWlyU3RlcCIsIm9wdGlvbnMiLCJoaWdod2F5UGF0aCIsImxhc3RTaGVldCIsImluc2VydFJ1bGUiLCJzdGFydFRvcE9mZiIsInN0YXJ0TGVmdE9mZiIsImVuZFRvcE9mZiIsImVuZExlZnRPZmYiLCJjc3NSdWxlcyIsImxlbmd0aCIsIm1ha2VYVG9NYWNoaW5lIiwiaW5wdXRDb3JkcyIsImluZGV4IiwidG9wIiwibGVmdCIsIm1ha2VNYWNoaW5lVG9ZIiwicmlnaHQiLCJtYWtlWVRvU3RhdHVzQmFyIiwic3RhcnRGdW5jTWFjaCIsInhpbnB1dHMiLCJoaWRlQW5pbWF0aW9uQ2hlY2tlZCIsImhpZGVHcmFwaENoZWNrZWQiLCJncmFwaE9wdCIsImNhbGxiYWNrIiwiYW5pU2V0dGluZ3MiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvbnNvbGUiLCJsb2ciLCJhbmltYXRlSGlkZSIsImdyYXBoSGlkZSIsInByb2ZPcHQiLCJ2aWV3IiwiZGF0YXBvaW50cyIsImN1cnJlbnRSb3VuZCIsInh2YWwiLCJ4dmFsdWUiLCJ0aGlzIiwieCIsIm1pbiIsIm1heCIsInJlcGxhY2VYIiwicmVwbGFjZSIsInl2YWwiLCJtYXRoIiwiZXZhbCIsInBvaW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieSIsImlkIiwiY2hhbmdlRXF1IiwidXBkYXRlUG9pbnQiLCJ4TWVtb3J5IiwiZWxlbWVudCIsImdldCIsImh0bWwiLCJwdXNoIiwiYW5pbWF0b3JDb250cm9sIiwiY2hlY2tDb25maWciLCJpdGVtIiwiY2xlYXJWYWx1ZXMiLCJ5aW5wdXRzIiwidmFsdWUiLCJpbm5lckhUTUwiLCJlcXVhdCIsImVxdVBhcmEiLCJ5UGFyYSIsImVtcHR5Iiwia2F0ZXgiLCJyZW5kZXIiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRDb3VudCIsInN0eWxlU2hlZXRzIiwiaW5wdXRDb29yIiwicnVuIiwib25pbnB1dCIsImUiLCJ4SW5wdXRWYWwiLCJzcmNFbGVtZW50IiwicHJvcCIsImNzcyIsImN1cnNvciIsImNoYW5nZSIsInRhcmdldCIsImtleXByZXNzIiwid2hpY2giLCJjbGljayIsInJ1bkFuaW1hdGlvbiIsImRhdGFwb2ludCIsIm51bVBhcmEiLCJhbmltYXRpb24iLCJhbmlEdXJhdGlvbiIsIm9uZSIsInN0YXR1c01lc3NhZ2UiLCJtZXNzYWdlIiwic3RhdHVzQmFyIiwicmVwbGFjZVhFcXUiLCJkYXRhIiwic2hvd0V2YWx1YXRlRXF1IiwicG9pbnREYXRhIiwic2hvd1lBbnMiLCJzaG93RXF1YXRpb25BZ2FpbiIsInBsYWNlWVZhbHVlIiwicmVzZXRSb3VuZCIsInNob3dEZWZhdWx0RXF1IiwicGxvdHRlciIsInVwZGF0ZVJvdW5kIiwicGxhY2Vob2xkZXIiLCJhbmltYXRlR2lmIiwiYmFja2dyb3VuZC1pbWFnZSIsInN0b3BBbmlHaWYiLCJtaW5pQW5pIiwieXZhbHVlIiwicGFyYSIsInBvc2l0aW9uIiwib3BhY2l0eSIsImFuaW1hdGUiLCJkaXNwbGF5IiwiYW5pUHJvbWlzZUNoYWluIiwiZHBzIiwiY2hhaW4iLCJmb3JFYWNoIiwidGhlbiIsIm5vQW5pUHJvbWlzZUNoYWluIiwibnVtQ29udGFpbmVyIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUFDLFdB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VUFDTHNCLEtBQUtyQixtQkFDTHFCLEtBQUtaLFlBQ0xZLEtBQUtYLFNBQ0xXLEtBQUtuQyxhQUFhLGFBQWNDLEVBQVV6QyxJQUMxQzJFLEtBQUtwQixhQUNMb0IsS0FBS25DLGFBQWEsZUFBYixJQUFpQ0MsRUFBVW5ELEVBQTNDLElBQWdEbUQsRUFBVXpDLEVBQTFELE1BQ0wyRSxLQUFLN0IsY0FBQSxhQUEyQkwsRUFBVW5ELEVBQXJDLElBQTBDbUQsRUFBVXpDLEVBQXBELE1BQ0wyRSxLQUFLakIsU0FDTGlCLEtBQUtuQixZQUNMbUIsS0FBSzdCLGNBQUEsS0FDTDZCLEtBQUtsQixpQkFHZGdCLEVBQVFBLEVBQU1FLEtBQUtoQixlQUkzQixRQUFTaUIsbUJBQWtCSixFQUFLQyxHQUM1QkQsRUFBSXZGLFdBQVd5RixRQUFRLFNBQVVqQyxHQUN6QkEsRUFBVXRDLGVBQWdCLElBQzFCc0UsRUFBUUEsRUFDSEUsS0FBS3BCLGFBQ0xvQixLQUFLakIsVUFFZGUsRUFBUUEsRUFBTUUsS0FBS2hCLGVBTzNCLFFBQVNsRCxpQkFBZ0IrRCxHQUdyQixHQUFJSyxHQUFleEosRUFBRSxpQkFDakJvSixFQUFRaEcsUUFBUUMsUUFBUThGLEVBRTVCSyxHQUFhOUQsVUFBWSxHQUVyQnlELEVBQUlsRyxTQUFTTyxZQUNiK0Ysa0JBQWtCSixFQUFLQyxHQUV2QkYsZ0JBQWdCQyxFQUFLQyxHQTdTN0IsR0FBSXpCLFdBQVkzSCxFQUFFLGFBQ2Q2QixVQUFZeEIsU0FBUytGLFlBQVkvRixTQUFTK0YsWUFBWWhFLE9BQVMsR0FDL0R3RCxRQUFVNUYsRUFBRSx5QkFBeUIsR0FDckN1SCxZQUFjIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIE1ha2UgdGhlIHdob2xlIHRhYmxlIGFuZCBjZWxscyBmb3IgdGhlIGlucHV0IGJveGVzIGFuZCB1c2VyIGludGVyYWN0aW9uLlxyXG4gICAgKi9cclxuICAgIHZhciB0Ym9keSA9ICQoXCJ0Ym9keVwiKSxcclxuICAgICAgICB0ZDEsXHJcbiAgICAgICAgdGQyLFxyXG4gICAgICAgIHRyLFxyXG4gICAgICAgIGlucHV0LFxyXG4gICAgICAgIHJvd0NvdW50ID0gMTk7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xyXG4gICAgICAgIGlucHV0ID0gJChcIjxpbnB1dD5cIik7XHJcbiAgICAgICAgdGQxID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRyID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHJcbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XHJcblxyXG4gICAgICAgICQoaW5wdXQpLmF0dHIoXCJuYW1lXCIsIGBpbnB1dCR7an1gKS5hdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcclxuXHJcbiAgICAgICAgJCh0ZDIpLmF0dHIoXCJpZFwiLCBgeXZhbCR7an1gKTtcclxuXHJcbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgJCh0cikuYXBwZW5kKHRkMSkuYXBwZW5kKHRkMik7XHJcbiAgICAgICAgJCh0Ym9keSkuYXBwZW5kKHRyKTtcclxuICAgIH1cclxufSgpKTtcclxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIFF1ZXJ5IHN1YnN0cmluZ1xyXG4gICAgKi9cclxuICAgIHZhciBxdWVyeVN0cmluZyA9IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSksXHJcbiAgICAgICAgcXVlcnkgPSBxdWVyeVN0cmluZy5zcGxpdChcIj1cIilbMV0gKyBcIi5qc29uXCI7XHJcblxyXG4gICAgZnVuY3Rpb24gc2hvd1Byb2ZPcHRpb25zKGZpZWxkKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBBcHBlbmQgdGhlIHByb2Zlc3NvcidzIGNob3NlbiBlcXVhdGlvbnMgdG8gdGhlIGFwcGxpY2F0aW9uXHJcbiAgICAgICAgKi9cclxuXHJcbiAgICAgICAgdmFyIG9wdCA9ICQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hcHBlbmQoZmllbGQubmFtZSk7XHJcblxyXG4gICAgICAgICQob3B0KS52YWwoZmllbGQuZXF1YXRpb24pO1xyXG5cclxuICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIHRoZSBwcm9mZXNzb3IgY29uZmlndXJhdGlvbiBmaWxlXHJcbiAgICAqL1xyXG5cclxuICAgICQuZ2V0SlNPTihxdWVyeSwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZmVzc29yQ29uZmlnRmlsZSA9IHJlc3VsdDtcclxuXHJcbiAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGksIGZpZWxkKSB7XHJcblxyXG4gICAgICAgICAgICBzaG93UHJvZk9wdGlvbnMoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QoZmllbGQuZXF1YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxufSk7XHJcbiIsIiAgICB2YXIgeE1lbW9yeSA9IFtdLFxyXG4gICAgICAgIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICBpbnB1dENvdW50ID0gaW5wdXRzLmxlbmd0aCxcclxuICAgICAgICBsYXN0U2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXTtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0aW9uIHBhdGggZm9yIHRoZSBzdGFpcnN0ZXBcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdGFpclN0ZXAob3B0aW9ucykge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHZhciBoaWdod2F5UGF0aCA9IDI0Ni41O1xyXG4gICAgICAgIGxhc3RTaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7b3B0aW9ucy5uYW1lfSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke29wdGlvbnMuc3RhcnRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMzMlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNjYlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtoaWdod2F5UGF0aH1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDkwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuZW5kVG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5lbmRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9YCwgbGFzdFNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIEEgc2V0IG9mIGZ1bmN0aW9ucyB1c2luZyB0aGUgc3RhaXJzdGVwIGFuaW1hdGlvbiB0ZW1wbGF0ZVxyXG4gICAgdG8gY3JlYXRlIHBhdGh3YXlzIHdpdGggY29vcmRpbmF0ZSBkYXRhXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWFrZVhUb01hY2hpbmUoaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMubGVmdCArIDMwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDU1LFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIG5hbWU6IGB4VG9NYWNoaW5lJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZU1hY2hpbmVUb1koaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogMTAwLFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IDUzMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXHJcbiAgICAgICAgICAgIGVuZExlZnRPZmY6IGlucHV0Q29yZHMucmlnaHQgKyA1LFxyXG4gICAgICAgICAgICBuYW1lOiBgbWFjaGluZVRvWSR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMucmlnaHQgKyAxMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiAxNTAsXHJcbiAgICAgICAgICAgIGVuZExlZnRPZmY6IDMwMCxcclxuICAgICAgICAgICAgbmFtZTogYHlUb1N0YXR1c0JhciR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBTZXQgdXAgdGhlIHhNZW1vcnkgYXJyYXkgYW5kIHRoZSBhbmltYXRpb24gcGF0aHMgZm9yIGVhY2ggaW5wdXQgYm94LlxyXG5cclxuICAgIE5PVEU6IFNldHRpbmcgdXAgdGhlIHhNZW1vcnkgYXJyYXkgYWxzbyBtYWtlcyBpdCBzbyB0aGF0IG5vIGFuaW1hdGlvbnNcclxuICAgICAgICAgIGFyZSByZXBlYXRlZCBieSBtdWx0aXBsZSBjbGlja3Mgb24gdGhlIFwiR28hXCIgYnV0dG9uLlxyXG4gICAgKi9cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgeE1lbW9yeVtpXSA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBpbnB1dENvb3IgPSBpbnB1dHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29vciwgaSk7XHJcbiAgICAgICAgbWFrZU1hY2hpbmVUb1koaW5wdXRDb29yLCBpKTtcclxuICAgICAgICBtYWtlWVRvU3RhdHVzQmFyKGlucHV0Q29vciwgaSk7XHJcbiAgICAgICAgJChcIiNudW1Db250YWluZXJcIikuYXBwZW5kKCQoYDxwPjwvcD5gKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIFNldCBhbGwgdGhlIGRhdGEgdG8gYW4gYXJyYXkgb2Ygb2JqZWN0cyB0byBiZSBpdGVyYXRlZFxyXG4gICAgb3ZlciBieSB0aGUgcHJvbWlzZSBjaGFpbiBpbiBhbmltYXRvcmNvbnRyb2wuanNcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdGFydEZ1bmNNYWNoKCkge1xyXG5cclxuICAgICAgICB2YXIgeGlucHV0cyA9ICQoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICAgICAgaGlkZUFuaW1hdGlvbkNoZWNrZWQgPSAkKFwiI2FuaW1hdGU6Y2hlY2tlZFwiKS5sZW5ndGggPiAwLFxyXG4gICAgICAgICAgICBoaWRlR3JhcGhDaGVja2VkID0gJChcIiNzaG93R3JhcGg6Y2hlY2tlZFwiKS5sZW5ndGggPiAwLFxyXG4gICAgICAgICAgICBncmFwaE9wdCA9IHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaW5pc2hlZCBwbG90dGluZyBkYXRhcG9pbnQhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBhbmltYXRlSGlkZTogaGlkZUFuaW1hdGlvbkNoZWNrZWQsXHJcbiAgICAgICAgICAgICAgICBncmFwaEhpZGU6IGhpZGVHcmFwaENoZWNrZWQsXHJcbiAgICAgICAgICAgICAgICBlcXVhdGlvbjogcHJvZk9wdC5lcXVhdGlvbixcclxuICAgICAgICAgICAgICAgIHZpZXc6IHByb2ZPcHQudmlld1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhbmlTZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgICAgIGRhdGFwb2ludHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFJvdW5kOiAwLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhPcHQ6IGdyYXBoT3B0XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIHhpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICB2YXIgeHZhbHVlID0gJCh0aGlzKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHh2YWw7XHJcblxyXG4gICAgICAgICAgICBpZiAoeHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB4dmFsID0gK3h2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9mT3B0LnZpZXcueC5taW4gPD0geHZhbCAmJiB4dmFsIDw9IHByb2ZPcHQudmlldy54Lm1heCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZVggPSBncmFwaE9wdC5lcXVhdGlvbi5yZXBsYWNlKFwieFwiLCBgKCR7eHZhbH0pYCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHl2YWwgPSBtYXRoLmV2YWwocmVwbGFjZVgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dENvb3IgPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHh2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB5dmFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VFcXU6IHByb2ZPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3h2YWx9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUG9pbnQ6IHhNZW1vcnlbaV0gIT09IHh2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiAkKFwiI251bUNvbnRhaW5lciBwXCIpLmdldChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyIG91dCB0aGUgWXMgd2hlbiB0aGV5IGRvbid0IGVxdWFsIGVhY2ggb3RoZXIgYW5kIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50LnVwZGF0ZVBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYHRkI3l2YWwke2kgKyAxfWApLmh0bWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlVwZGF0ZSB0aGUgeG1lbW9yeSovXHJcbiAgICAgICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHh2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGFuaVNldHRpbmdzLmRhdGFwb2ludHMucHVzaChwb2ludCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9GdW5jdGlvbiB0byBzZWxlY3QgdGhlIGNob3NlbiBlcXVhdGlvbiB3aXRoIGl0cyBuYW1lIGFuZCBncmFwaCB3aW5kb3cgYm91bmRhcmllcy5cclxuICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmlnKHZhbCkge1xyXG4gICAgICAgIHZhciBwcm9mT3B0O1xyXG4gICAgICAgICQuZWFjaChwcm9mZXNzb3JDb25maWdGaWxlLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5lcXVhdGlvbiA9PT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9mT3B0ID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHByb2ZPcHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xlYXJWYWx1ZXMoKSB7XHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgICAgIHlpbnB1dHMgPSAkKGB0ciB0ZDpudGgtb2YtdHlwZSgyKWApO1xyXG5cclxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9EaXBzbGF5IEthdGV4IGVxdWF0aW9uXHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xyXG5cclxuICAgICAgICB4TWVtb3J5ID0gW107XHJcblxyXG4gICAgICAgIGNsZWFyVmFsdWVzKCk7XHJcblxyXG4gICAgICAgIHdpbmRvdy5wcm9mT3B0ID0gY2hlY2tDb25maWcodmFsKTtcclxuXHJcbiAgICAgICAgdmFyIHkgPSBgeSA9IGAsXHJcbiAgICAgICAgICAgIGVxdWF0ID0gYCR7dmFsfWAsXHJcbiAgICAgICAgICAgIGVxdVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjZXF1XCIpWzBdLFxyXG4gICAgICAgICAgICB5UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICN5XCIpO1xyXG5cclxuICAgICAgICAkKGVxdVBhcmEpLmVtcHR5KFwiXCIpO1xyXG5cclxuICAgICAgICBrYXRleC5yZW5kZXIoeSwgeVBhcmFbMF0pO1xyXG4gICAgICAgIGthdGV4LnJlbmRlcihlcXVhdCwgZXF1UGFyYSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICBydW4gPSB0cnVlO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRzLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgIGlucHV0c1tpXS5vbmlucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB4SW5wdXRWYWwgPSBlLnNyY0VsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChwcm9mT3B0LnZpZXcueC5taW4gPD0geElucHV0VmFsICYmIHhJbnB1dFZhbCA8PSBwcm9mT3B0LnZpZXcueC5tYXgpIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnByb3AoXCJkaXNhYmxlZFwiLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJzb3JcIjogXCJwb2ludGVyXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmFsaWRhdGVkIVwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJChcImlucHV0W3R5cGU9J2J1dHRvbiddW3ZhbHVlPSdHbyEnXVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJzb3JcIjogXCJub3QtYWxsb3dlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3N0YXR1cyBwXCIpLmh0bWwoYDxwPiR7eElucHV0VmFsfSB4LXZhbHVlIG91dCBvZiBkb21haW5zLjwvcD5gKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90IFZhbGlkYXRlZCFcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIE9uY2hhbmdlIGV2ZW50IGhhbmRsZXIgZm9yIHRoZSBzZWxlY3QgaHRtbCBlbGVtZW50LlxyXG4gICAgKi9cclxuICAgICQoXCJzZWxlY3RcIikuY2hhbmdlKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgY2hhbmdlUGxvdChlLnRhcmdldC52YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgRE9DVU1FTlQga2V5ZG93biBldmVudCBoYW5kbGVyXHJcbiAgICAqL1xyXG4gICAgJChkb2N1bWVudCkua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PSAxMyAmJiBydW4pIHtcclxuICAgICAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBHTyEgQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgIH0pO1xyXG4iLCJ2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKSxcclxuICAgIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLFxyXG4gICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICBhbmlEdXJhdGlvbiA9IDE7XHJcblxyXG5mdW5jdGlvbiBydW5BbmltYXRpb24obmFtZSwgdmFsdWUpIHtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gYW5pbWF0aW9uKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgdmFyIGRhdGFwb2ludCA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICAgICAgbnVtUGFyYSA9IGRhdGFwb2ludC5lbGVtZW50O1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgIE1ha2UgdGhlIHByb21pc2UgdGhhdCB3aGVuIHRoZSBkeW5hbWljXHJcbiAgICAgICAgYW5pbWF0aW9uIHBhdGggaXMgZG9uZSB0aGVuIHRoaXMgcHJvbWlzZSBpcyBmaW5pc2hlZFxyXG4gICAgICAgICovXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICQobnVtUGFyYSlcclxuICAgICAgICAgICAgICAgIC5odG1sKHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhbmltYXRpb25cIjogYCR7bmFtZX0ke2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZH0gJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YCxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAub25lKCdhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RhdHVzTWVzc2FnZShtZXNzYWdlKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIHN0YXR1c0Jhci5odG1sKGA8cD4ke21lc3NhZ2V9PC9wPmApO1xyXG4gICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXBsYWNlWEVxdShkYXRhKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgUmVwbGFjZSB0aGUgeCBpbiB0aGUgZGlzYXBwZWFyZWQgZXF1YXRpb24gd2l0aG91dCBoYXZpbmcgdGhlIHkgZGlzYXBwZWFyLlxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXZhbHVhdGVFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIHkgYW5zd2VyIGFuZCB0aGUgeC1jaGFuZ2VkIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICBjaGFuZ2VFcXUgPSBwb2ludERhdGEuY2hhbmdlRXF1O1xyXG5cclxuICAgIC8qXHJcbiAgICBTaG93IHRoZSBuZXcgZXF1YXRpb24gd2l0aCB0aGUgcmVwbGFjZWQgeC12YWx1ZSBlcXVhdGlvblxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGthdGV4LnJlbmRlcihgJHtjaGFuZ2VFcXV9YCwgZXF1UGFyYSk7XHJcblxyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93WUFucyhhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEFuaW1hdGUgdGhlIG5ldyB5IHZhbHVlIHRvIHRoZSBjb29yZGluYXRlZCB5IGNvbHVtbiBhbmQgb25jZVxyXG4gICAgYW5pbWF0aW9uIGlzIGRvbmUgdGhlbiByZXR1cm4gdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwb2ludERhdGEueX1gLCBlcXVQYXJhKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXF1YXRpb25BZ2FpbihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwbGFjZVlWYWx1ZShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSB5LXZhbHVlIGFwcGVhcnMgaW4gdGhlIGNvcnJlY3QgeS1jb2x1bW4gdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlLlxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIHZhciBpbnB1dCA9ICQoYHRkI3l2YWwke3BvaW50RGF0YS5pZCArIDF9YClbMF07XHJcbiAgICAgICAgJChpbnB1dCkuaHRtbChcIlwiKTtcclxuICAgICAgICAkKGlucHV0KS5hcHBlbmQoYDxwPiR7cG9pbnREYXRhLnl9PC9wPmApO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0Um91bmQoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIGN1cnJlbnQgcm91bmQgYW5kIGN1cnJlbnQgZGF0YSBwb2ludHNcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSBlcXVhdGlvbiBpcyBjbGVhcmVkIGFuZCByZXNldCB0byB0aGUgZGVmYXVsdCBlcXVhdGlvblxyXG4gICAgdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwcm9mT3B0LmVxdWF0aW9ufWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dEZWZhdWx0RXF1KGFuaVNldHRpbmdzKSB7XHJcbiAgICAvKlxyXG4gICAgUmV0dXJuIHRvIGRlZmF1bHQgYmVnaW5uaW5nIGVxdWF0aW9uIGZvciB0aGUgbmV4dCBhbmltYXRpb24gb3IgZm9yIHRoZSBlbmRcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbkFjY2VwdCB0aGUgZGF0YXBvaW50IGFuZCBpdHMgaXRlcmF0b3IgYW5kIHBsb3QgdGhhdCBwb2ludCBiZWluZyBwYXNzZWQgdGhyb3VnaFxyXG4qL1xyXG5mdW5jdGlvbiBwbG90dGVyKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgYW5pU2V0dGluZ3MuZ3JhcGhPcHQuY2FsbGJhY2soKTtcclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIHBsYWNlaG9sZGVyID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBUaGlzIGZ1bmN0aW9uIGFjdHMgYXMgYW4gaXRlcmF0b3Igc28gdGhhdCB0aGUgcHJvbWlzZSBjaGFpbiBrbm93cyB3aGljaFxyXG4gICAgZGF0YXBvaW50IHRvIGhhbmRsZSBhbmQgdG8gYW5pbWF0ZVxyXG4gICAgKi9cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5jdXJyZW50Um91bmQgKz0gMTtcclxuICAgICAgICBwbGFjZWhvbGRlci51cGRhdGVQb2ludCA9IGZhbHNlO1xyXG5cclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gYW5pbWF0ZUdpZihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChcIiNmdW5jdGlvbk1hY2hpbmVcIikuY3NzKHtcclxuICAgICAgICAgICAgXCJiYWNrZ3JvdW5kLWltYWdlXCI6IFwidXJsKC4uL2Z1bmN0aW9uTWFjaGluZUFuaS5naWYpXCJcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpXHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcEFuaUdpZihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChcIiNmdW5jdGlvbk1hY2hpbmVcIikuY3NzKHtcclxuICAgICAgICAgICAgXCJiYWNrZ3JvdW5kLWltYWdlXCI6IFwidXJsKC4uL2Z1bmN0aW9uTWFjaGluZVN0aWxsLmdpZilcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncylcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtaW5pQW5pKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuXHJcbiAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgICAgICB5dmFsdWUgPSBwbGFjZWhvbGRlci55LFxyXG4gICAgICAgICAgICBwYXJhID0gJChgPHA+JHt5dmFsdWV9PC9wPmApO1xyXG5cclxuICAgICAgICAkKFwiYm9keVwiKS5hcHBlbmQocGFyYSk7XHJcblxyXG4gICAgICAgIHBhcmFcclxuICAgICAgICAgICAgLmNzcyh7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IDU1MCxcclxuICAgICAgICAgICAgICAgIHRvcDogNTBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgICAgICAgICAgIHRvcDogMTAwXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogXCJub25lXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xyXG4gICAgZHBzLmRhdGFwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YXBvaW50KSB7XHJcbiAgICAgICAgaWYgKGRhdGFwb2ludC51cGRhdGVQb2ludCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBjaGFpbiA9IGNoYWluXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJ4VG9NYWNoaW5lXCIsIGRhdGFwb2ludC54KSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGFuaW1hdGVHaWYpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKFwiQ2FsY3VsYXRpbmdcIikpXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXBsYWNlWEVxdSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dFdmFsdWF0ZUVxdSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dZQW5zKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0VxdWF0aW9uQWdhaW4pXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdG9wQW5pR2lmKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4obWluaUFuaSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcIm1hY2hpbmVUb1lcIiwgZGF0YXBvaW50LnkpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJ5VG9TdGF0dXNCYXJcIiwgYCgke2RhdGFwb2ludC54fSwke2RhdGFwb2ludC55fSlgKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoYFBsb3R0aW5nICgke2RhdGFwb2ludC54fSwke2RhdGFwb2ludC55fSlgKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsb3R0ZXIpXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXNldFJvdW5kKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShgYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RGVmYXVsdEVxdSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBjaGFpbiA9IGNoYWluLnRoZW4odXBkYXRlUm91bmQpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vQW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pIHtcclxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xyXG4gICAgICAgIGlmIChkYXRhcG9pbnQudXBkYXRlUG9pbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKlxyXG5IYW5kbGUgYWxsIENTUyBhbmltYXRpb25zIGJ5IGNyZWF0aW5nIGEgUHJvbWlzZSBjaGFpbiB0aHJvdWdoIGEgZm9yIGxvb3AuXHJcbiovXHJcbmZ1bmN0aW9uIGFuaW1hdG9yQ29udHJvbChkcHMpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBudW1Db250YWluZXIgPSAkKFwiI251bUNvbnRhaW5lclwiKSxcclxuICAgICAgICBjaGFpbiA9IFByb21pc2UucmVzb2x2ZShkcHMpO1xyXG5cclxuICAgIG51bUNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG5cclxuICAgIGlmIChkcHMuZ3JhcGhPcHQuYW5pbWF0ZUhpZGUpIHtcclxuICAgICAgICBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pO1xyXG4gICAgfVxyXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
