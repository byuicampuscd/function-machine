"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;e<=n;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var t=$("<option></option>").append(n.name);$(t).val(n.equation),$("select").append(t)}var t=location.search.substring(1),o=t.split("=")[1]+".json";$.getJSON(o,function(t){window.professorConfigFile=t,$.each(t,function(t,o){n(o),0===t&&changePlot(o.equation)})}).fail(function(){$("#status p").append("Add a query string")})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:100,startLeftOff:530,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,o={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},a={datapoints:[],currentRound:0,graphOpt:o};t.each(function(t){var n,e,i=$(this).val();if(i&&(n=+i,e=n.toFixed(profOpt.rounding),$(this).val(e),profOpt.view.x.min<=e&&e<=profOpt.view.x.max)){var p=o.equation.replace("x","("+e+")"),r=math.eval(p),u=(this.getBoundingClientRect(),{x:e,y:r.toFixed(profOpt.rounding),id:t,changeEqu:profOpt.equation.replace("x","("+e+")"),updatePoint:xMemory[t]!==e,element:$("#numContainer p").get(t)});u.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=e,a.datapoints.push(u)}}),animatorControl(a)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,o){o.equation===t&&(n=o)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){xMemory=[],clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,o=$("#functionMachine #equ")[0],a=$("#functionMachine #y");$(o).empty(""),katex.render(n,a[0]),katex.render(e,o)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;i<inputCount;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}for(var inputs=document.querySelectorAll("input[type='number']"),run=!0,i=0;i<inputs.length;i++)inputs[i].oninput=function(t){var n=t.srcElement.value;profOpt.view.x.min<=n&&n<=profOpt.view.x.max?(run=!0,$("input[type='button'][value='Go!']").prop("disabled",!1).css({cursor:"pointer"}),$("#status p").html("")):(run=!1,$("input[type='button'][value='Go!']").prop("disabled",!0).css({cursor:"not-allowed"}),$("#status p").html(n+" x-value out of domains."))};$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&run&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(e){var a=e.datapoints[e.currentRound],i=a.element;return new Promise(function(a){$(i).html(t).css({animation:""+n+e.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){a(e)})})}}function statusMessage(n){var t=$("#status p");return function(e){return new Promise(function(a){t.html(n),a(e)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],e=t.changeEqu;return new Promise(function(t){katex.render(""+e,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),e(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){var a=$("td#yval"+(t.id+1))[0];$(a).html(""),$(a).append("<p>"+t.y+"</p>"),e(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){n.currentRound+=1,t.updatePoint=!1,e(n)})}function animateGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(./functionMachineAni.gif)"}),t(n)})}function stopAniGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(./functionMachineStill.gif)"}),t(n)})}function miniAni(n){return new Promise(function(t){var e=n.datapoints[n.currentRound],a=e.y,i=$("<p>"+a+"</p>");$("body").append(i),i.css({position:"absolute",opacity:0,left:550,top:50}).animate({opacity:1,top:100},function(e){i.css({display:"none"}),t(n)})})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(animateGif).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(stopAniGif).then(miniAni).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),e=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,e):aniPromiseChain(n,e)}var lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwicXVlcnlTdHJpbmciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5Iiwic3BsaXQiLCJnZXRKU09OIiwicmVzdWx0Iiwid2luZG93IiwicHJvZmVzc29yQ29uZmlnRmlsZSIsImVhY2giLCJpIiwiY2hhbmdlUGxvdCIsImZhaWwiLCJzdGFpclN0ZXAiLCJvcHRpb25zIiwiaGlnaHdheVBhdGgiLCJsYXN0U2hlZXQiLCJpbnNlcnRSdWxlIiwic3RhcnRUb3BPZmYiLCJzdGFydExlZnRPZmYiLCJlbmRUb3BPZmYiLCJlbmRMZWZ0T2ZmIiwiY3NzUnVsZXMiLCJsZW5ndGgiLCJtYWtlWFRvTWFjaGluZSIsImlucHV0Q29yZHMiLCJpbmRleCIsInRvcCIsImxlZnQiLCJtYWtlTWFjaGluZVRvWSIsInJpZ2h0IiwibWFrZVlUb1N0YXR1c0JhciIsInN0YXJ0RnVuY01hY2giLCJ4aW5wdXRzIiwiaGlkZUFuaW1hdGlvbkNoZWNrZWQiLCJoaWRlR3JhcGhDaGVja2VkIiwiZ3JhcGhPcHQiLCJjYWxsYmFjayIsImFuaVNldHRpbmdzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb25zb2xlIiwibG9nIiwiYW5pbWF0ZUhpZGUiLCJncmFwaEhpZGUiLCJwcm9mT3B0IiwidmlldyIsImRhdGFwb2ludHMiLCJjdXJyZW50Um91bmQiLCJ4dmFsIiwicm91bmRpdCIsInh2YWx1ZSIsInRoaXMiLCJ0b0ZpeGVkIiwicm91bmRpbmciLCJ4IiwibWluIiwibWF4IiwicmVwbGFjZVgiLCJyZXBsYWNlIiwieXZhbCIsIm1hdGgiLCJldmFsIiwicG9pbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ5IiwiaWQiLCJjaGFuZ2VFcXUiLCJ1cGRhdGVQb2ludCIsInhNZW1vcnkiLCJlbGVtZW50IiwiZ2V0IiwiaHRtbCIsInB1c2giLCJhbmltYXRvckNvbnRyb2wiLCJjaGVja0NvbmZpZyIsIml0ZW0iLCJjbGVhclZhbHVlcyIsInlpbnB1dHMiLCJ2YWx1ZSIsImlubmVySFRNTCIsImVxdWF0IiwiZXF1UGFyYSIsInlQYXJhIiwiZW1wdHkiLCJrYXRleCIsInJlbmRlciIsImlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dENvdW50Iiwic3R5bGVTaGVldHMiLCJpbnB1dENvb3IiLCJydW4iLCJvbmlucHV0IiwiZSIsInhJbnB1dFZhbCIsInNyY0VsZW1lbnQiLCJwcm9wIiwiY3NzIiwiY3Vyc29yIiwiY2hhbmdlIiwidGFyZ2V0Iiwia2V5cHJlc3MiLCJ3aGljaCIsImNsaWNrIiwicnVuQW5pbWF0aW9uIiwiZGF0YXBvaW50IiwibnVtUGFyYSIsImFuaW1hdGlvbiIsImFuaUR1cmF0aW9uIiwib25lIiwic3RhdHVzTWVzc2FnZSIsIm1lc3NhZ2UiLCJzdGF0dXNCYXIiLCJyZXBsYWNlWEVxdSIsInNob3dFdmFsdWF0ZUVxdSIsInBvaW50RGF0YSIsInNob3dZQW5zIiwic2hvd0VxdWF0aW9uQWdhaW4iLCJwbGFjZVlWYWx1ZSIsInJlc2V0Um91bmQiLCJzaG93RGVmYXVsdEVxdSIsInBsb3R0ZXIiLCJ1cGRhdGVSb3VuZCIsInBsYWNlaG9sZGVyIiwiYW5pbWF0ZUdpZiIsImJhY2tncm91bmQtaW1hZ2UiLCJzdG9wQW5pR2lmIiwibWluaUFuaSIsInl2YWx1ZSIsInBhcmEiLCJwb3NpdGlvbiIsIm9wYWNpdHkiLCJhbmltYXRlIiwiZGlzcGxheSIsImFuaVByb21pc2VDaGFpbiIsImRwcyIsImNoYWluIiwiZm9yRWFjaCIsInRoZW4iLCJub0FuaVByb21pc2VDaGFpbiIsIm51bUNvbnRh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XCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIE1ha2UgdGhlIHdob2xlIHRhYmxlIGFuZCBjZWxscyBmb3IgdGhlIGlucHV0IGJveGVzIGFuZCB1c2VyIGludGVyYWN0aW9uLlxyXG4gICAgKi9cclxuICAgIHZhciB0Ym9keSA9ICQoXCJ0Ym9keVwiKSxcclxuICAgICAgICB0ZDEsXHJcbiAgICAgICAgdGQyLFxyXG4gICAgICAgIHRyLFxyXG4gICAgICAgIGlucHV0LFxyXG4gICAgICAgIHJvd0NvdW50ID0gMTk7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xyXG4gICAgICAgIGlucHV0ID0gJChcIjxpbnB1dD5cIik7XHJcbiAgICAgICAgdGQxID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRyID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHJcbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XHJcblxyXG4gICAgICAgICQoaW5wdXQpLmF0dHIoXCJuYW1lXCIsIGBpbnB1dCR7an1gKS5hdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcclxuXHJcbiAgICAgICAgJCh0ZDIpLmF0dHIoXCJpZFwiLCBgeXZhbCR7an1gKTtcclxuXHJcbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgJCh0cikuYXBwZW5kKHRkMSkuYXBwZW5kKHRkMik7XHJcbiAgICAgICAgJCh0Ym9keSkuYXBwZW5kKHRyKTtcclxuICAgIH1cclxufSgpKTtcclxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIFF1ZXJ5IHN1YnN0cmluZ1xyXG4gICAgKi9cclxuICAgIHZhciBxdWVyeVN0cmluZyA9IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSksXHJcbiAgICAgICAgcXVlcnkgPSBxdWVyeVN0cmluZy5zcGxpdChcIj1cIilbMV0gKyBcIi5qc29uXCI7XHJcblxyXG4gICAgZnVuY3Rpb24gc2hvd1Byb2ZPcHRpb25zKGZpZWxkKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBBcHBlbmQgdGhlIHByb2Zlc3NvcidzIGNob3NlbiBlcXVhdGlvbnMgdG8gdGhlIGFwcGxpY2F0aW9uXHJcbiAgICAgICAgKi9cclxuXHJcbiAgICAgICAgdmFyIG9wdCA9ICQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hcHBlbmQoZmllbGQubmFtZSk7XHJcblxyXG4gICAgICAgICQob3B0KS52YWwoZmllbGQuZXF1YXRpb24pO1xyXG5cclxuICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIHRoZSBwcm9mZXNzb3IgY29uZmlndXJhdGlvbiBmaWxlXHJcbiAgICAqL1xyXG5cclxuICAgICQuZ2V0SlNPTihxdWVyeSwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZmVzc29yQ29uZmlnRmlsZSA9IHJlc3VsdDtcclxuXHJcbiAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGksIGZpZWxkKSB7XHJcblxyXG4gICAgICAgICAgICBzaG93UHJvZk9wdGlvbnMoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QoZmllbGQuZXF1YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJChcIiNzdGF0dXMgcFwiKS5hcHBlbmQoXCJBZGQgYSBxdWVyeSBzdHJpbmdcIilcclxuICAgIH0pOztcclxuXHJcbn0pO1xyXG4iLCIgICAgdmFyIHhNZW1vcnkgPSBbXSxcclxuICAgICAgICBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgaW5wdXRDb3VudCA9IGlucHV0cy5sZW5ndGgsXHJcbiAgICAgICAgbGFzdFNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoIC0gMV07XHJcblxyXG4gICAgLypcclxuICAgIEFuaW1hdGlvbiBwYXRoIGZvciB0aGUgc3RhaXJzdGVwXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3RhaXJTdGVwKG9wdGlvbnMpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICB2YXIgaGlnaHdheVBhdGggPSAyNDYuNTtcclxuICAgICAgICBsYXN0U2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke29wdGlvbnMubmFtZX0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuc3RhcnRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtvcHRpb25zLnN0YXJ0TGVmdE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDMzJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuc3RhcnRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtoaWdod2F5UGF0aH1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDY2JSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuZW5kVG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7aGlnaHdheVBhdGh9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA5MCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMDAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLmVuZFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke29wdGlvbnMuZW5kTGVmdE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfWAsIGxhc3RTaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBBIHNldCBvZiBmdW5jdGlvbnMgdXNpbmcgdGhlIHN0YWlyc3RlcCBhbmltYXRpb24gdGVtcGxhdGVcclxuICAgIHRvIGNyZWF0ZSBwYXRod2F5cyB3aXRoIGNvb3JkaW5hdGUgZGF0YVxyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiBpbnB1dENvcmRzLmxlZnQgKyAzMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiA1NSxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBuYW1lOiBgeFRvTWFjaGluZSR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IDEwMCxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiA1MzAsXHJcbiAgICAgICAgICAgIGVuZFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiBpbnB1dENvcmRzLnJpZ2h0ICsgNSxcclxuICAgICAgICAgICAgbmFtZTogYG1hY2hpbmVUb1kke2luZGV4fWBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtYWtlWVRvU3RhdHVzQmFyKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiBpbnB1dENvcmRzLnJpZ2h0ICsgMTAsXHJcbiAgICAgICAgICAgIGVuZFRvcE9mZjogMTUwLFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIG5hbWU6IGB5VG9TdGF0dXNCYXIke2luZGV4fWBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IHVwIHRoZSB4TWVtb3J5IGFycmF5IGFuZCB0aGUgYW5pbWF0aW9uIHBhdGhzIGZvciBlYWNoIGlucHV0IGJveC5cclxuXHJcbiAgICBOT1RFOiBTZXR0aW5nIHVwIHRoZSB4TWVtb3J5IGFycmF5IGFsc28gbWFrZXMgaXQgc28gdGhhdCBubyBhbmltYXRpb25zXHJcbiAgICAgICAgICBhcmUgcmVwZWF0ZWQgYnkgbXVsdGlwbGUgY2xpY2tzIG9uIHRoZSBcIkdvIVwiIGJ1dHRvbi5cclxuICAgICovXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Q291bnQ7IGkrKykge1xyXG4gICAgICAgIHhNZW1vcnlbaV0gPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgaW5wdXRDb29yID0gaW5wdXRzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICBtYWtlWFRvTWFjaGluZShpbnB1dENvb3IsIGkpO1xyXG4gICAgICAgIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29vciwgaSk7XHJcbiAgICAgICAgbWFrZVlUb1N0YXR1c0JhcihpbnB1dENvb3IsIGkpO1xyXG4gICAgICAgICQoXCIjbnVtQ29udGFpbmVyXCIpLmFwcGVuZCgkKGA8cD48L3A+YCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBTZXQgYWxsIHRoZSBkYXRhIHRvIGFuIGFycmF5IG9mIG9iamVjdHMgdG8gYmUgaXRlcmF0ZWRcclxuICAgIG92ZXIgYnkgdGhlIHByb21pc2UgY2hhaW4gaW4gYW5pbWF0b3Jjb250cm9sLmpzXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3RhcnRGdW5jTWFjaCgpIHtcclxuXHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgICAgIGhpZGVBbmltYXRpb25DaGVja2VkID0gJChcIiNhbmltYXRlOmNoZWNrZWRcIikubGVuZ3RoID4gMCxcclxuICAgICAgICAgICAgaGlkZUdyYXBoQ2hlY2tlZCA9ICQoXCIjc2hvd0dyYXBoOmNoZWNrZWRcIikubGVuZ3RoID4gMCxcclxuICAgICAgICAgICAgZ3JhcGhPcHQgPSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmluaXNoZWQgcGxvdHRpbmcgZGF0YXBvaW50IVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYW5pbWF0ZUhpZGU6IGhpZGVBbmltYXRpb25DaGVja2VkLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhIaWRlOiBoaWRlR3JhcGhDaGVja2VkLFxyXG4gICAgICAgICAgICAgICAgZXF1YXRpb246IHByb2ZPcHQuZXF1YXRpb24sXHJcbiAgICAgICAgICAgICAgICB2aWV3OiBwcm9mT3B0LnZpZXdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW5pU2V0dGluZ3MgPSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhcG9pbnRzOiBbXSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRSb3VuZDogMCxcclxuICAgICAgICAgICAgICAgIGdyYXBoT3B0OiBncmFwaE9wdFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgdmFyIHh2YWx1ZSA9ICQodGhpcykudmFsKCksXHJcbiAgICAgICAgICAgICAgICB4dmFsLFxyXG4gICAgICAgICAgICAgICAgcm91bmRpdDtcclxuXHJcbiAgICAgICAgICAgIGlmICh4dmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHh2YWwgPSAreHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgcm91bmRpdCA9IHh2YWwudG9GaXhlZChwcm9mT3B0LnJvdW5kaW5nKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnZhbChyb3VuZGl0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocHJvZk9wdC52aWV3LngubWluIDw9IHJvdW5kaXQgJiYgcm91bmRpdCA8PSBwcm9mT3B0LnZpZXcueC5tYXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VYID0gZ3JhcGhPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3JvdW5kaXR9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5dmFsID0gbWF0aC5ldmFsKHJlcGxhY2VYKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRDb29yID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiByb3VuZGl0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogeXZhbC50b0ZpeGVkKHByb2ZPcHQucm91bmRpbmcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VFcXU6IHByb2ZPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3JvdW5kaXR9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUG9pbnQ6IHhNZW1vcnlbaV0gIT09IHJvdW5kaXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiAkKFwiI251bUNvbnRhaW5lciBwXCIpLmdldChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyIG91dCB0aGUgWXMgd2hlbiB0aGV5IGRvbid0IGVxdWFsIGVhY2ggb3RoZXIgYW5kIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50LnVwZGF0ZVBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYHRkI3l2YWwke2kgKyAxfWApLmh0bWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlVwZGF0ZSB0aGUgeG1lbW9yeSovXHJcbiAgICAgICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHJvdW5kaXQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGFuaVNldHRpbmdzLmRhdGFwb2ludHMucHVzaChwb2ludCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9GdW5jdGlvbiB0byBzZWxlY3QgdGhlIGNob3NlbiBlcXVhdGlvbiB3aXRoIGl0cyBuYW1lIGFuZCBncmFwaCB3aW5kb3cgYm91bmRhcmllcy5cclxuICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmlnKHZhbCkge1xyXG4gICAgICAgIHZhciBwcm9mT3B0O1xyXG4gICAgICAgICQuZWFjaChwcm9mZXNzb3JDb25maWdGaWxlLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5lcXVhdGlvbiA9PT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9mT3B0ID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHByb2ZPcHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xlYXJWYWx1ZXMoKSB7XHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgICAgIHlpbnB1dHMgPSAkKGB0ciB0ZDpudGgtb2YtdHlwZSgyKWApO1xyXG5cclxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9EaXBzbGF5IEthdGV4IGVxdWF0aW9uXHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xyXG5cclxuICAgICAgICB4TWVtb3J5ID0gW107XHJcblxyXG4gICAgICAgIGNsZWFyVmFsdWVzKCk7XHJcblxyXG4gICAgICAgIHdpbmRvdy5wcm9mT3B0ID0gY2hlY2tDb25maWcodmFsKTtcclxuICAgICAgICB2YXIgeSA9IGB5ID0gYCxcclxuICAgICAgICAgICAgZXF1YXQgPSBgJHt2YWx9YCxcclxuICAgICAgICAgICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICAgICAgICAgIHlQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI3lcIik7XHJcblxyXG4gICAgICAgICQoZXF1UGFyYSkuZW1wdHkoXCJcIik7XHJcblxyXG4gICAgICAgIGthdGV4LnJlbmRlcih5LCB5UGFyYVswXSk7XHJcbiAgICAgICAga2F0ZXgucmVuZGVyKGVxdWF0LCBlcXVQYXJhKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxyXG4gICAgICAgIHJ1biA9IHRydWU7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgaW5wdXRzW2ldLm9uaW5wdXQgPSBmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHhJbnB1dFZhbCA9IGUuc3JjRWxlbWVudC52YWx1ZTtcclxuICAgICAgICAgICAgaWYgKHByb2ZPcHQudmlldy54Lm1pbiA8PSB4SW5wdXRWYWwgJiYgeElucHV0VmFsIDw9IHByb2ZPcHQudmlldy54Lm1heCkge1xyXG4gICAgICAgICAgICAgICAgcnVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIilcclxuICAgICAgICAgICAgICAgICAgICAucHJvcChcImRpc2FibGVkXCIsIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImN1cnNvclwiOiBcInBvaW50ZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzdGF0dXMgcFwiKS5odG1sKGBgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJChcImlucHV0W3R5cGU9J2J1dHRvbiddW3ZhbHVlPSdHbyEnXVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJzb3JcIjogXCJub3QtYWxsb3dlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3N0YXR1cyBwXCIpLmh0bWwoYCR7eElucHV0VmFsfSB4LXZhbHVlIG91dCBvZiBkb21haW5zLmApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBPbmNoYW5nZSBldmVudCBoYW5kbGVyIGZvciB0aGUgc2VsZWN0IGh0bWwgZWxlbWVudC5cclxuICAgICovXHJcbiAgICAkKFwic2VsZWN0XCIpLmNoYW5nZShmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGNoYW5nZVBsb3QoZS50YXJnZXQudmFsdWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLypcclxuICAgIERPQ1VNRU5UIGtleWRvd24gZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoZG9jdW1lbnQpLmtleXByZXNzKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT0gMTMgJiYgcnVuKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgR08hIENsaWNrIGV2ZW50IGhhbmRsZXJcclxuICAgICovXHJcbiAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzdGFydEZ1bmNNYWNoKCk7XHJcbiAgICB9KTtcclxuIiwidmFyIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLFxyXG4gICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICBhbmlEdXJhdGlvbiA9IDI7XHJcblxyXG5mdW5jdGlvbiBydW5BbmltYXRpb24obmFtZSwgdmFsdWUpIHtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gYW5pbWF0aW9uKGFuaVNldHRpbmdzKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgdmFyIGRhdGFwb2ludCA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICAgICAgbnVtUGFyYSA9IGRhdGFwb2ludC5lbGVtZW50O1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgIE1ha2UgdGhlIHByb21pc2UgdGhhdCB3aGVuIHRoZSBkeW5hbWljXHJcbiAgICAgICAgYW5pbWF0aW9uIHBhdGggaXMgZG9uZSB0aGVuIHRoaXMgcHJvbWlzZSBpcyBmaW5pc2hlZFxyXG4gICAgICAgICovXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICQobnVtUGFyYSlcclxuICAgICAgICAgICAgICAgIC5odG1sKHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhbmltYXRpb25cIjogYCR7bmFtZX0ke2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZH0gJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YCxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAub25lKCdhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RhdHVzTWVzc2FnZShtZXNzYWdlKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXHJcbiAgICBuZWNlc3NhcnkgZGF0YSBhbmQgdGhlbiByZXR1cm4gdGhlIGZ1bmN0aW9uIHByb21pc2VcclxuICAgICovXHJcbiAgICB2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICBzdGF0dXNCYXIuaHRtbChtZXNzYWdlKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVwbGFjZVhFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBSZXBsYWNlIHRoZSB4IGluIHRoZSBkaXNhcHBlYXJlZCBlcXVhdGlvbiB3aXRob3V0IGhhdmluZyB0aGUgeSBkaXNhcHBlYXIuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXZhbHVhdGVFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIHkgYW5zd2VyIGFuZCB0aGUgeC1jaGFuZ2VkIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICBjaGFuZ2VFcXUgPSBwb2ludERhdGEuY2hhbmdlRXF1O1xyXG5cclxuICAgIC8qXHJcbiAgICBTaG93IHRoZSBuZXcgZXF1YXRpb24gd2l0aCB0aGUgcmVwbGFjZWQgeC12YWx1ZSBlcXVhdGlvblxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGthdGV4LnJlbmRlcihgJHtjaGFuZ2VFcXV9YCwgZXF1UGFyYSk7XHJcblxyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93WUFucyhhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEFuaW1hdGUgdGhlIG5ldyB5IHZhbHVlIHRvIHRoZSBjb29yZGluYXRlZCB5IGNvbHVtbiBhbmQgb25jZVxyXG4gICAgYW5pbWF0aW9uIGlzIGRvbmUgdGhlbiByZXR1cm4gdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dERpc2FwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwb2ludERhdGEueX1gLCBlcXVQYXJhKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXF1YXRpb25BZ2FpbihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwbGFjZVlWYWx1ZShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSB5LXZhbHVlIGFwcGVhcnMgaW4gdGhlIGNvcnJlY3QgeS1jb2x1bW4gdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlLlxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIHZhciBpbnB1dCA9ICQoYHRkI3l2YWwke3BvaW50RGF0YS5pZCArIDF9YClbMF07XHJcbiAgICAgICAgJChpbnB1dCkuaHRtbChcIlwiKTtcclxuICAgICAgICAkKGlucHV0KS5hcHBlbmQoYDxwPiR7cG9pbnREYXRhLnl9PC9wPmApO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0Um91bmQoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBHZXQgdGhlIGN1cnJlbnQgcm91bmQgYW5kIGN1cnJlbnQgZGF0YSBwb2ludHNcclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBPbmNlIHRoZSBlcXVhdGlvbiBpcyBjbGVhcmVkIGFuZCByZXNldCB0byB0aGUgZGVmYXVsdCBlcXVhdGlvblxyXG4gICAgdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIGthdGV4LnJlbmRlcihgJHtwcm9mT3B0LmVxdWF0aW9ufWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dEZWZhdWx0RXF1KGFuaVNldHRpbmdzKSB7XHJcbiAgICAvKlxyXG4gICAgUmV0dXJuIHRvIGRlZmF1bHQgYmVnaW5uaW5nIGVxdWF0aW9uIGZvciB0aGUgbmV4dCBhbmltYXRpb24gb3IgZm9yIHRoZSBlbmRcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbkFjY2VwdCB0aGUgZGF0YXBvaW50IGFuZCBpdHMgaXRlcmF0b3IgYW5kIHBsb3QgdGhhdCBwb2ludCBiZWluZyBwYXNzZWQgdGhyb3VnaFxyXG4qL1xyXG5mdW5jdGlvbiBwbG90dGVyKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgYW5pU2V0dGluZ3MuZ3JhcGhPcHQuY2FsbGJhY2soKTtcclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIHBsYWNlaG9sZGVyID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xyXG5cclxuICAgIC8qXHJcbiAgICBUaGlzIGZ1bmN0aW9uIGFjdHMgYXMgYW4gaXRlcmF0b3Igc28gdGhhdCB0aGUgcHJvbWlzZSBjaGFpbiBrbm93cyB3aGljaFxyXG4gICAgZGF0YXBvaW50IHRvIGhhbmRsZSBhbmQgdG8gYW5pbWF0ZVxyXG4gICAgKi9cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5jdXJyZW50Um91bmQgKz0gMTtcclxuICAgICAgICBwbGFjZWhvbGRlci51cGRhdGVQb2ludCA9IGZhbHNlO1xyXG5cclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gYW5pbWF0ZUdpZihhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChcIiNmdW5jdGlvbk1hY2hpbmVcIikuY3NzKHtcclxuICAgICAgICAgICAgXCJiYWNrZ3JvdW5kLWltYWdlXCI6IFwidXJsKC4vZnVuY3Rpb25NYWNoaW5lQW5pLmdpZilcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncylcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wQW5pR2lmKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKFwiI2Z1bmN0aW9uTWFjaGluZVwiKS5jc3Moe1xyXG4gICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoLi9mdW5jdGlvbk1hY2hpbmVTdGlsbC5naWYpXCJcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpXHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWluaUFuaShhbmlTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcblxyXG4gICAgICAgIHZhciBwbGFjZWhvbGRlciA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcclxuICAgICAgICAgICAgeXZhbHVlID0gcGxhY2Vob2xkZXIueSxcclxuICAgICAgICAgICAgcGFyYSA9ICQoYDxwPiR7eXZhbHVlfTwvcD5gKTtcclxuXHJcbiAgICAgICAgJChcImJvZHlcIikuYXBwZW5kKHBhcmEpO1xyXG5cclxuICAgICAgICBwYXJhXHJcbiAgICAgICAgICAgIC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcclxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiA1NTAsXHJcbiAgICAgICAgICAgICAgICB0b3A6IDUwXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hbmltYXRlKHtcclxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgICB0b3A6IDEwMFxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgcGFyYS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwibm9uZVwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pIHtcclxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xyXG4gICAgICAgIGlmIChkYXRhcG9pbnQudXBkYXRlUG9pbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieFRvTWFjaGluZVwiLCBkYXRhcG9pbnQueCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihhbmltYXRlR2lmKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShcIkNhbGN1bGF0aW5nXCIpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVwbGFjZVhFcXUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RXZhbHVhdGVFcXUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93WUFucylcclxuICAgICAgICAgICAgICAgIC50aGVuKHNob3dFcXVhdGlvbkFnYWluKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RvcEFuaUdpZilcclxuICAgICAgICAgICAgICAgIC50aGVuKG1pbmlBbmkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJtYWNoaW5lVG9ZXCIsIGRhdGFwb2ludC55KSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieVRvU3RhdHVzQmFyXCIsIGAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBQbG90dGluZyAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzZXRSb3VuZClcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoYGApKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0RlZmF1bHRFcXUpO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKSB7XHJcbiAgICBkcHMuZGF0YXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhcG9pbnQpIHtcclxuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoYWluID0gY2hhaW5cclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxvdHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoYWluID0gY2hhaW4udGhlbih1cGRhdGVSb3VuZCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuSGFuZGxlIGFsbCBDU1MgYW5pbWF0aW9ucyBieSBjcmVhdGluZyBhIFByb21pc2UgY2hhaW4gdGhyb3VnaCBhIGZvciBsb29wLlxyXG4qL1xyXG5mdW5jdGlvbiBhbmltYXRvckNvbnRyb2woZHBzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgbnVtQ29udGFpbmVyID0gJChcIiNudW1Db250YWluZXJcIiksXHJcbiAgICAgICAgY2hhaW4gPSBQcm9taXNlLnJlc29sdmUoZHBzKTtcclxuXHJcbiAgICBudW1Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuXHJcbiAgICBpZiAoZHBzLmdyYXBoT3B0LmFuaW1hdGVIaWRlKSB7XHJcbiAgICAgICAgbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
