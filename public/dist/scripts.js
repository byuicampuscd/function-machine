"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;e<=n;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var o=$("<option></option>").append(n.name);$(o).val(n.equation),$("select").append(o)}var o=location.search.substring(1),t=o.split("=")[1]+".json";$.getJSON(t,function(o){window.professorConfigFile=o,$.each(o,function(o,t){n(t),0===o&&changePlot(t.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:55,startLeftOff:300,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,o={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},a={datapoints:[],currentRound:0,graphOpt:o};t.each(function(t){var n,e=$(this).val();if(e&&(n=+e,profOpt.view.x.min<=n&&n<=profOpt.view.x.max)){var i=o.equation.replace("x","("+n+")"),p=math.eval(i),r=(this.getBoundingClientRect(),{x:n,y:p,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});r.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,a.datapoints.push(r)}}),animatorControl(a)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,o){o.equation===t&&(n=o)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){xMemory=[],clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,o=$("#functionMachine #equ")[0],a=$("#functionMachine #y");$(o).empty(""),katex.render(n,a[0]),katex.render(e,o)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;i<inputCount;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}for(var inputs=document.querySelectorAll("input[type='number']"),run=!0,i=0;i<inputs.length;i++)inputs[i].oninput=function(t){var n=t.srcElement.value;profOpt.view.x.min<=n&&n<=profOpt.view.x.max?(run=!0,$("input[type='button'][value='Go!']").prop("disabled",!1).css({cursor:"pointer"}),console.log("Validated!")):(run=!1,$("input[type='button'][value='Go!']").prop("disabled",!0).css({cursor:"not-allowed"}),$("#status p").html("<p>"+n+" x-value out of domains.</p>"),console.log("Not Validated!"))};$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&run&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(e){var a=e.datapoints[e.currentRound],i=a.element;return new Promise(function(a){$(i).html(t).css({animation:""+n+e.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){a(e)})})}}function statusMessage(n){return function(t){return new Promise(function(e){statusBar.html("<p>"+n+"</p>"),e(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],e=t.changeEqu;return new Promise(function(t){katex.render(""+e,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),e(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){var a=$("td#yval"+(t.id+1))[0];$(a).html(""),$(a).append("<p>"+t.y+"</p>"),e(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(e){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(e){n.currentRound+=1,t.updatePoint=!1,e(n)})}function animateGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../functionMachineAni.gif)"}),t(n)})}function stopAniGif(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../functionMachineStill.gif)"}),t(n)})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(animateGif).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(stopAniGif).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),e=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,e):aniPromiseChain(n,e)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwicXVlcnlTdHJpbmciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5Iiwic3BsaXQiLCJnZXRKU09OIiwicmVzdWx0Iiwid2luZG93IiwicHJvZmVzc29yQ29uZmlnRmlsZSIsImVhY2giLCJpIiwiY2hhbmdlUGxvdCIsInN0YWlyU3RlcCIsIm9wdGlvbnMiLCJoaWdod2F5UGF0aCIsImxhc3RTaGVldCIsImluc2VydFJ1bGUiLCJzdGFydFRvcE9mZiIsInN0YXJ0TGVmdE9mZiIsImVuZFRvcE9mZiIsImVuZExlZnRPZmYiLCJjc3NSdWxlcyIsImxlbmd0aCIsIm1ha2VYVG9NYWNoaW5lIiwiaW5wdXRDb3JkcyIsImluZGV4IiwidG9wIiwibGVmdCIsIm1ha2VNYWNoaW5lVG9ZIiwicmlnaHQiLCJtYWtlWVRvU3RhdHVzQmFyIiwic3RhcnRGdW5jTWFjaCIsInhpbnB1dHMiLCJoaWRlQW5pbWF0aW9uQ2hlY2tlZCIsImhpZGVHcmFwaENoZWNrZWQiLCJncmFwaE9wdCIsImNhbGxiYWNrIiwiYW5pU2V0dGluZ3MiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvbnNvbGUiLCJsb2ciLCJhbmltYXRlSGlkZSIsImdyYXBoSGlkZSIsInByb2ZPcHQiLCJ2aWV3IiwiZGF0YXBvaW50cyIsImN1cnJlbnRSb3VuZCIsInh2YWwiLCJ4dmFsdWUiLCJ0aGlzIiwieCIsIm1pbiIsIm1heCIsInJlcGxhY2VYIiwicmVwbGFjZSIsInl2YWwiLCJtYXRoIiwiZXZhbCIsInBvaW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieSIsImlkIiwiY2hhbmdlRXF1IiwidXBkYXRlUG9pbnQiLCJ4TWVtb3J5IiwiZWxlbWVudCIsImdldCIsImh0bWwiLCJwdXNoIiwiYW5pbWF0b3JDb250cm9sIiwiY2hlY2tDb25maWciLCJpdGVtIiwiY2xlYXJWYWx1ZXMiLCJ5aW5wdXRzIiwidmFsdWUiLCJpbm5lckhUTUwiLCJlcXVhdCIsImVxdVBhcmEiLCJ5UGFyYSIsImVtcHR5Iiwia2F0ZXgiLCJyZW5kZXIiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRDb3VudCIsInN0eWxlU2hlZXRzIiwiaW5wdXRDb29yIiwicnVuIiwib25pbnB1dCIsImUiLCJ4SW5wdXRWYWwiLCJzcmNFbGVtZW50IiwicHJvcCIsImNzcyIsImN1cnNvciIsImNoYW5nZSIsInRhcmdldCIsImtleXByZXNzIiwid2hpY2giLCJjbGljayIsInJ1bkFuaW1hdGlvbiIsImRhdGFwb2ludCIsIm51bVBhcmEiLCJhbmltYXRpb24iLCJhbmlEdXJhdGlvbiIsIm9uZSIsInN0YXR1c01lc3NhZ2UiLCJtZXNzYWdlIiwic3RhdHVzQmFyIiwicmVwbGFjZVhFcXUiLCJkYXRhIiwic2hvd0V2YWx1YXRlRXF1IiwicG9pbnREYXRhIiwic2hvd1lBbnMiLCJzaG93RXF1YXRpb25BZ2FpbiIsInBsYWNlWVZhbHVlIiwicmVzZXRSb3VuZCIsInNob3dEZWZhdWx0RXF1IiwicGxvdHRlciIsInVwZGF0ZVJvdW5kIiwicGxhY2Vob2xkZXIiLCJhbmltYXRlR2lmIiwiYmFja2dyb3VuZC1pbWFnZSIsInN0b3BBbmlHaWYiLCJhbmlQcm9taXNlQ2hhaW4iLCJkcHMiLCJjaGFpbiIsImZvckVhY2giLCJ0aGVuIiwibm9BbmlQcm9taXNlQ2hhaW4iLCJudW1Db250YWluZXIiXSwibWFwcGluZ3MiOiJBQUFBLGNBQUMsV0FhRyxJQUFLLEdBTkRBLEdBQ0FDLEVBQ0FDLEVBQ0FDLEVBSkFDLEVBQVFDLEVBQUUsU0FLVkMsRUFBVyxHQUVOQyxF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RSxLQUFLYixhQUNMYSxLQUFLVixVQUVkUSxFQUFRQSxFQUFNRSxLQUFLVCxlQU8zQixRQUFTbEQsaUJBQWdCd0QsR0FHckIsR0FBSUssR0FBZWpKLEVBQUUsaUJBQ2pCNkksRUFBUXpGLFFBQVFDLFFBQVF1RixFQUU1QkssR0FBYXZELFVBQVksR0FFckJrRCxFQUFJM0YsU0FBU08sWUFDYndGLGtCQUFrQkosRUFBS0MsR0FFdkJGLGdCQUFnQkMsRUFBS0MsR0FsUjdCLEdBQUlsQixXQUFZM0gsRUFBRSxhQUNkNkIsVUFBWXhCLFNBQVMrRixZQUFZL0YsU0FBUytGLFlBQVloRSxPQUFTLEdBQy9Ed0QsUUFBVTVGLEVBQUUseUJBQXlCLEdBQ3JDdUgsWUFBYyIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBNYWtlIHRoZSB3aG9sZSB0YWJsZSBhbmQgY2VsbHMgZm9yIHRoZSBpbnB1dCBib3hlcyBhbmQgdXNlciBpbnRlcmFjdGlvbi5cclxuICAgICovXHJcbiAgICB2YXIgdGJvZHkgPSAkKFwidGJvZHlcIiksXHJcbiAgICAgICAgdGQxLFxyXG4gICAgICAgIHRkMixcclxuICAgICAgICB0cixcclxuICAgICAgICBpbnB1dCxcclxuICAgICAgICByb3dDb3VudCA9IDE5O1xyXG5cclxuICAgIGZvciAodmFyIGogPSAxOyBqIDw9IHJvd0NvdW50OyBqKyspIHtcclxuICAgICAgICBpbnB1dCA9ICQoXCI8aW5wdXQ+XCIpO1xyXG4gICAgICAgIHRkMSA9ICQoXCI8dGQ+PC90ZD5cIik7XHJcbiAgICAgICAgdGQyID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ciA9ICQoXCI8dHI+PC90cj5cIik7XHJcblxyXG4gICAgICAgICQodHIpLmF0dHIoXCJpZFwiLCBgcm93JHtqfWApO1xyXG5cclxuICAgICAgICAkKGlucHV0KS5hdHRyKFwibmFtZVwiLCBgaW5wdXQke2p9YCkuYXR0cihcInR5cGVcIiwgXCJudW1iZXJcIik7XHJcblxyXG4gICAgICAgICQodGQyKS5hdHRyKFwiaWRcIiwgYHl2YWwke2p9YCk7XHJcblxyXG4gICAgICAgICQodGQxKS5hcHBlbmQoaW5wdXQpO1xyXG4gICAgICAgICQodHIpLmFwcGVuZCh0ZDEpLmFwcGVuZCh0ZDIpO1xyXG4gICAgICAgICQodGJvZHkpLmFwcGVuZCh0cik7XHJcbiAgICB9XHJcbn0oKSk7XHJcbiIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAvKlxyXG4gICAgTG9hZCBRdWVyeSBzdWJzdHJpbmdcclxuICAgICovXHJcbiAgICB2YXIgcXVlcnlTdHJpbmcgPSBsb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLFxyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnlTdHJpbmcuc3BsaXQoXCI9XCIpWzFdICsgXCIuanNvblwiO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNob3dQcm9mT3B0aW9ucyhmaWVsZCkge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgQXBwZW5kIHRoZSBwcm9mZXNzb3IncyBjaG9zZW4gZXF1YXRpb25zIHRvIHRoZSBhcHBsaWNhdGlvblxyXG4gICAgICAgICovXHJcblxyXG4gICAgICAgIHZhciBvcHQgPSAkKFwiPG9wdGlvbj48L29wdGlvbj5cIikuYXBwZW5kKGZpZWxkLm5hbWUpO1xyXG5cclxuICAgICAgICAkKG9wdCkudmFsKGZpZWxkLmVxdWF0aW9uKTtcclxuXHJcbiAgICAgICAgJChcInNlbGVjdFwiKS5hcHBlbmQob3B0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgTG9hZCB0aGUgcHJvZmVzc29yIGNvbmZpZ3VyYXRpb24gZmlsZVxyXG4gICAgKi9cclxuXHJcbiAgICAkLmdldEpTT04ocXVlcnksIGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuXHJcbiAgICAgICAgd2luZG93LnByb2Zlc3NvckNvbmZpZ0ZpbGUgPSByZXN1bHQ7XHJcblxyXG4gICAgICAgICQuZWFjaChyZXN1bHQsIGZ1bmN0aW9uIChpLCBmaWVsZCkge1xyXG5cclxuICAgICAgICAgICAgc2hvd1Byb2ZPcHRpb25zKGZpZWxkKTtcclxuXHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIERpc3BsYXkgdGhlIGRlZmF1bHQgZXF1YXRpb24gdG8gdGhlIGZ1bmN0aW9uIG1hY2hpbmVcclxuICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIGlmIChpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VQbG90KGZpZWxkLmVxdWF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG4iLCIgICAgdmFyIHhNZW1vcnkgPSBbXSxcclxuICAgICAgICBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgaW5wdXRDb3VudCA9IGlucHV0cy5sZW5ndGgsXHJcbiAgICAgICAgbGFzdFNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoIC0gMV07XHJcblxyXG4gICAgLypcclxuICAgIEFuaW1hdGlvbiBwYXRoIGZvciB0aGUgc3RhaXJzdGVwXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3RhaXJTdGVwKG9wdGlvbnMpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICB2YXIgaGlnaHdheVBhdGggPSAyNDYuNTtcclxuICAgICAgICBsYXN0U2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke29wdGlvbnMubmFtZX0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuc3RhcnRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtvcHRpb25zLnN0YXJ0TGVmdE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDMzJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuc3RhcnRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtoaWdod2F5UGF0aH1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDY2JSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuZW5kVG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7aGlnaHdheVBhdGh9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA5MCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMDAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLmVuZFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke29wdGlvbnMuZW5kTGVmdE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfWAsIGxhc3RTaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBBIHNldCBvZiBmdW5jdGlvbnMgdXNpbmcgdGhlIHN0YWlyc3RlcCBhbmltYXRpb24gdGVtcGxhdGVcclxuICAgIHRvIGNyZWF0ZSBwYXRod2F5cyB3aXRoIGNvb3JkaW5hdGUgZGF0YVxyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgc3RhcnRMZWZ0T2ZmOiBpbnB1dENvcmRzLmxlZnQgKyAzMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiA1NSxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBuYW1lOiBgeFRvTWFjaGluZSR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29yZHMsIGluZGV4KSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgc3RhaXJTdGVwKHtcclxuICAgICAgICAgICAgc3RhcnRUb3BPZmY6IDU1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IDMwMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXHJcbiAgICAgICAgICAgIGVuZExlZnRPZmY6IGlucHV0Q29yZHMucmlnaHQgKyA1LFxyXG4gICAgICAgICAgICBuYW1lOiBgbWFjaGluZVRvWSR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMucmlnaHQgKyAxMCxcclxuICAgICAgICAgICAgZW5kVG9wT2ZmOiAxNTAsXHJcbiAgICAgICAgICAgIGVuZExlZnRPZmY6IDMwMCxcclxuICAgICAgICAgICAgbmFtZTogYHlUb1N0YXR1c0JhciR7aW5kZXh9YFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBTZXQgdXAgdGhlIHhNZW1vcnkgYXJyYXkgYW5kIHRoZSBhbmltYXRpb24gcGF0aHMgZm9yIGVhY2ggaW5wdXQgYm94LlxyXG5cclxuICAgIE5PVEU6IFNldHRpbmcgdXAgdGhlIHhNZW1vcnkgYXJyYXkgYWxzbyBtYWtlcyBpdCBzbyB0aGF0IG5vIGFuaW1hdGlvbnNcclxuICAgICAgICAgIGFyZSByZXBlYXRlZCBieSBtdWx0aXBsZSBjbGlja3Mgb24gdGhlIFwiR28hXCIgYnV0dG9uLlxyXG4gICAgKi9cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgeE1lbW9yeVtpXSA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBpbnB1dENvb3IgPSBpbnB1dHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29vciwgaSk7XHJcbiAgICAgICAgbWFrZU1hY2hpbmVUb1koaW5wdXRDb29yLCBpKTtcclxuICAgICAgICBtYWtlWVRvU3RhdHVzQmFyKGlucHV0Q29vciwgaSk7XHJcbiAgICAgICAgJChcIiNudW1Db250YWluZXJcIikuYXBwZW5kKCQoYDxwPjwvcD5gKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIFNldCBhbGwgdGhlIGRhdGEgdG8gYW4gYXJyYXkgb2Ygb2JqZWN0cyB0byBiZSBpdGVyYXRlZFxyXG4gICAgb3ZlciBieSB0aGUgcHJvbWlzZSBjaGFpbiBpbiBhbmltYXRvcmNvbnRyb2wuanNcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdGFydEZ1bmNNYWNoKCkge1xyXG5cclxuICAgICAgICB2YXIgeGlucHV0cyA9ICQoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICAgICAgaGlkZUFuaW1hdGlvbkNoZWNrZWQgPSAkKFwiI2FuaW1hdGU6Y2hlY2tlZFwiKS5sZW5ndGggPiAwLFxyXG4gICAgICAgICAgICBoaWRlR3JhcGhDaGVja2VkID0gJChcIiNzaG93R3JhcGg6Y2hlY2tlZFwiKS5sZW5ndGggPiAwLFxyXG4gICAgICAgICAgICBncmFwaE9wdCA9IHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaW5pc2hlZCBwbG90dGluZyBkYXRhcG9pbnQhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBhbmltYXRlSGlkZTogaGlkZUFuaW1hdGlvbkNoZWNrZWQsXHJcbiAgICAgICAgICAgICAgICBncmFwaEhpZGU6IGhpZGVHcmFwaENoZWNrZWQsXHJcbiAgICAgICAgICAgICAgICBlcXVhdGlvbjogcHJvZk9wdC5lcXVhdGlvbixcclxuICAgICAgICAgICAgICAgIHZpZXc6IHByb2ZPcHQudmlld1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhbmlTZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgICAgIGRhdGFwb2ludHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFJvdW5kOiAwLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhPcHQ6IGdyYXBoT3B0XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIHhpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICB2YXIgeHZhbHVlID0gJCh0aGlzKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHh2YWw7XHJcblxyXG4gICAgICAgICAgICBpZiAoeHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB4dmFsID0gK3h2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9mT3B0LnZpZXcueC5taW4gPD0geHZhbCAmJiB4dmFsIDw9IHByb2ZPcHQudmlldy54Lm1heCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZVggPSBncmFwaE9wdC5lcXVhdGlvbi5yZXBsYWNlKFwieFwiLCBgKCR7eHZhbH0pYCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHl2YWwgPSBtYXRoLmV2YWwocmVwbGFjZVgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dENvb3IgPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHh2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB5dmFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VFcXU6IHByb2ZPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3h2YWx9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUG9pbnQ6IHhNZW1vcnlbaV0gIT09IHh2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiAkKFwiI251bUNvbnRhaW5lciBwXCIpLmdldChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyIG91dCB0aGUgWXMgd2hlbiB0aGV5IGRvbid0IGVxdWFsIGVhY2ggb3RoZXIgYW5kIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50LnVwZGF0ZVBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYHRkI3l2YWwke2kgKyAxfWApLmh0bWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKlVwZGF0ZSB0aGUgeG1lbW9yeSovXHJcbiAgICAgICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHh2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGFuaVNldHRpbmdzLmRhdGFwb2ludHMucHVzaChwb2ludCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9GdW5jdGlvbiB0byBzZWxlY3QgdGhlIGNob3NlbiBlcXVhdGlvbiB3aXRoIGl0cyBuYW1lIGFuZCBncmFwaCB3aW5kb3cgYm91bmRhcmllcy5cclxuICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmlnKHZhbCkge1xyXG4gICAgICAgIHZhciBwcm9mT3B0O1xyXG4gICAgICAgICQuZWFjaChwcm9mZXNzb3JDb25maWdGaWxlLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5lcXVhdGlvbiA9PT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9mT3B0ID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHByb2ZPcHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xlYXJWYWx1ZXMoKSB7XHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgICAgIHlpbnB1dHMgPSAkKGB0ciB0ZDpudGgtb2YtdHlwZSgyKWApO1xyXG5cclxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9EaXBzbGF5IEthdGV4IGVxdWF0aW9uXHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xyXG5cclxuICAgICAgICB4TWVtb3J5ID0gW107XHJcblxyXG4gICAgICAgIGNsZWFyVmFsdWVzKCk7XHJcblxyXG4gICAgICAgIHdpbmRvdy5wcm9mT3B0ID0gY2hlY2tDb25maWcodmFsKTtcclxuXHJcbiAgICAgICAgdmFyIHkgPSBgeSA9IGAsXHJcbiAgICAgICAgICAgIGVxdWF0ID0gYCR7dmFsfWAsXHJcbiAgICAgICAgICAgIGVxdVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjZXF1XCIpWzBdLFxyXG4gICAgICAgICAgICB5UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICN5XCIpO1xyXG5cclxuICAgICAgICAkKGVxdVBhcmEpLmVtcHR5KFwiXCIpO1xyXG5cclxuICAgICAgICBrYXRleC5yZW5kZXIoeSwgeVBhcmFbMF0pO1xyXG4gICAgICAgIGthdGV4LnJlbmRlcihlcXVhdCwgZXF1UGFyYSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICBydW4gPSB0cnVlO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRzLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgIGlucHV0c1tpXS5vbmlucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB4SW5wdXRWYWwgPSBlLnNyY0VsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChwcm9mT3B0LnZpZXcueC5taW4gPD0geElucHV0VmFsICYmIHhJbnB1dFZhbCA8PSBwcm9mT3B0LnZpZXcueC5tYXgpIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnByb3AoXCJkaXNhYmxlZFwiLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJzb3JcIjogXCJwb2ludGVyXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmFsaWRhdGVkIVwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJChcImlucHV0W3R5cGU9J2J1dHRvbiddW3ZhbHVlPSdHbyEnXVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJzb3JcIjogXCJub3QtYWxsb3dlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3N0YXR1cyBwXCIpLmh0bWwoYDxwPiR7eElucHV0VmFsfSB4LXZhbHVlIG91dCBvZiBkb21haW5zLjwvcD5gKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90IFZhbGlkYXRlZCFcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIE9uY2hhbmdlIGV2ZW50IGhhbmRsZXIgZm9yIHRoZSBzZWxlY3QgaHRtbCBlbGVtZW50LlxyXG4gICAgKi9cclxuICAgICQoXCJzZWxlY3RcIikuY2hhbmdlKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgY2hhbmdlUGxvdChlLnRhcmdldC52YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgRE9DVU1FTlQga2V5ZG93biBldmVudCBoYW5kbGVyXHJcbiAgICAqL1xyXG4gICAgJChkb2N1bWVudCkua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PSAxMyAmJiBydW4pIHtcclxuICAgICAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBHTyEgQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgIH0pO1xyXG4iLCJ2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKSxcclxuICAgIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLFxyXG4gICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICBhbmlEdXJhdGlvbiA9IDE7XHJcblxyXG4vL1RPRE86IEdldCB0aGUgZnVuY3Rpb24gbWFjaGluZSBpbiB0aGVyZS5cclxuLy9UT0RPOiBDaGVjayBicm93c2VyIGNvbXBhdGliaWxpdHkgKFByb21pc2VzIGluIElFKS5cclxuXHJcbmZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiBhbmltYXRpb24oYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICB2YXIgZGF0YXBvaW50ID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgICAgICBudW1QYXJhID0gZGF0YXBvaW50LmVsZW1lbnQ7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgTWFrZSB0aGUgcHJvbWlzZSB0aGF0IHdoZW4gdGhlIGR5bmFtaWNcclxuICAgICAgICBhbmltYXRpb24gcGF0aCBpcyBkb25lIHRoZW4gdGhpcyBwcm9taXNlIGlzIGZpbmlzaGVkXHJcbiAgICAgICAgKi9cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgJChudW1QYXJhKVxyXG4gICAgICAgICAgICAgICAgLmh0bWwodmFsdWUpXHJcbiAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBcImFuaW1hdGlvblwiOiBgJHtuYW1lfSR7YW5pU2V0dGluZ3MuY3VycmVudFJvdW5kfSAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vbmUoJ2FuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdGF0dXNNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgc3RhdHVzQmFyLmh0bWwoYDxwPiR7bWVzc2FnZX08L3A+YCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlcGxhY2VYRXF1KGRhdGEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBSZXBsYWNlIHRoZSB4IGluIHRoZSBkaXNhcHBlYXJlZCBlcXVhdGlvbiB3aXRob3V0IGhhdmluZyB0aGUgeSBkaXNhcHBlYXIuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFdmFsdWF0ZUVxdShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgeSBhbnN3ZXIgYW5kIHRoZSB4LWNoYW5nZWQgZXF1YXRpb25cclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgIGNoYW5nZUVxdSA9IHBvaW50RGF0YS5jaGFuZ2VFcXU7XHJcblxyXG4gICAgLypcclxuICAgIFNob3cgdGhlIG5ldyBlcXVhdGlvbiB3aXRoIHRoZSByZXBsYWNlZCB4LXZhbHVlIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAga2F0ZXgucmVuZGVyKGAke2NoYW5nZUVxdX1gLCBlcXVQYXJhKTtcclxuXHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dZQW5zKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0ZSB0aGUgbmV3IHkgdmFsdWUgdG8gdGhlIGNvb3JkaW5hdGVkIHkgY29sdW1uIGFuZCBvbmNlXHJcbiAgICBhbmltYXRpb24gaXMgZG9uZSB0aGVuIHJldHVybiB0aGUgcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3BvaW50RGF0YS55fWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFcXVhdGlvbkFnYWluKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYWNlWVZhbHVlKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIHktdmFsdWUgYXBwZWFycyBpbiB0aGUgY29ycmVjdCB5LWNvbHVtbiB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2UuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgdmFyIGlucHV0ID0gJChgdGQjeXZhbCR7cG9pbnREYXRhLmlkICsgMX1gKVswXTtcclxuICAgICAgICAkKGlucHV0KS5odG1sKFwiXCIpO1xyXG4gICAgICAgICQoaW5wdXQpLmFwcGVuZChgPHA+JHtwb2ludERhdGEueX08L3A+YCk7XHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVzZXRSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgY3VycmVudCByb3VuZCBhbmQgY3VycmVudCBkYXRhIHBvaW50c1xyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIGVxdWF0aW9uIGlzIGNsZWFyZWQgYW5kIHJlc2V0IHRvIHRoZSBkZWZhdWx0IGVxdWF0aW9uXHJcbiAgICB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3Byb2ZPcHQuZXF1YXRpb259YCwgZXF1UGFyYSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0RlZmF1bHRFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIC8qXHJcbiAgICBSZXR1cm4gdG8gZGVmYXVsdCBiZWdpbm5pbmcgZXF1YXRpb24gZm9yIHRoZSBuZXh0IGFuaW1hdGlvbiBvciBmb3IgdGhlIGVuZFxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuQWNjZXB0IHRoZSBkYXRhcG9pbnQgYW5kIGl0cyBpdGVyYXRvciBhbmQgcGxvdCB0aGF0IHBvaW50IGJlaW5nIHBhc3NlZCB0aHJvdWdoXHJcbiovXHJcbmZ1bmN0aW9uIHBsb3R0ZXIoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5ncmFwaE9wdC5jYWxsYmFjaygpO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVJvdW5kKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgcGxhY2Vob2xkZXIgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIFRoaXMgZnVuY3Rpb24gYWN0cyBhcyBhbiBpdGVyYXRvciBzbyB0aGF0IHRoZSBwcm9taXNlIGNoYWluIGtub3dzIHdoaWNoXHJcbiAgICBkYXRhcG9pbnQgdG8gaGFuZGxlIGFuZCB0byBhbmltYXRlXHJcbiAgICAqL1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGFuaVNldHRpbmdzLmN1cnJlbnRSb3VuZCArPSAxO1xyXG4gICAgICAgIHBsYWNlaG9sZGVyLnVwZGF0ZVBvaW50ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBhbmltYXRlR2lmKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKFwiI2Z1bmN0aW9uTWFjaGluZVwiKS5jc3Moe1xyXG4gICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoLi4vZnVuY3Rpb25NYWNoaW5lQW5pLmdpZilcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncylcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wQW5pR2lmKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKFwiI2Z1bmN0aW9uTWFjaGluZVwiKS5jc3Moe1xyXG4gICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoLi4vZnVuY3Rpb25NYWNoaW5lU3RpbGwuZ2lmKVwiXHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKSB7XHJcbiAgICBkcHMuZGF0YXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhcG9pbnQpIHtcclxuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoYWluID0gY2hhaW5cclxuICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcInhUb01hY2hpbmVcIiwgZGF0YXBvaW50LngpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oYW5pbWF0ZUdpZilcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoXCJDYWxjdWxhdGluZ1wiKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcGxhY2VYRXF1KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0V2YWx1YXRlRXF1KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd1lBbnMpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RXF1YXRpb25BZ2FpbilcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0b3BBbmlHaWYpXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJtYWNoaW5lVG9ZXCIsIGRhdGFwb2ludC55KSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieVRvU3RhdHVzQmFyXCIsIGAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBQbG90dGluZyAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzZXRSb3VuZClcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoYGApKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0RlZmF1bHRFcXUpO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKSB7XHJcbiAgICBkcHMuZGF0YXBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhcG9pbnQpIHtcclxuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoYWluID0gY2hhaW5cclxuICAgICAgICAgICAgICAgIC50aGVuKHBsYWNlWVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxvdHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoYWluID0gY2hhaW4udGhlbih1cGRhdGVSb3VuZCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuSGFuZGxlIGFsbCBDU1MgYW5pbWF0aW9ucyBieSBjcmVhdGluZyBhIFByb21pc2UgY2hhaW4gdGhyb3VnaCBhIGZvciBsb29wLlxyXG4qL1xyXG5mdW5jdGlvbiBhbmltYXRvckNvbnRyb2woZHBzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgbnVtQ29udGFpbmVyID0gJChcIiNudW1Db250YWluZXJcIiksXHJcbiAgICAgICAgY2hhaW4gPSBQcm9taXNlLnJlc29sdmUoZHBzKTtcclxuXHJcbiAgICBudW1Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuXHJcbiAgICBpZiAoZHBzLmdyYXBoT3B0LmFuaW1hdGVIaWRlKSB7XHJcbiAgICAgICAgbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH1cclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
