"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;n>=e;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var e=$("<option></option>").append(n.name);$(e).val(n.equation),$("select").append(e)}$.getJSON("../funcMachineSettings.json",function(e){window.professorConfigFile=e,$.each(e,function(e,o){n(o),0===e&&changePlot(o.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:55,startLeftOff:300,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,a={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},o={datapoints:[],currentRound:0,graphOpt:a};t.each(function(t){var n=+$(this).val();if(n){var e=a.equation.replace("x","("+n+")"),i=math.eval(e),f=(this.getBoundingClientRect(),{x:n,y:i,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});f.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,o.datapoints.push(f)}}),animatorControl(o)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,a){a.equation===t&&(n=a)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,a=$("#functionMachine #equ")[0],o=$("#functionMachine #y");$(a).empty(""),katex.render(n,o[0]),katex.render(e,a)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;inputCount>i;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(a){var e=a.datapoints[a.currentRound],i=e.element;return new Promise(function(e){$(i).html(t).css({animation:""+n+a.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){e(a)})})}}function statusMessage(n){return function(t){return new Promise(function(a){statusBar.html("<p>"+n+"</p>"),a(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],a=t.changeEqu;return new Promise(function(t){katex.render(""+a,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),a(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){var e=$("td#yval"+(t.id+1))[0];$(e).html(""),$(e).append("<p>"+t.y+"</p>"),a(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){n.currentRound+=1,t.updatePoint=!1,a(n)})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),a=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,a):aniPromiseChain(n,a)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwiZ2V0SlNPTiIsInJlc3VsdCIsIndpbmRvdyIsInByb2Zlc3NvckNvbmZpZ0ZpbGUiLCJlYWNoIiwiaSIsImNoYW5nZVBsb3QiLCJzdGFpclN0ZXAiLCJvcHRpb25zIiwiaGlnaHdheVBhdGgiLCJsYXN0U2hlZXQiLCJpbnNlcnRSdWxlIiwic3RhcnRUb3BPZmYiLCJzdGFydExlZnRPZmYiLCJlbmRUb3BPZmYiLCJlbmRMZWZ0T2ZmIiwiY3NzUnVsZXMiLCJsZW5ndGgiLCJtYWtlWFRvTWFjaGluZSIsImlucHV0Q29yZHMiLCJpbmRleCIsInRvcCIsImxlZnQiLCJtYWtlTWFjaGluZVRvWSIsInJpZ2h0IiwibWFrZVlUb1N0YXR1c0JhciIsInN0YXJ0RnVuY01hY2giLCJ4aW5wdXRzIiwiaGlkZUFuaW1hdGlvbkNoZWNrZWQiLCJoaWRlR3JhcGhDaGVja2VkIiwiZ3JhcGhPcHQiLCJjYWxsYmFjayIsImFuaVNldHRpbmdzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb25zb2xlIiwibG9nIiwiYW5pbWF0ZUhpZGUiLCJncmFwaEhpZGUiLCJwcm9mT3B0IiwidmlldyIsImRhdGFwb2ludHMiLCJjdXJyZW50Um91bmQiLCJ4dmFsIiwidGhpcyIsInJlcGxhY2VYIiwicmVwbGFjZSIsInl2YWwiLCJtYXRoIiwiZXZhbCIsInBvaW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsInkiLCJpZCIsImNoYW5nZUVxdSIsInVwZGF0ZVBvaW50IiwieE1lbW9yeSIsImVsZW1lbnQiLCJnZXQiLCJodG1sIiwicHVzaCIsImFuaW1hdG9yQ29udHJvbCIsImNoZWNrQ29uZmlnIiwiaXRlbSIsImNsZWFyVmFsdWVzIiwieWlucHV0cyIsInZhbHVlIiwiaW5uZXJIVE1MIiwiZXF1YXQiLCJlcXVQYXJhIiwieVBhcmEiLCJlbXB0eSIsImthdGV4IiwicmVuZGVyIiwiaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0Q291bnQiLCJzdHlsZVNoZWV0cyIsImlucHV0Q29vciIsImNoYW5nZSIsImUiLCJ0YXJnZXQiLCJrZXlwcmVzcyIsIndoaWNoIiwiY2xpY2siLCJydW5BbmltYXRpb24iLCJkYXRhcG9pbnQiLCJudW1QYXJhIiwiY3NzIiwiYW5pbWF0aW9uIiwiYW5pRHVyYXRpb24iLCJvbmUiLCJzdGF0dXNNZXNzYWdlIiwibWVzc2FnZSIsInN0YXR1c0JhciIsInJlcGxhY2VYRXF1IiwiZGF0YSIsInNob3dFdmFsdWF0ZUVxdSIsInBvaW50RGF0YSIsInNob3dZQW5zIiwic2hvd0VxdWF0aW9uQWdhaW4iLCJwbGFjZVlWYWx1ZSIsInJlc2V0Um91bmQiLCJzaG93RGVmYXVsdEVxdSIsInBsb3R0ZXIiLCJ1cGRhdGVSb3VuZCIsInBsYWNlaG9sZGVyIiwiYW5pUHJvbWlzZUNoYWluIiwiZHBzIiwiY2hhaW4iLCJmb3JFYWNoIiwidGhlbiIsIm5vQW5pUHJvbWlzZUNoYWluIiwibnVtQ29udGFpbmVyIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUFDLFdBYUcsSUFBSyxHQU5EQSxHQUNBQyxFQUNBQyxFQUNBQyxFQUpBQyxFQUFRQyxFQUFFLFNBS1ZDLEVBQVcsR0FFTkMsRUFBSSxFQUFRRCxHQUFMQyxFQUFlQSxJQUMzQkosRUFBUUUsRUFBRSxXQUNWTCxFQUFNSyxFQUFFLGFBQ1JKLEVBQU1JLEVBQUUsYUFDUkgsRUFBS0csRUFBRSxhQUVQQSxFQUFFSCxHQUFJTSxLQUFLLEtBQVgsTUFBdUJELEdBRXZCRixFQUFFRixHQUFPSyxLQUFLLE9BQWQsUUFBOEJELEdBQUtDLEtBQUssT0FBUSxVQUVoREgs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QVFDLFFBQVEyRSxFQUU1QkssR0FBYTlDLFVBQVksR0FFckJ5QyxFQUFJL0UsU0FBU08sWUFDYjRFLGtCQUFrQkosRUFBS0MsR0FFdkJGLGdCQUFnQkMsRUFBS0MsR0E5UDdCLEdBQUlmLFdBQVk1RyxFQUFFLGFBQ2R1QixVQUFZbEIsU0FBU3NGLFlBQVl0RixTQUFTc0YsWUFBWTdELE9BQVMsR0FDL0RxRCxRQUFVbkYsRUFBRSx5QkFBeUIsR0FDckN3RyxZQUFjIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcbiAgICBNYWtlIHRoZSB3aG9sZSB0YWJsZSBhbmQgY2VsbHMgZm9yIHRoZSBpbnB1dCBib3hlcyBhbmQgdXNlciBpbnRlcmFjdGlvbi5cbiAgICAqL1xuICAgIHZhciB0Ym9keSA9ICQoXCJ0Ym9keVwiKSxcclxuICAgICAgICB0ZDEsXHJcbiAgICAgICAgdGQyLFxyXG4gICAgICAgIHRyLFxyXG4gICAgICAgIGlucHV0LFxyXG4gICAgICAgIHJvd0NvdW50ID0gMTk7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xyXG4gICAgICAgIGlucHV0ID0gJChcIjxpbnB1dD5cIik7XHJcbiAgICAgICAgdGQxID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRyID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHJcbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XHJcblxyXG4gICAgICAgICQoaW5wdXQpLmF0dHIoXCJuYW1lXCIsIGBpbnB1dCR7an1gKS5hdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcclxuXHJcbiAgICAgICAgJCh0ZDIpLmF0dHIoXCJpZFwiLCBgeXZhbCR7an1gKTtcclxuXHJcbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgJCh0cikuYXBwZW5kKHRkMSkuYXBwZW5kKHRkMik7XHJcbiAgICAgICAgJCh0Ym9keSkuYXBwZW5kKHRyKTtcclxuICAgIH1cclxufSgpKTtcclxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cbiAgICBmdW5jdGlvbiBzaG93UHJvZk9wdGlvbnMgKGZpZWxkKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgQXBwZW5kIHRoZSBwcm9mZXNzb3IncyBjaG9zZW4gZXF1YXRpb25zIHRvIHRoZSBhcHBsaWNhdGlvblxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIG9wdCA9ICQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hcHBlbmQoZmllbGQubmFtZSk7XG5cbiAgICAgICAgICAgICQob3B0KS52YWwoZmllbGQuZXF1YXRpb24pO1xuXG4gICAgICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xuICAgIH1cblxyXG4gICAgLypcclxuICAgIExvYWQgdGhlIHByb2Zlc3NvciBjb25maWd1cmF0aW9uIGZpbGVcclxuICAgICovXHJcblxyXG4gICAgJC5nZXRKU09OKFwiLi4vZnVuY01hY2hpbmVTZXR0aW5ncy5qc29uXCIsIGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuXHJcbiAgICAgICAgd2luZG93LnByb2Zlc3NvckNvbmZpZ0ZpbGUgPSByZXN1bHQ7XHJcblxyXG4gICAgICAgICQuZWFjaChyZXN1bHQsIGZ1bmN0aW9uIChpLCBmaWVsZCkge1xyXG5cbiAgICAgICAgICAgIHNob3dQcm9mT3B0aW9ucyhmaWVsZCk7XG5cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QoZmllbGQuZXF1YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxufSk7XHJcbiIsIiAgICB2YXIgeE1lbW9yeSA9IFtdLFxyXG4gICAgICAgIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICBpbnB1dENvdW50ID0gaW5wdXRzLmxlbmd0aCxcclxuICAgICAgICBsYXN0U2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXTtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0aW9uIHBhdGggZm9yIHRoZSBzdGFpcnN0ZXBcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdGFpclN0ZXAob3B0aW9ucykge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHZhciBoaWdod2F5UGF0aCA9IDI0Ni41O1xyXG4gICAgICAgIGxhc3RTaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7b3B0aW9ucy5uYW1lfSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke29wdGlvbnMuc3RhcnRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMzMlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNjYlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtoaWdod2F5UGF0aH1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDkwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuZW5kVG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5lbmRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9YCwgbGFzdFNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIEEgc2V0IG9mIGZ1bmN0aW9ucyB1c2luZyB0aGUgc3RhaXJzdGVwIGFuaW1hdGlvbiB0ZW1wbGF0ZVxyXG4gICAgdG8gY3JlYXRlIHBhdGh3YXlzIHdpdGggY29vcmRpbmF0ZSBkYXRhXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWFrZVhUb01hY2hpbmUoaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMubGVmdCArIDMwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDU1LFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIG5hbWU6IGB4VG9NYWNoaW5lJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZU1hY2hpbmVUb1koaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogNTUsXHJcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDUsXHJcbiAgICAgICAgICAgIG5hbWU6IGBtYWNoaW5lVG9ZJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZVlUb1N0YXR1c0JhcihpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHN0YWlyU3RlcCh7XHJcbiAgICAgICAgICAgIHN0YXJ0VG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXHJcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDEwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDE1MCxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBuYW1lOiBgeVRvU3RhdHVzQmFyJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIFNldCB1cCB0aGUgeE1lbW9yeSBhcnJheSBhbmQgdGhlIGFuaW1hdGlvbiBwYXRocyBmb3IgZWFjaCBpbnB1dCBib3guXHJcblxyXG4gICAgTk9URTogU2V0dGluZyB1cCB0aGUgeE1lbW9yeSBhcnJheSBhbHNvIG1ha2VzIGl0IHNvIHRoYXQgbm8gYW5pbWF0aW9uc1xyXG4gICAgICAgICAgYXJlIHJlcGVhdGVkIGJ5IG11bHRpcGxlIGNsaWNrcyBvbiB0aGUgXCJHbyFcIiBidXR0b24uXHJcbiAgICAqL1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dENvdW50OyBpKyspIHtcclxuICAgICAgICB4TWVtb3J5W2ldID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGlucHV0Q29vciA9IGlucHV0c1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgbWFrZVhUb01hY2hpbmUoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICBtYWtlTWFjaGluZVRvWShpbnB1dENvb3IsIGkpO1xyXG4gICAgICAgIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICAkKFwiI251bUNvbnRhaW5lclwiKS5hcHBlbmQoJChgPHA+PC9wPmApKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IGFsbCB0aGUgZGF0YSB0byBhbiBhcnJheSBvZiBvYmplY3RzIHRvIGJlIGl0ZXJhdGVkXHJcbiAgICBvdmVyIGJ5IHRoZSBwcm9taXNlIGNoYWluIGluIGFuaW1hdG9yY29udHJvbC5qc1xyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIHN0YXJ0RnVuY01hY2goKSB7XHJcblxyXG4gICAgICAgIHZhciB4aW5wdXRzID0gJChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxyXG4gICAgICAgICAgICBoaWRlQW5pbWF0aW9uQ2hlY2tlZCA9ICQoXCIjYW5pbWF0ZTpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGhpZGVHcmFwaENoZWNrZWQgPSAkKFwiI3Nob3dHcmFwaDpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGdyYXBoT3B0ID0ge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmlzaGVkIHBsb3R0aW5nIGRhdGFwb2ludCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGFuaW1hdGVIaWRlOiBoaWRlQW5pbWF0aW9uQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoSGlkZTogaGlkZUdyYXBoQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGVxdWF0aW9uOiBwcm9mT3B0LmVxdWF0aW9uLFxyXG4gICAgICAgICAgICAgICAgdmlldzogcHJvZk9wdC52aWV3XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFuaVNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YXBvaW50czogW10sXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Um91bmQ6IDAsXHJcbiAgICAgICAgICAgICAgICBncmFwaE9wdDogZ3JhcGhPcHRcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgeGlucHV0cy5lYWNoKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgIHZhciB4dmFsID0gKyQodGhpcykudmFsKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoeHZhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VYID0gZ3JhcGhPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3h2YWx9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgIHl2YWwgPSBtYXRoLmV2YWwocmVwbGFjZVgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0Q29vciA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHh2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHl2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VFcXU6IHByb2ZPcHQuZXF1YXRpb24ucmVwbGFjZShcInhcIiwgYCgke3h2YWx9KWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQb2ludDogeE1lbW9yeVtpXSAhPT0geHZhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogJChcIiNudW1Db250YWluZXIgcFwiKS5nZXQoaSlcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBDbGVhciBvdXQgdGhlIFlzIHdoZW4gdGhleSBkb24ndCBlcXVhbCBlYWNoIG90aGVyIGFuZCBuZWVkIHRvIGJlIHVwZGF0ZWRcclxuICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBpZiAocG9pbnQudXBkYXRlUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKGB0ZCN5dmFsJHtpICsgMX1gKS5odG1sKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qVXBkYXRlIHRoZSB4bWVtb3J5Ki9cclxuICAgICAgICAgICAgICAgIHhNZW1vcnlbaV0gPSB4dmFsO1xyXG5cclxuICAgICAgICAgICAgICAgIGFuaVNldHRpbmdzLmRhdGFwb2ludHMucHVzaChwb2ludCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9GdW5jdGlvbiB0byBzZWxlY3QgdGhlIGNob3NlbiBlcXVhdGlvbiB3aXRoIGl0cyBuYW1lIGFuZCBncmFwaCB3aW5kb3cgYm91bmRhcmllcy5cclxuICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmlnKHZhbCkge1xyXG4gICAgICAgIHZhciBwcm9mT3B0O1xyXG4gICAgICAgICQuZWFjaChwcm9mZXNzb3JDb25maWdGaWxlLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5lcXVhdGlvbiA9PT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9mT3B0ID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHByb2ZPcHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xlYXJWYWx1ZXMoKSB7XHJcbiAgICAgICAgdmFyIHhpbnB1dHMgPSAkKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgICAgIHlpbnB1dHMgPSAkKGB0ciB0ZDpudGgtb2YtdHlwZSgyKWApO1xyXG5cclxuICAgICAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9EaXBzbGF5IEthdGV4IGVxdWF0aW9uXHJcbiAgICBmdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xyXG5cclxuICAgICAgICBjbGVhclZhbHVlcygpO1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZk9wdCA9IGNoZWNrQ29uZmlnKHZhbCk7XHJcblxyXG4gICAgICAgIHZhciB5ID0gYHkgPSBgLFxyXG4gICAgICAgICAgICBlcXVhdCA9IGAke3ZhbH1gLFxyXG4gICAgICAgICAgICBlcXVQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI2VxdVwiKVswXSxcclxuICAgICAgICAgICAgeVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjeVwiKTtcclxuXHJcbiAgICAgICAgJChlcXVQYXJhKS5lbXB0eShcIlwiKTtcclxuXHJcbiAgICAgICAga2F0ZXgucmVuZGVyKHksIHlQYXJhWzBdKTtcclxuICAgICAgICBrYXRleC5yZW5kZXIoZXF1YXQsIGVxdVBhcmEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBPbmNoYW5nZSBldmVudCBoYW5kbGVyIGZvciB0aGUgc2VsZWN0IGh0bWwgZWxlbWVudC5cclxuICAgICovXHJcbiAgICAkKFwic2VsZWN0XCIpLmNoYW5nZShmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGNoYW5nZVBsb3QoZS50YXJnZXQudmFsdWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLypcclxuICAgIERPQ1VNRU5UIGtleWRvd24gZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoZG9jdW1lbnQpLmtleXByZXNzKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKGUud2hpY2ggPT0gMTMpIHtcclxuICAgICAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBHTyEgQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgIH0pOyIsInZhciBzdGF0dXNCYXIgPSAkKFwiI3N0YXR1cyBwXCIpLFxyXG4gICAgbGFzdFNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoIC0gMV0sXHJcbiAgICBlcXVQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI2VxdVwiKVswXSxcclxuICAgIGFuaUR1cmF0aW9uID0gMjtcclxuXHJcbi8vVE9ETzogU3R5bGUgdGhlIHdob2xlIHRoaW5nLlxyXG4vL1RPRE86IEdldCB0aGUgZnVuY3Rpb24gbWFjaGluZSBpbiB0aGVyZS5cclxuLy9UT0RPOiBWYWxpZGF0ZSB4IHZhbHVlcyB3aXRoaW4gdGhlIHNldCBkb21haW4gb2YgdGhlIHByb2ZPcHRcclxuLy9UT0RPOiBDaGVjayBicm93c2VyIGNvbXBhdGliaWxpdHkgKFByb21pc2VzIGluIElFKS5cclxuXHJcbmZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiBhbmltYXRpb24oYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICB2YXIgZGF0YXBvaW50ID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgICAgICBudW1QYXJhID0gZGF0YXBvaW50LmVsZW1lbnQ7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgTWFrZSB0aGUgcHJvbWlzZSB0aGF0IHdoZW4gdGhlIGR5bmFtaWNcclxuICAgICAgICBhbmltYXRpb24gcGF0aCBpcyBkb25lIHRoZW4gdGhpcyBwcm9taXNlIGlzIGZpbmlzaGVkXHJcbiAgICAgICAgKi9cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgJChudW1QYXJhKVxyXG4gICAgICAgICAgICAgICAgLmh0bWwodmFsdWUpXHJcbiAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBcImFuaW1hdGlvblwiOiBgJHtuYW1lfSR7YW5pU2V0dGluZ3MuY3VycmVudFJvdW5kfSAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vbmUoJ2FuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdGF0dXNNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgc3RhdHVzQmFyLmh0bWwoYDxwPiR7bWVzc2FnZX08L3A+YCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlcGxhY2VYRXF1KGRhdGEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBSZXBsYWNlIHRoZSB4IGluIHRoZSBkaXNhcHBlYXJlZCBlcXVhdGlvbiB3aXRob3V0IGhhdmluZyB0aGUgeSBkaXNhcHBlYXIuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFdmFsdWF0ZUVxdShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgeSBhbnN3ZXIgYW5kIHRoZSB4LWNoYW5nZWQgZXF1YXRpb25cclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgIGNoYW5nZUVxdSA9IHBvaW50RGF0YS5jaGFuZ2VFcXU7XHJcblxyXG4gICAgLypcclxuICAgIFNob3cgdGhlIG5ldyBlcXVhdGlvbiB3aXRoIHRoZSByZXBsYWNlZCB4LXZhbHVlIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAga2F0ZXgucmVuZGVyKGAke2NoYW5nZUVxdX1gLCBlcXVQYXJhKTtcclxuXHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dZQW5zKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0ZSB0aGUgbmV3IHkgdmFsdWUgdG8gdGhlIGNvb3JkaW5hdGVkIHkgY29sdW1uIGFuZCBvbmNlXHJcbiAgICBhbmltYXRpb24gaXMgZG9uZSB0aGVuIHJldHVybiB0aGUgcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3BvaW50RGF0YS55fWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFcXVhdGlvbkFnYWluKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYWNlWVZhbHVlKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIHktdmFsdWUgYXBwZWFycyBpbiB0aGUgY29ycmVjdCB5LWNvbHVtbiB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2UuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgdmFyIGlucHV0ID0gJChgdGQjeXZhbCR7cG9pbnREYXRhLmlkICsgMX1gKVswXTtcclxuICAgICAgICAkKGlucHV0KS5odG1sKFwiXCIpO1xyXG4gICAgICAgICQoaW5wdXQpLmFwcGVuZChgPHA+JHtwb2ludERhdGEueX08L3A+YCk7XHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVzZXRSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgY3VycmVudCByb3VuZCBhbmQgY3VycmVudCBkYXRhIHBvaW50c1xyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIGVxdWF0aW9uIGlzIGNsZWFyZWQgYW5kIHJlc2V0IHRvIHRoZSBkZWZhdWx0IGVxdWF0aW9uXHJcbiAgICB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3Byb2ZPcHQuZXF1YXRpb259YCwgZXF1UGFyYSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0RlZmF1bHRFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIC8qXHJcbiAgICBSZXR1cm4gdG8gZGVmYXVsdCBiZWdpbm5pbmcgZXF1YXRpb24gZm9yIHRoZSBuZXh0IGFuaW1hdGlvbiBvciBmb3IgdGhlIGVuZFxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuQWNjZXB0IHRoZSBkYXRhcG9pbnQgYW5kIGl0cyBpdGVyYXRvciBhbmQgcGxvdCB0aGF0IHBvaW50IGJlaW5nIHBhc3NlZCB0aHJvdWdoXHJcbiovXHJcbmZ1bmN0aW9uIHBsb3R0ZXIoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5ncmFwaE9wdC5jYWxsYmFjaygpO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVJvdW5kKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgcGxhY2Vob2xkZXIgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIFRoaXMgZnVuY3Rpb24gYWN0cyBhcyBhbiBpdGVyYXRvciBzbyB0aGF0IHRoZSBwcm9taXNlIGNoYWluIGtub3dzIHdoaWNoXHJcbiAgICBkYXRhcG9pbnQgdG8gaGFuZGxlIGFuZCB0byBhbmltYXRlXHJcbiAgICAqL1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGFuaVNldHRpbmdzLmN1cnJlbnRSb3VuZCArPSAxO1xyXG4gICAgICAgIHBsYWNlaG9sZGVyLnVwZGF0ZVBvaW50ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBhbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xyXG4gICAgZHBzLmRhdGFwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YXBvaW50KSB7XHJcbiAgICAgICAgaWYgKGRhdGFwb2ludC51cGRhdGVQb2ludCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBjaGFpbiA9IGNoYWluXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJ4VG9NYWNoaW5lXCIsIGRhdGFwb2ludC54KSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoXCJDYWxjdWxhdGluZ1wiKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcGxhY2VYRXF1KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0V2YWx1YXRlRXF1KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd1lBbnMpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RXF1YXRpb25BZ2FpbilcclxuICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcIm1hY2hpbmVUb1lcIiwgZGF0YXBvaW50LnkpKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihydW5BbmltYXRpb24oXCJ5VG9TdGF0dXNCYXJcIiwgYCgke2RhdGFwb2ludC54fSwke2RhdGFwb2ludC55fSlgKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoYFBsb3R0aW5nICgke2RhdGFwb2ludC54fSwke2RhdGFwb2ludC55fSlgKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsb3R0ZXIpXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXNldFJvdW5kKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShgYCkpXHJcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RGVmYXVsdEVxdSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoYWluID0gY2hhaW4udGhlbih1cGRhdGVSb3VuZCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xyXG4gICAgZHBzLmRhdGFwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YXBvaW50KSB7XHJcbiAgICAgICAgaWYgKGRhdGFwb2ludC51cGRhdGVQb2ludCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBjaGFpbiA9IGNoYWluXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbGFjZVlWYWx1ZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHBsb3R0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjaGFpbiA9IGNoYWluLnRoZW4odXBkYXRlUm91bmQpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbkhhbmRsZSBhbGwgQ1NTIGFuaW1hdGlvbnMgYnkgY3JlYXRpbmcgYSBQcm9taXNlIGNoYWluIHRocm91Z2ggYSBmb3IgbG9vcC5cclxuKi9cclxuZnVuY3Rpb24gYW5pbWF0b3JDb250cm9sKGRwcykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgbnVtQ29udGFpbmVyID0gJChcIiNudW1Db250YWluZXJcIiksXHJcbiAgICAgICAgY2hhaW4gPSBQcm9taXNlLnJlc29sdmUoZHBzKTtcclxuXHJcbiAgICBudW1Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuXHJcbiAgICBpZiAoZHBzLmdyYXBoT3B0LmFuaW1hdGVIaWRlKSB7XHJcbiAgICAgICAgbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
