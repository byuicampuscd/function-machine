"use strict";var plotGraph=function(){function t(t){return function(e){var n=(0).toFixed(2);return function(e){var a=t.x*e;this.textContent="( "+a.toFixed(2)+", "+n+")"}}}function e(t){return function(){var e=t.x,n=t.y;return function(t){this.textContent="( "+e+", "+(n*t).toFixed(2)+")"}}}function n(t){return"graphPoint"+t}function a(t){var e=d3.selectAll(c).append("g").attr("class","point").attr("id",n(t.id));return e.append("circle").attr("r",4).attr("cx",0).attr("cy",0),e.append("text").text("(0, 0)").attr("x",5).attr("y",15),e.attr("transform","translate("+l(0)+" "+d(0)+")"),e}function r(r,i){var o,u,s=r.datapoints[r.currentRound];document.querySelectorAll(c+" .graph .line").length>0;r.datapoints.forEach(function(t){t.updatePoint&&d3.select("#"+n(t.id)).remove()}),r.graphOpt.graphHide?d3.select(c+" .graph .line").attr("display","none"):d3.select(c+" .graph .line").attr("display","inline"),s.updatePoint?(o=a(s),r.graphOpt.animateHide?(o.attr("transform","translate("+l(s.x)+" "+d(s.y)+")"),o.select("text").text("("+s.x+", "+s.y+")"),i(r)):(u=o.transition().duration(1500).ease("cubic-out").attr("transform","translate("+l(s.x)+" "+d(0)+")"),u.select("text").tween("text",t(s)),u.transition().duration(1500).ease("cubic-out").attr("transform","translate("+l(s.x)+" "+d(s.y)+")").each("end",function(){i(r)}).select("text").tween("text",e(s)))):i(r)}function i(t,e){var n=t.graphOpt,a={target:e,data:[{fn:n.equation}],xAxis:{domain:[n.view.x.min,n.view.x.max]},yAxis:{domain:[n.view.y.min,n.view.y.max]}};o=e,c=o+" .content",u=n.equation,s=functionPlot(a),l=s.meta.xScale,d=s.meta.yScale,d3.selectAll(c+" .point").remove()}var o,c,u,s,l,d;return{update:r,setup:i}}();
"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;e<=n;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var t=$("<option></option>").append(n.name);$(t).val(n.equation),$("select").append(t)}var t=location.search.substring(1),o=t.split("=")[1]+".json";$.getJSON(o,function(t){window.professorConfigFile=t,$.each(t,function(t,o){n(o),0===t&&changePlot(o.equation)})}).fail(function(){$("#status p").append("Add a query string")})});
"use strict";function changePlot(t){xMemory=[],clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,o=$("#functionMachine #equ")[0],a=$("#functionMachine #y");$(o).empty(""),katex.render(n,a[0]),katex.render(e,o)}function stairStep(t){var n=246.5,e=document.styleSheets[document.styleSheets.length-1];e.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",e.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:100,startLeftOff:530,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function setUpObject(t,n,e){t.each(function(t){var o,a,i=$(this).val();if(i&&(o=+i,a=o.toFixed(profOpt.rounding),$(this).val(a),profOpt.view.x.min<=a&&a<=profOpt.view.x.max)){var p=n.equation.replace("x","("+a+")"),r=math.eval(p),u=(this.getBoundingClientRect(),{x:a,y:r.toFixed(profOpt.rounding),id:t,changeEqu:profOpt.equation.replace("x","("+a+")"),updatePoint:xMemory[t]!==a,element:$("#numContainer p").get(t)});u.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=a,e.datapoints.push(u)}})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,o={callback:function(t){return new Promise(function(n){t.datapoints[t.currentRound].updatePoint=!1,console.log("next:",t.currentRound),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},a={datapoints:[],currentRound:0,graphOpt:o};setUpObject(t,o,a),animatorControl(a)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,o){o.equation===t&&(n=o)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,run=!0,i=0;i<inputs.length;i++)inputs[i].oninput=function(t){var n=t.srcElement.value;profOpt.view.x.min<=n&&n<=profOpt.view.x.max?(run=!0,$("input[type='button'][value='Go!']").prop("disabled",!1).css({cursor:"pointer"}),$("#status p").html("")):(run=!1,$("input[type='button'][value='Go!']").prop("disabled",!0).css({cursor:"not-allowed"}),$("#status p").html(n+" x-value out of domains."))};for(var i=0;i<inputCount;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&run&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){run&&startFuncMach()});
"use strict";function runAnimation(n,t){return function(a){var e=a.datapoints[a.currentRound],i=e.element;return new Promise(function(e){$(i).html(t).css({animation:""+n+a.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){e(a)})})}}function statusMessage(n){var t=$("#status p");return function(a){return new Promise(function(e){t.html(n),e(a)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],a=t.changeEqu;return new Promise(function(t){katex.render(""+a,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),a(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){var e=$("td#yval"+(t.id+1))[0];$(e).html(""),$(e).append("<p>"+t.y+"</p>"),a(n)})}function resetRound(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){plotGraph.update(n,n.graphOpt.callback),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){n.currentRound+=1,t.updatePoint=!1,a(n)})}function animateFuncMachine(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../img/functionMachineAni.gif)"}),t(n)})}function stopAniFuncMachine(n){return new Promise(function(t){$("#functionMachine").css({"background-image":"url(../img/functionMachineStill.gif)"}),t(n)})}function miniAni(n){return new Promise(function(t){var a=n.datapoints[n.currentRound],e=a.y,i=$("<p>"+e+"</p>");$("body").append(i),i.css({position:"absolute",opacity:0,left:550,top:50}).animate({opacity:1,top:100},function(a){i.css({display:"none"}),t(n)})})}function aniPromiseChain(n,t){plotGraph.setup(n,"#graph"),n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(animateFuncMachine).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(stopAniFuncMachine).then(miniAni).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),a=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,a):aniPromiseChain(n,a)}var equPara=$("#functionMachine #equ")[0],aniDuration=2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsb3RHcmFwaC5qcyIsIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInBsb3RHcmFwaCIsInVwZGF0ZVRleHRYIiwiY3VycmVudFBvaW50IiwiZCIsInplcm8iLCJ0b0ZpeGVkIiwidCIsImxvY2F0aW9uIiwieCIsInRoaXMiLCJ0ZXh0Q29udGVudCIsInVwZGF0ZVRleHRZIiwieFJvdW5kZWQiLCJ5VmFsIiwieSIsIm1ha2VQb2ludElkIiwibnVtSW4iLCJtYWtlUG9pbnRHcm91cCIsInBvaW50R3JvdXAiLCJkMyIsInNlbGVjdEFsbCIsImRvdExvY2F0aW9uIiwiYXBwZW5kIiwiYXR0ciIsImlkIiwidGV4dCIsInhTY2FsZSIsInlTY2FsZSIsInVwZGF0ZSIsImFuaU9wdGlvbnMiLCJjYWxsYmFjayIsInRyYW5zaXRpb24iLCJkYXRhcG9pbnRzIiwiY3VycmVudFJvdW5kIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiZm9yRWFjaCIsInBvaW50IiwidXBkYXRlUG9pbnQiLCJzZWxlY3QiLCJyZW1vdmUiLCJncmFwaE9wdCIsImdyYXBoSGlkZSIsImFuaW1hdGVIaWRlIiwiZHVyYXRpb24iLCJlYXNlIiwidHdlZW4iLCJlYWNoIiwic2V0dXAiLCJzZWxlY3RvciIsIm9wdHNJbiIsImdyYXBoT3B0aW9ucyIsInRhcmdldCIsImRhdGEiLCJmbiIsImVxdWF0aW9uIiwieEF4aXMiLCJkb21haW4iLCJ2aWV3IiwibWluIiwibWF4IiwieUF4aXMiLCJncmFwaExvY2F0aW9uU2VsZWN0b3IiLCJjdXJyZW50RXF1YXRpb24iLCJmdW5QbG90IiwiZnVuY3Rpb25QbG90IiwibWV0YSIsInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsInByb2ZPcHQiLCJvcHQiLCJuYW1lIiwidmFsIiwicXVlcnlTdHJpbmciLCJzZWFyY2giLCJzdWJzdHJpbmciLCJxdWVyeSIsInNwbGl0IiwiZ2V0SlNPTiIsInJlc3VsdCIsIndpbmRvdyIsInByb2Zlc3NvckNvbmZpZ0ZpbGUiLCJpIiwiY2hhbmdlUGxvdCIsImZhaWwiLCJ4TWVtb3J5IiwiY2xlYXJWYWx1ZXMiLCJjaGVja0NvbmZpZyIsImVxdWF0IiwiZXF1UGFyYSIsInlQYXJhIiwiZW1wdHkiLCJrYXRleCIsInJlbmRlciIsInN0YWlyU3RlcCIsIm9wdGlvbnMiLCJoaWdod2F5UGF0aCIsImxhc3RTaGVldCIsInN0eWxlU2hlZXRzIiwiaW5zZXJ0UnVsZSIsInN0YXJ0VG9wT2ZmIiwic3RhcnRMZWZ0T2ZmIiwiZW5kVG9wT2ZmIiwiZW5kTGVmdE9mZiIsImNzc1J1bGVzIiwibWFrZVhUb01hY2hpbmUiLCJpbnB1dENvcmRzIiwiaW5kZXgiLCJ0b3AiLCJsZWZ0IiwibWFrZU1hY2hpbmVUb1kiLCJyaWdodCIsIm1ha2VZVG9TdGF0dXNCYXIiLCJzZXRVcE9iamVjdCIsInhpbnB1dHMiLCJhbmlTZXR0aW5ncyIsInh2YWwiLCJyb3VuZGl0IiwieHZhbHVlIiwicm91bmRpbmciLCJyZXBsYWNlWCIsInJlcGxhY2UiLCJ5dmFsIiwibWF0aCIsImV2YWwiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJjaGFuZ2VFcXUiLCJlbGVtZW50IiwiZ2V0IiwiaHRtbCIsInB1c2giLCJzdGFydEZ1bmNNYWNoIiwiaGlkZUFuaW1hdGlvbkNoZWNrZWQiLCJoaWRlR3JhcGhDaGVja2VkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb25zb2xlIiwibG9nIiwiYW5pbWF0b3JDb250cm9sIiwiaXRlbSIsInlpbnB1dHMiLCJ2YWx1ZSIsImlubmVySFRNTCIsImlucHV0cyIsImlucHV0Q291bnQiLCJydW4iLCJvbmlucHV0IiwiZSIsInhJbnB1dFZhbCIsInNyY0VsZW1lbnQiLCJwcm9wIiwiY3NzIiwiY3Vyc29yIiwiaW5wdXRDb29yIiwiY2hhbmdlIiwia2V5cHJlc3MiLCJ3aGljaCIsImNsaWNrIiwicnVuQW5pbWF0aW9uIiwiZGF0YXBvaW50IiwibnVtUGFyYSIsImFuaW1hdGlvbiIsImFuaUR1cmF0aW9uIiwib25lIiwic3RhdHVzTWVzc2FnZSIsIm1lc3NhZ2UiLCJzdGF0dXNCYXIiLCJyZXBsYWNlWEVxdSIsInNob3dFdmFsdWF0ZUVxdSIsInBvaW50RGF0YSIsInNob3dZQW5zIiwic2hvd0VxdWF0aW9uQWdhaW4iLCJwbGFjZVlWYWx1ZSIsInJlc2V0Um91bmQiLCJzaG93RGVmYXVsdEVxdSIsInBsb3R0ZXIiLCJ1cGRhdGVSb3VuZCIsInBsYWNlaG9sZGVyIiwiYW5pbWF0ZUZ1bmNNYWNoaW5lIiwiYmFja2dyb3VuZC1pbWFnZSIsInN0b3BBbmlGdW5jTWFjaGluZSIsIm1pbmlBbmkiLCJ5dmFsdWUiLCJwYXJhIiwicG9zaXRpb24iLCJvcGFjaXR5IiwiYW5pbWF0ZSIsImRpc3BsYXkiLCJhbmlQcm9taXNlQ2hhaW4iLCJkcHMiLCJjaGFpbiIsInRoZW4iLCJub0FuaVByb21pc2VDaGFpbiIsIm51bUNvbnRhaW5lciJdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFJQSxXQUFhLFdBV2IsUUFBU0MsR0FBWUMsR0FDakIsTUFBTyxVQUFVQyxHQUNiLEdBQUlDLElBQVEsR0FBR0MsUUFBUSxFQUV2QixPQUFPLFVBQVVDLEdBQ2IsR0FBSUMsR0FBV0wsRUFBYU0sRUFBSUYsQ0FDaENHLE1BQUtDLFlBQWMsS0FBT0gsRUFBU0YsUUFBUSxHQUFLLEtBQU9ELEVBQU8sTUFLMUUsUUFBU08sR0FBWVQsR0FDakIsTUFBTyxZQUVILEdBQUlVLEdBQVdWLEVBQWFNLEVBQ3hCSyxFQUFPWCxFQUFhWSxDQUV4QixPQUFPLFVBQVVSLEdBQ2JHLEtBQUtDLFlBQWMsS0FBT0UsRUFBVyxNQUFRQyxFQUFPUCxHQUFHRCxRQUFRLEdBQUssTUFLaEYsUUFBU1UsR0FBWUMsR0FDakIsTUFBTyxhQUFlQSxFQUcxQixRQUFTQyxHQUFlZixHQUNwQixHQUFJZ0IsR0FBYUMsR0FBR0Ms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QVVqSSxlQUFnQixJQUMxQmdLLEVBQVFBLEVBQ0hDLEtBQUtqQyxhQUFhLGFBQWNDLEVBQVVoSyxJQUMxQ2dNLEtBQUtiLG9CQUNMYSxLQUFLM0IsY0FBYyxnQkFDbkIyQixLQUFLeEIsYUFDTHdCLEtBQUt2QixpQkFDTHVCLEtBQUtyQixVQUNMcUIsS0FBS3BCLG1CQUNMb0IsS0FBS1gsb0JBQ0xXLEtBQUtWLFNBQ0xVLEtBQUtqQyxhQUFhLGFBQWNDLEVBQVUxSixJQUMxQzBMLEtBQUtuQixhQUNMbUIsS0FBS2pDLGFBQWEsZUFBYixJQUFpQ0MsRUFBVWhLLEVBQTNDLElBQWdEZ0ssRUFBVTFKLEVBQTFELE1BQ0wwTCxLQUFLM0IsY0FBQUEsYUFBMkJMLEVBQVVoSyxFQUFyQyxJQUEwQ2dLLEVBQVUxSixFQUFwRCxNQUNMMEwsS0FBS2hCLFNBQ0xnQixLQUFLbEIsWUFDTGtCLEtBQUszQixjQUFBQSxLQUNMMkIsS0FBS2pCLGlCQUVkZ0IsRUFBUUEsRUFBTUMsS0FBS2YsZUFRM0IsUUFBU2dCLG1CQUFrQkgsRUFBS0MsR0FDNUJELEVBQUl0SyxXQUFXSyxRQUFRLFNBQVVtSSxHQUN6QkEsRUFBVWpJLGVBQWdCLElBQzFCZ0ssRUFBUUEsRUFDSEMsS0FBS25CLGFBQ0xtQixLQUFLaEIsVUFFZGUsRUFBUUEsRUFBTUMsS0FBS2YsZUFPM0IsUUFBU3RDLGlCQUFnQm1ELEdBR3JCLEdBQUlJLEdBQWVqSSxFQUFFLGlCQUNqQjhILEVBQVF4RCxRQUFRQyxRQUFRc0QsRUFFNUJJLEdBQWFuRCxVQUFZLEdBRXJCK0MsRUFBSTVKLFNBQVNFLFlBQ2I2SixrQkFBa0JILEVBQUtDLEdBRXZCRixnQkFBZ0JDLEVBQUtDLEdBclU3QixHQUFJckcsU0FBVXpCLEVBQUUseUJBQXlCLEdBQ3JDa0csWUFBYyIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypqc2xpbnQgcGx1c3BsdXM6IHRydWUsIGJyb3dzZXI6IHRydWUsIGRldmVsOiB0cnVlKi9cbi8qZ2xvYmFsIGQzLCBmdW5jdGlvblBsb3QqL1xudmFyIHBsb3RHcmFwaCA9IChmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIGdyYXBoTG9jYXRpb25TZWxlY3RvcixcbiAgICAgICAgZG90TG9jYXRpb24sXG4gICAgICAgIGN1cnJlbnRFcXVhdGlvbixcbiAgICAgICAgZnVuUGxvdCxcbiAgICAgICAgeFNjYWxlLFxuICAgICAgICB5U2NhbGUsXG4gICAgICAgIGZyZWVJZCA9IDA7XG5cbiAgICAvL3RoZXNlIHR3byBmdW5jdGlvbnMgbWFrZSB0aGUgZmFjdG9yeSBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgaW4gdGhlIGFuaW1hdGlvbnMgZm9yIHRoZSBwb2ludCBsYWJlbHMgXG4gICAgZnVuY3Rpb24gdXBkYXRlVGV4dFgoY3VycmVudFBvaW50KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgdmFyIHplcm8gPSAoMCkudG9GaXhlZCgyKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gY3VycmVudFBvaW50LnggKiB0O1xuICAgICAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQgPSBcIiggXCIgKyBsb2NhdGlvbi50b0ZpeGVkKDIpICsgXCIsIFwiICsgemVybyArIFwiKVwiO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVUZXh0WShjdXJyZW50UG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHhSb3VuZGVkID0gY3VycmVudFBvaW50LngsXG4gICAgICAgICAgICAgICAgeVZhbCA9IGN1cnJlbnRQb2ludC55O1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRDb250ZW50ID0gXCIoIFwiICsgeFJvdW5kZWQgKyBcIiwgXCIgKyAoeVZhbCAqIHQpLnRvRml4ZWQoMikgKyBcIilcIjtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZVBvaW50SWQobnVtSW4pIHtcbiAgICAgICAgcmV0dXJuICdncmFwaFBvaW50JyArIG51bUluO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1ha2VQb2ludEdyb3VwKGN1cnJlbnRQb2ludCkge1xuICAgICAgICB2YXIgcG9pbnRHcm91cCA9IGQzLnNlbGVjdEFsbChkb3RMb2NhdGlvbikuYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdwb2ludCcpXG4gICAgICAgICAgICAuYXR0cignaWQnLCBtYWtlUG9pbnRJZChjdXJyZW50UG9pbnQuaWQpKTtcblxuICAgICAgICAvL2FkZCB0aGUgY2lyY2xlXG4gICAgICAgIHBvaW50R3JvdXAuYXBwZW5kKCdjaXJjbGUnKVxuICAgICAgICAgICAgLmF0dHIoJ3InLCA0KVxuICAgICAgICAgICAgLmF0dHIoJ2N4JywgMClcbiAgICAgICAgICAgIC5hdHRyKCdjeScsIDApO1xuXG4gICAgICAgIC8vYWRkIHRoZSBsYWJlbFxuICAgICAgICBwb2ludEdyb3VwLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAudGV4dCgnKDAsIDApJylcbiAgICAgICAgICAgIC5hdHRyKCd4JywgNSlcbiAgICAgICAgICAgIC5hdHRyKCd5JywgMTUpO1xuICAgICAgICAvL21vdmUgaXQgdG8gKDAsMClcbiAgICAgICAgcG9pbnRHcm91cC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgKyB4U2NhbGUoMCkgKyAnICcgKyB5U2NhbGUoMCkgKyAnKScpO1xuICAgICAgICByZXR1cm4gcG9pbnRHcm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGUoYW5pT3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGN1cnJlbnRQb2ludCA9IGFuaU9wdGlvbnMuZGF0YXBvaW50c1thbmlPcHRpb25zLmN1cnJlbnRSb3VuZF0sXG4gICAgICAgICAgICBsaW5lSXNQbG90dGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkb3RMb2NhdGlvbiArICcgLmdyYXBoIC5saW5lJykubGVuZ3RoID4gMCxcbiAgICAgICAgICAgIHBvaW50R3JvdXAsXG4gICAgICAgICAgICB0cmFuc2l0aW9uO1xuXG4gICAgICAgIC8vY2xlYXIgYW55IHBvaW50cyB0aGF0IHdpbGwgZ2V0IHVwZGF0ZWRcbiAgICAgICAgYW5pT3B0aW9ucy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgICAgICBpZiAocG9pbnQudXBkYXRlUG9pbnQpIHtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoJyMnICsgbWFrZVBvaW50SWQocG9pbnQuaWQpKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9jaGVjayBpZiB3ZSBuZWVkIHRvIGhpZGUgb3Igc2hvdyB0aGUgcGxvdGxpbmVcbiAgICAgICAgaWYgKGFuaU9wdGlvbnMuZ3JhcGhPcHQuZ3JhcGhIaWRlKSB7XG4gICAgICAgICAgICBkMy5zZWxlY3QoZG90TG9jYXRpb24gKyAnIC5ncmFwaCAubGluZScpLmF0dHIoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZDMuc2VsZWN0KGRvdExvY2F0aW9uICsgJyAuZ3JhcGggLmxpbmUnKS5hdHRyKCdkaXNwbGF5JywgJ2lubGluZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9kb2VzIHRoZSBjdXJyZW50Um91bmQgbmVlZCB0byBiZSB1cGRhdGVkZWQ/XG4gICAgICAgIGlmICghY3VycmVudFBvaW50LnVwZGF0ZVBvaW50KSB7XG4gICAgICAgICAgICAvL25vdGhpdG5nIHRvIHNlZSBoZXJlIGp1c3Qga2VlcCBvbiBtb3ZpbmdcbiAgICAgICAgICAgIGNhbGxiYWNrKGFuaU9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9kcmF3IHBvaW50IFxuICAgICAgICAgICAgcG9pbnRHcm91cCA9IG1ha2VQb2ludEdyb3VwKGN1cnJlbnRQb2ludCk7XG5cbiAgICAgICAgICAgIC8vaXMgYW5pbWF0aW9uIG9uP1xuICAgICAgICAgICAgaWYgKGFuaU9wdGlvbnMuZ3JhcGhPcHQuYW5pbWF0ZUhpZGUpIHtcbiAgICAgICAgICAgICAgICAvL21vdmUgaXQgaW50byBwbGFjZSB3aXRob3V0IGFuaW1hdGlvblxuICAgICAgICAgICAgICAgIHBvaW50R3JvdXAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeFNjYWxlKGN1cnJlbnRQb2ludC54KSArICcgJyArIHlTY2FsZShjdXJyZW50UG9pbnQueSkgKyAnKScpO1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlIHRoZSBsYWJsZVxuICAgICAgICAgICAgICAgIHBvaW50R3JvdXAuc2VsZWN0KCd0ZXh0JykudGV4dCgnKCcgKyBjdXJyZW50UG9pbnQueCArICcsICcgKyBjdXJyZW50UG9pbnQueSArICcpJyk7XG4gICAgICAgICAgICAgICAgLy9jYWxsIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soYW5pT3B0aW9ucyk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9kcmF3IHBvaW50IHdpdGggYW5pbWFpb25cbiAgICAgICAgICAgICAgICAvL0ZpcnN0IHRyYW5zaXRpb24gLSBtb3ZlIHRoZSBncm91cCBpbiB0aGUgWFxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24gPSBwb2ludEdyb3VwXG4gICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKDE1MDApXG4gICAgICAgICAgICAgICAgICAgIC5lYXNlKCdjdWJpYy1vdXQnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgeFNjYWxlKGN1cnJlbnRQb2ludC54KSArICcgJyArIHlTY2FsZSgwKSArICcpJyk7XG4gICAgICAgICAgICAgICAgLy9zdWIgdHJhbnNpdGlvbiAtIHVwZGF0ZSB0aGUgbGFiZWxcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uLnNlbGVjdCgndGV4dCcpLnR3ZWVuKCd0ZXh0JywgdXBkYXRlVGV4dFgoY3VycmVudFBvaW50KSk7XG5cbiAgICAgICAgICAgICAgICAvL1NlY29uZCB0cmFuc2l0aW9uIC0gbW92ZSB0aGUgZ3JvdXAgaW4gdGhlIFlcbiAgICAgICAgICAgICAgICAvL3N1YiB0cmFuc2l0aW9uIC0gdXBkYXRlIHRoZSBsYWJlbFxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24udHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbigxNTAwKVxuICAgICAgICAgICAgICAgICAgICAuZWFzZSgnY3ViaWMtb3V0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHhTY2FsZShjdXJyZW50UG9pbnQueCkgKyAnICcgKyB5U2NhbGUoY3VycmVudFBvaW50LnkpICsgJyknKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaCgnZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soYW5pT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zZWxlY3QoJ3RleHQnKS50d2VlbigndGV4dCcsIHVwZGF0ZVRleHRZKGN1cnJlbnRQb2ludCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0dXAoYW5pT3B0aW9ucywgc2VsZWN0b3IpIHtcbiAgICAgICAgLy9zdWdhclxuICAgICAgICB2YXIgb3B0c0luID0gYW5pT3B0aW9ucy5ncmFwaE9wdCxcbiAgICAgICAgICAgIGdyYXBoT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHNlbGVjdG9yLFxuICAgICAgICAgICAgICAgIGRhdGE6IFt7XG4gICAgICAgICAgICAgICAgICAgIGZuOiBvcHRzSW4uZXF1YXRpb25cbiAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB4QXhpczoge1xuICAgICAgICAgICAgICAgICAgICBkb21haW46IFtvcHRzSW4udmlldy54Lm1pbiwgb3B0c0luLnZpZXcueC5tYXhdXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgICAgICBkb21haW46IFtvcHRzSW4udmlldy55Lm1pbiwgb3B0c0luLnZpZXcueS5tYXhdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3NhdmUgc29tZSB0aGluZ3MgZm9yIGxhdGVyXG4gICAgICAgIGdyYXBoTG9jYXRpb25TZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICBkb3RMb2NhdGlvbiA9IGdyYXBoTG9jYXRpb25TZWxlY3RvciArICcgLmNvbnRlbnQnO1xuICAgICAgICBjdXJyZW50RXF1YXRpb24gPSBvcHRzSW4uZXF1YXRpb247XG5cbiAgICAgICAgLy9tYWtlIHRoZSBwbG90IGFuZCBzY2FsZXNcbiAgICAgICAgZnVuUGxvdCA9IGZ1bmN0aW9uUGxvdChncmFwaE9wdGlvbnMpO1xuICAgICAgICB4U2NhbGUgPSBmdW5QbG90Lm1ldGEueFNjYWxlO1xuICAgICAgICB5U2NhbGUgPSBmdW5QbG90Lm1ldGEueVNjYWxlO1xuXG4gICAgICAgIC8vY2xlYW4gb3V0IGFueSBvbGQgcG9pbnRzIGZpcnN0XG4gICAgICAgIGQzLnNlbGVjdEFsbChkb3RMb2NhdGlvbiArICcgLnBvaW50JykucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHNldHVwOiBzZXR1cFxuICAgIH07XG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvKlxuICAgIE1ha2UgdGhlIHdob2xlIHRhYmxlIGFuZCBjZWxscyBmb3IgdGhlIGlucHV0IGJveGVzIGFuZCB1c2VyIGludGVyYWN0aW9uLlxuICAgICovXG4gICAgdmFyIHRib2R5ID0gJChcInRib2R5XCIpLFxuICAgICAgICB0ZDEsXG4gICAgICAgIHRkMixcbiAgICAgICAgdHIsXG4gICAgICAgIGlucHV0LFxuICAgICAgICByb3dDb3VudCA9IDE5O1xuXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xuICAgICAgICBpbnB1dCA9ICQoXCI8aW5wdXQ+XCIpO1xuICAgICAgICB0ZDEgPSAkKFwiPHRkPjwvdGQ+XCIpO1xuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xuICAgICAgICB0ciA9ICQoXCI8dHI+PC90cj5cIik7XG5cbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XG5cbiAgICAgICAgJChpbnB1dCkuYXR0cihcIm5hbWVcIiwgYGlucHV0JHtqfWApLmF0dHIoXCJ0eXBlXCIsIFwibnVtYmVyXCIpO1xuXG4gICAgICAgICQodGQyKS5hdHRyKFwiaWRcIiwgYHl2YWwke2p9YCk7XG5cbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XG4gICAgICAgICQodHIpLmFwcGVuZCh0ZDEpLmFwcGVuZCh0ZDIpO1xuICAgICAgICAkKHRib2R5KS5hcHBlbmQodHIpO1xuICAgIH1cbn0oKSk7XG4iLCIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAvKlxuICAgIExvYWQgUXVlcnkgc3Vic3RyaW5nXG4gICAgKi9cbiAgICB2YXIgcXVlcnlTdHJpbmcgPSBsb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLFxuICAgICAgICBxdWVyeSA9IHF1ZXJ5U3RyaW5nLnNwbGl0KFwiPVwiKVsxXSArIFwiLmpzb25cIjtcblxuICAgIGZ1bmN0aW9uIHNob3dQcm9mT3B0aW9ucyhwcm9mT3B0KSB7XG4gICAgICAgIC8qXG4gICAgICAgIEFwcGVuZCB0aGUgcHJvZmVzc29yJ3MgY2hvc2VuIGVxdWF0aW9ucyB0byB0aGUgYXBwbGljYXRpb25cbiAgICAgICAgKi9cblxuICAgICAgICB2YXIgb3B0ID0gJChcIjxvcHRpb24+PC9vcHRpb24+XCIpLmFwcGVuZChwcm9mT3B0Lm5hbWUpO1xuXG4gICAgICAgICQob3B0KS52YWwocHJvZk9wdC5lcXVhdGlvbik7XG5cbiAgICAgICAgJChcInNlbGVjdFwiKS5hcHBlbmQob3B0KTtcbiAgICB9XG5cbiAgICAvKlxuICAgIExvYWQgdGhlIHByb2Zlc3NvciBjb25maWd1cmF0aW9uIGZpbGVcbiAgICAqL1xuXG4gICAgJC5nZXRKU09OKHF1ZXJ5LCBmdW5jdGlvbiAocmVzdWx0KSB7XG5cbiAgICAgICAgd2luZG93LnByb2Zlc3NvckNvbmZpZ0ZpbGUgPSByZXN1bHQ7XG5cbiAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGksIHByb2ZPcHQpIHtcblxuICAgICAgICAgICAgc2hvd1Byb2ZPcHRpb25zKHByb2ZPcHQpO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAvL2luIGV2ZW50cy5qc1xuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QocHJvZk9wdC5lcXVhdGlvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KS5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKFwiI3N0YXR1cyBwXCIpLmFwcGVuZChcIkFkZCBhIHF1ZXJ5IHN0cmluZ1wiKVxuICAgIH0pOztcblxufSk7XG4iLCIvKlxuU2V0IHVwIHRoZSBiYXNpYyB2YXJpYWJsZXMuXG4qL1xudmFyIHhNZW1vcnkgPSBbXSxcbiAgICBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXG4gICAgaW5wdXRDb3VudCA9IGlucHV0cy5sZW5ndGgsXG4gICAgcnVuID0gdHJ1ZTtcblxuLypcbkF0dGFjaCBhbiBvbmlucHV0IGV2ZW50IHRvIGFsbCB0aGUgaW5wdXQgYm94ZXMgaW4gb3JkZXIgdG8gdmFsaWRhdGUgdGhlbSB3aXRoaW4gdGhlIGJvdW5kc1xudGhhdCB0aGUgcHJvZmVzc29yIGhhcyBjaG9zZW4uICBJZiB0aGUgYm91bmRzIGFyZSBleGNlZWRlZCwgdGhlbiBkaXNhYmxlIHRoZSBcIkdvIVwiIGJ1dHRvblxuYW5kIG91dHB1dCBhIG1lc3NhZ2UgdG8gdGhlIHN0YXR1cyBiYXIuXG4qL1xuZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcblxuICAgIGlucHV0c1tpXS5vbmlucHV0ID0gZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICB2YXIgeElucHV0VmFsID0gZS5zcmNFbGVtZW50LnZhbHVlO1xuICAgICAgICBpZiAocHJvZk9wdC52aWV3LngubWluIDw9IHhJbnB1dFZhbCAmJiB4SW5wdXRWYWwgPD0gcHJvZk9wdC52aWV3LngubWF4KSB7XG4gICAgICAgICAgICBydW4gPSB0cnVlO1xuICAgICAgICAgICAgJChcImlucHV0W3R5cGU9J2J1dHRvbiddW3ZhbHVlPSdHbyEnXVwiKVxuICAgICAgICAgICAgICAgIC5wcm9wKFwiZGlzYWJsZWRcIiwgZmFsc2UpXG4gICAgICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIFwiY3Vyc29yXCI6IFwicG9pbnRlclwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKFwiI3N0YXR1cyBwXCIpLmh0bWwoYGApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcnVuID0gZmFsc2U7XG4gICAgICAgICAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpXG4gICAgICAgICAgICAgICAgLnByb3AoXCJkaXNhYmxlZFwiLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcImN1cnNvclwiOiBcIm5vdC1hbGxvd2VkXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoXCIjc3RhdHVzIHBcIikuaHRtbChgJHt4SW5wdXRWYWx9IHgtdmFsdWUgb3V0IG9mIGRvbWFpbnMuYCk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKlxuRGlwc2xheSBLYXRleCBlcXVhdGlvbi4gQUxTTyB1c2VkIGluIGFqYXguanNcbiovXG5mdW5jdGlvbiBjaGFuZ2VQbG90KHZhbCkge1xuXG4gICAgeE1lbW9yeSA9IFtdO1xuXG4gICAgY2xlYXJWYWx1ZXMoKTtcblxuICAgIHdpbmRvdy5wcm9mT3B0ID0gY2hlY2tDb25maWcodmFsKTtcbiAgICB2YXIgeSA9IGB5ID0gYCxcbiAgICAgICAgZXF1YXQgPSBgJHt2YWx9YCxcbiAgICAgICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXG4gICAgICAgIHlQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI3lcIik7XG5cbiAgICAkKGVxdVBhcmEpLmVtcHR5KFwiXCIpO1xuXG4gICAga2F0ZXgucmVuZGVyKHksIHlQYXJhWzBdKTtcbiAgICBrYXRleC5yZW5kZXIoZXF1YXQsIGVxdVBhcmEpO1xufVxuXG4vKlxuQW5pbWF0aW9uIHBhdGggZm9yIHRoZSBzdGFpcnN0ZXBcbiovXG5mdW5jdGlvbiBzdGFpclN0ZXAob3B0aW9ucykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBoaWdod2F5UGF0aCA9IDI0Ni41LFxuICAgICAgICBsYXN0U2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXTtcbiAgICBsYXN0U2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke29wdGlvbnMubmFtZX0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuc3RhcnRUb3BPZmZ9cHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5zdGFydExlZnRPZmZ9cHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwJSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDMzJSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJHtvcHRpb25zLnN0YXJ0VG9wT2ZmfXB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NiUge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7aGlnaHdheVBhdGh9cHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDkwJSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCUge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5lbmRMZWZ0T2ZmfXB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1gLCBsYXN0U2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbn1cblxuLypcbkEgc2V0IG9mIGZ1bmN0aW9ucyB1c2luZyB0aGUgc3RhaXJzdGVwIGFuaW1hdGlvbiB0ZW1wbGF0ZVxudG8gY3JlYXRlIHBhdGh3YXlzIHdpdGggY29vcmRpbmF0ZSBkYXRhXG4qL1xuZnVuY3Rpb24gbWFrZVhUb01hY2hpbmUoaW5wdXRDb3JkcywgaW5kZXgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBzdGFpclN0ZXAoe1xuICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxuICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMubGVmdCArIDMwLFxuICAgICAgICBlbmRUb3BPZmY6IDU1LFxuICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXG4gICAgICAgIG5hbWU6IGB4VG9NYWNoaW5lJHtpbmRleH1gXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIG1ha2VNYWNoaW5lVG9ZKGlucHV0Q29yZHMsIGluZGV4KSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgc3RhaXJTdGVwKHtcbiAgICAgICAgc3RhcnRUb3BPZmY6IDEwMCxcbiAgICAgICAgc3RhcnRMZWZ0T2ZmOiA1MzAsXG4gICAgICAgIGVuZFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxuICAgICAgICBlbmRMZWZ0T2ZmOiBpbnB1dENvcmRzLnJpZ2h0ICsgNSxcbiAgICAgICAgbmFtZTogYG1hY2hpbmVUb1kke2luZGV4fWBcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gbWFrZVlUb1N0YXR1c0JhcihpbnB1dENvcmRzLCBpbmRleCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHN0YWlyU3RlcCh7XG4gICAgICAgIHN0YXJ0VG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXG4gICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDEwLFxuICAgICAgICBlbmRUb3BPZmY6IDE1MCxcbiAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxuICAgICAgICBuYW1lOiBgeVRvU3RhdHVzQmFyJHtpbmRleH1gXG4gICAgfSk7XG59XG5cbi8qXG5TZXQgdXAgdGhlIHhNZW1vcnkgYXJyYXkgYW5kIHRoZSBhbmltYXRpb24gcGF0aHMgZm9yIGVhY2ggaW5wdXQgYm94LlxuXG5OT1RFOiBTZXR0aW5nIHVwIHRoZSB4TWVtb3J5IGFycmF5IGFsc28gbWFrZXMgaXQgc28gdGhhdCBubyBhbmltYXRpb25zXG4gICAgICBhcmUgcmVwZWF0ZWQgYnkgbXVsdGlwbGUgY2xpY2tzIG9uIHRoZSBcIkdvIVwiIGJ1dHRvbi5cbiovXG5mb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Q291bnQ7IGkrKykge1xuICAgIHhNZW1vcnlbaV0gPSBudWxsO1xuXG4gICAgdmFyIGlucHV0Q29vciA9IGlucHV0c1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIG1ha2VYVG9NYWNoaW5lKGlucHV0Q29vciwgaSk7XG4gICAgbWFrZU1hY2hpbmVUb1koaW5wdXRDb29yLCBpKTtcbiAgICBtYWtlWVRvU3RhdHVzQmFyKGlucHV0Q29vciwgaSk7XG4gICAgJChcIiNudW1Db250YWluZXJcIikuYXBwZW5kKCQoYDxwPjwvcD5gKSk7XG59XG5cbi8qXG5TZXQgdXAgdGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgcGFzc2VkIHRocm91Z2ggdGhlIHByb21pc2UgY2hhaW5cbmluIGFuaW1hdG9yY29udHJvbC5cbiovXG5mdW5jdGlvbiBzZXRVcE9iamVjdCh4aW5wdXRzLCBncmFwaE9wdCwgYW5pU2V0dGluZ3MpIHtcbiAgICB4aW5wdXRzLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgdmFyIHh2YWx1ZSA9ICQodGhpcykudmFsKCksXG4gICAgICAgICAgICB4dmFsLFxuICAgICAgICAgICAgcm91bmRpdDtcblxuICAgICAgICBpZiAoeHZhbHVlKSB7XG4gICAgICAgICAgICB4dmFsID0gK3h2YWx1ZTtcbiAgICAgICAgICAgIHJvdW5kaXQgPSB4dmFsLnRvRml4ZWQocHJvZk9wdC5yb3VuZGluZyk7XG5cbiAgICAgICAgICAgICQodGhpcykudmFsKHJvdW5kaXQpO1xuXG4gICAgICAgICAgICBpZiAocHJvZk9wdC52aWV3LngubWluIDw9IHJvdW5kaXQgJiYgcm91bmRpdCA8PSBwcm9mT3B0LnZpZXcueC5tYXgpIHtcblxuICAgICAgICAgICAgICAgIHZhciByZXBsYWNlWCA9IGdyYXBoT3B0LmVxdWF0aW9uLnJlcGxhY2UoXCJ4XCIsIGAoJHtyb3VuZGl0fSlgKSxcbiAgICAgICAgICAgICAgICAgICAgeXZhbCA9IG1hdGguZXZhbChyZXBsYWNlWCksXG4gICAgICAgICAgICAgICAgICAgIGlucHV0Q29vciA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIHBvaW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogcm91bmRpdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHl2YWwudG9GaXhlZChwcm9mT3B0LnJvdW5kaW5nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlRXF1OiBwcm9mT3B0LmVxdWF0aW9uLnJlcGxhY2UoXCJ4XCIsIGAoJHtyb3VuZGl0fSlgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBvaW50OiB4TWVtb3J5W2ldICE9PSByb3VuZGl0LFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogJChcIiNudW1Db250YWluZXIgcFwiKS5nZXQoaSlcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgQ2xlYXIgb3V0IHRoZSBZcyB3aGVuIHRoZXkgZG9uJ3QgZXF1YWwgZWFjaCBvdGhlciBhbmQgbmVlZCB0byBiZSB1cGRhdGVkXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAocG9pbnQudXBkYXRlUG9pbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgJChgdGQjeXZhbCR7aSArIDF9YCkuaHRtbChcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKlVwZGF0ZSB0aGUgeG1lbW9yeSovXG4gICAgICAgICAgICAgICAgeE1lbW9yeVtpXSA9IHJvdW5kaXQ7XG4gICAgICAgICAgICAgICAgYW5pU2V0dGluZ3MuZGF0YXBvaW50cy5wdXNoKHBvaW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vKlxuU2V0IGFsbCB0aGUgZGF0YSB0aGF0IHdpbGwgYmUgc2V0IHRvIGFuaVNldHRpbmdzIGluIHRoZSBzZXRVcE9iamVjdCBmdW5jdGlvblxuXG5OT1RFXG5ncmFwaE9wdC5jYWxsYmFjayBzdGlsbCBuZWVkcyBhIHZpYWJsZSBtZXRob2QhXG4qL1xuZnVuY3Rpb24gc3RhcnRGdW5jTWFjaCgpIHtcblxuICAgIHZhciB4aW5wdXRzID0gJChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxuICAgICAgICBoaWRlQW5pbWF0aW9uQ2hlY2tlZCA9ICQoXCIjYW5pbWF0ZTpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXG4gICAgICAgIGhpZGVHcmFwaENoZWNrZWQgPSAkKFwiI3Nob3dHcmFwaDpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXG4gICAgICAgIGdyYXBoT3B0ID0ge1xuICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLnVwZGF0ZVBvaW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCduZXh0OicsIGFuaVNldHRpbmdzLmN1cnJlbnRSb3VuZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYW5pbWF0ZUhpZGU6IGhpZGVBbmltYXRpb25DaGVja2VkLFxuICAgICAgICAgICAgZ3JhcGhIaWRlOiBoaWRlR3JhcGhDaGVja2VkLFxuICAgICAgICAgICAgZXF1YXRpb246IHByb2ZPcHQuZXF1YXRpb24sXG4gICAgICAgICAgICB2aWV3OiBwcm9mT3B0LnZpZXdcbiAgICAgICAgfSxcbiAgICAgICAgYW5pU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBkYXRhcG9pbnRzOiBbXSxcbiAgICAgICAgICAgIGN1cnJlbnRSb3VuZDogMCxcbiAgICAgICAgICAgIGdyYXBoT3B0OiBncmFwaE9wdFxuICAgICAgICB9O1xuXG4gICAgc2V0VXBPYmplY3QoeGlucHV0cywgZ3JhcGhPcHQsIGFuaVNldHRpbmdzKTtcblxuICAgIC8qU2V0IHVwIHRoZSBncmFwaCovXG4gICAgLy8gICAgcGxvdEdyYXBoLnNldHVwKGFuaVNldHRpbmdzLCBcIiNncmFwaFwiKTtcblxuICAgIGFuaW1hdG9yQ29udHJvbChhbmlTZXR0aW5ncyk7XG59XG5cbi8qXG5GdW5jdGlvbiB0byBzZWxlY3QgdGhlIGNob3NlbiBlcXVhdGlvbiB3aXRoIGl0cyBuYW1lIGFuZCBncmFwaCB3aW5kb3cgYm91bmRhcmllcy5cbiovXG5mdW5jdGlvbiBjaGVja0NvbmZpZyh2YWwpIHtcbiAgICB2YXIgcHJvZk9wdDtcbiAgICAkLmVhY2gocHJvZmVzc29yQ29uZmlnRmlsZSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uZXF1YXRpb24gPT09IHZhbCkge1xuICAgICAgICAgICAgcHJvZk9wdCA9IGl0ZW07XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBwcm9mT3B0O1xufVxuXG4vKlxuVXBvbiBjaG9vc2luZyBhbm90aGVyIGVxdWF0aW9uIHRvIGdyYXBoLCBjbGVhciBhbGwgdGhlIHZhbHVlc1xuKi9cbmZ1bmN0aW9uIGNsZWFyVmFsdWVzKCkge1xuICAgIHZhciB4aW5wdXRzID0gJChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxuICAgICAgICB5aW5wdXRzID0gJChgdHIgdGQ6bnRoLW9mLXR5cGUoMilgKTtcblxuICAgIHhpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICBpdGVtLnZhbHVlID0gXCJcIjtcbiAgICB9KTtcblxuICAgIHlpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xuICAgICAgICBpdGVtLmlubmVySFRNTCA9IFwiXCI7XG4gICAgfSk7XG59XG5cbi8qXG5PbmNoYW5nZSBldmVudCBoYW5kbGVyIGZvciB0aGUgc2VsZWN0IGh0bWwgZWxlbWVudC5cbiovXG4kKFwic2VsZWN0XCIpLmNoYW5nZShmdW5jdGlvbiAoZSkge1xuICAgIGNoYW5nZVBsb3QoZS50YXJnZXQudmFsdWUpO1xufSk7XG5cbi8qXG5ET0NVTUVOVCBrZXlkb3duIGV2ZW50IGhhbmRsZXJcbiovXG4kKGRvY3VtZW50KS5rZXlwcmVzcyhmdW5jdGlvbiAoZSkge1xuICAgIGlmIChlLndoaWNoID09IDEzICYmIHJ1bikge1xuICAgICAgICBzdGFydEZ1bmNNYWNoKCk7XG4gICAgfVxufSk7XG5cbi8qXG5HTyEgQ2xpY2sgZXZlbnQgaGFuZGxlclxuKi9cbiQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgIGlmIChydW4pIHtcbiAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xuICAgIH1cbn0pOyIsInZhciBlcXVQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI2VxdVwiKVswXSxcbiAgICBhbmlEdXJhdGlvbiA9IDI7XG5cbmZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgIC8qXG4gICAgVGhpcyBpcyBhIGZ1bmN0aW9uIGZhY3Rvcnkgd2hpY2ggd2lsbCBncmFiIHRoZVxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxuICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGFuaW1hdGlvbihhbmlTZXR0aW5ncykge1xuICAgICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgICAgdmFyIGRhdGFwb2ludCA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcbiAgICAgICAgICAgIG51bVBhcmEgPSBkYXRhcG9pbnQuZWxlbWVudDtcblxuICAgICAgICAvKlxuICAgICAgICBNYWtlIHRoZSBwcm9taXNlIHRoYXQgd2hlbiB0aGUgZHluYW1pY1xuICAgICAgICBhbmltYXRpb24gcGF0aCBpcyBkb25lIHRoZW4gdGhpcyBwcm9taXNlIGlzIGZpbmlzaGVkXG4gICAgICAgICovXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgJChudW1QYXJhKVxuICAgICAgICAgICAgICAgIC5odG1sKHZhbHVlKVxuICAgICAgICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcImFuaW1hdGlvblwiOiBgJHtuYW1lfSR7YW5pU2V0dGluZ3MuY3VycmVudFJvdW5kfSAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uZSgnYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gc3RhdHVzTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgLypcbiAgICBUaGlzIGlzIGEgZnVuY3Rpb24gZmFjdG9yeSB3aGljaCB3aWxsIGdyYWIgdGhlXG4gICAgbmVjZXNzYXJ5IGRhdGEgYW5kIHRoZW4gcmV0dXJuIHRoZSBmdW5jdGlvbiBwcm9taXNlXG4gICAgKi9cbiAgICB2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICBzdGF0dXNCYXIuaHRtbChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xuICAgICAgICB9KTtcblxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHJlcGxhY2VYRXF1KGFuaVNldHRpbmdzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvKlxuICAgIFJlcGxhY2UgdGhlIHggaW4gdGhlIGRpc2FwcGVhcmVkIGVxdWF0aW9uIHdpdGhvdXQgaGF2aW5nIHRoZSB5IGRpc2FwcGVhci5cbiAgICAqL1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAkKGVxdVBhcmEpXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNob3dFdmFsdWF0ZUVxdShhbmlTZXR0aW5ncykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLypcbiAgICBHZXQgdGhlIHkgYW5zd2VyIGFuZCB0aGUgeC1jaGFuZ2VkIGVxdWF0aW9uXG4gICAgKi9cbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxuICAgICAgICBjaGFuZ2VFcXUgPSBwb2ludERhdGEuY2hhbmdlRXF1O1xuXG4gICAgLypcbiAgICBTaG93IHRoZSBuZXcgZXF1YXRpb24gd2l0aCB0aGUgcmVwbGFjZWQgeC12YWx1ZSBlcXVhdGlvblxuICAgICovXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIGthdGV4LnJlbmRlcihgJHtjaGFuZ2VFcXV9YCwgZXF1UGFyYSk7XG5cbiAgICAgICAgJChlcXVQYXJhKVxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcbiAgICAgICAgICAgIH0pXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNob3dZQW5zKGFuaVNldHRpbmdzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvKlxuICAgIEdldCB0aGUgY3VycmVudCByb3VuZCBhbmQgY3VycmVudCBkYXRhIHBvaW50c1xuICAgICovXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcblxuICAgIC8qXG4gICAgQW5pbWF0ZSB0aGUgbmV3IHkgdmFsdWUgdG8gdGhlIGNvb3JkaW5hdGVkIHkgY29sdW1uIGFuZCBvbmNlXG4gICAgYW5pbWF0aW9uIGlzIGRvbmUgdGhlbiByZXR1cm4gdGhlIHByb21pc2VcbiAgICAqL1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAkKGVxdVBhcmEpXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3BvaW50RGF0YS55fWAsIGVxdVBhcmEpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8qXG5TaG93IHRoZSBjaG9zZW4gZXF1YXRpb24gdG8gZ3JhcGhcbiovXG5mdW5jdGlvbiBzaG93RXF1YXRpb25BZ2FpbihhbmlTZXR0aW5ncykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAkKGVxdVBhcmEpXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8qXG5PbmNlIHRoZSB5LXZhbHVlIGFwcGVhcnMgaW4gdGhlIGNvcnJlY3QgeS1jb2x1bW4gdGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlLlxuKi9cbmZ1bmN0aW9uIHBsYWNlWVZhbHVlKGFuaVNldHRpbmdzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgdmFyIGlucHV0ID0gJChgdGQjeXZhbCR7cG9pbnREYXRhLmlkICsgMX1gKVswXTtcbiAgICAgICAgJChpbnB1dCkuaHRtbChcIlwiKTtcbiAgICAgICAgJChpbnB1dCkuYXBwZW5kKGA8cD4ke3BvaW50RGF0YS55fTwvcD5gKTtcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgfSk7XG59XG5cbi8qXG5PbmNlIHRoZSBlcXVhdGlvbiBpcyBjbGVhcmVkIGFuZCByZXNldCB0byB0aGUgZGVmYXVsdCBlcXVhdGlvblxudGhlbiBmdWxmaWxsIHRoZSBwcm9taXNlXG4qL1xuZnVuY3Rpb24gcmVzZXRSb3VuZChhbmlTZXR0aW5ncykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4vLyAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICQoZXF1UGFyYSlcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMCk7XG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3Byb2ZPcHQuZXF1YXRpb259YCwgZXF1UGFyYSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuLypcblJldHVybiB0byBkZWZhdWx0IGJlZ2lubmluZyBlcXVhdGlvbiBmb3IgdGhlIG5leHQgYW5pbWF0aW9uIG9yIGZvciB0aGUgZW5kXG4qL1xuZnVuY3Rpb24gc2hvd0RlZmF1bHRFcXUoYW5pU2V0dGluZ3MpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgJChlcXVQYXJhKVxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG4vKlxuQWNjZXB0IHRoZSBkYXRhcG9pbnQgYW5kIGl0cyBpdGVyYXRvciBhbmQgcGxvdCB0aGF0IHBvaW50IGJlaW5nIHBhc3NlZCB0aHJvdWdoXG4qL1xuZnVuY3Rpb24gcGxvdHRlcihhbmlTZXR0aW5ncykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XG4gICAgXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIHBsb3RHcmFwaC51cGRhdGUoYW5pU2V0dGluZ3MsIGFuaVNldHRpbmdzLmdyYXBoT3B0LmNhbGxiYWNrKTtcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgfSk7XG59XG5cbi8qXG5UaGlzIGZ1bmN0aW9uIGFjdHMgYXMgYW4gaXRlcmF0b3Igc28gdGhhdCB0aGUgcHJvbWlzZSBjaGFpbiBrbm93cyB3aGljaFxuZGF0YXBvaW50IHRvIGhhbmRsZSBhbmQgdG8gYW5pbWF0ZVxuKi9cbmZ1bmN0aW9uIHVwZGF0ZVJvdW5kKGFuaVNldHRpbmdzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgcGxhY2Vob2xkZXIgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kICs9IDE7XG4gICAgICAgIHBsYWNlaG9sZGVyLnVwZGF0ZVBvaW50ID0gZmFsc2U7XG5cbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgfSk7XG59O1xuXG4vKlxuVHdvIGZ1bmN0aW9ucyBpbiBvcmRlciB0byByZXBsYWNlIHRoZSBmdW5jdGlvbiBtYWNoaW5lIGdpZiB3aXRoIHRoZSBhbmltYXRlZFxuZ2lmIGFuZCBiYWNrd2FyZHMuXG4qL1xuZnVuY3Rpb24gYW5pbWF0ZUZ1bmNNYWNoaW5lKGFuaVNldHRpbmdzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICQoXCIjZnVuY3Rpb25NYWNoaW5lXCIpLmNzcyh7XG4gICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoLi4vaW1nL2Z1bmN0aW9uTWFjaGluZUFuaS5naWYpXCJcbiAgICAgICAgfSlcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncylcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc3RvcEFuaUZ1bmNNYWNoaW5lKGFuaVNldHRpbmdzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICQoXCIjZnVuY3Rpb25NYWNoaW5lXCIpLmNzcyh7XG4gICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoLi4vaW1nL2Z1bmN0aW9uTWFjaGluZVN0aWxsLmdpZilcIlxuICAgICAgICB9KVxuICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKVxuICAgIH0pO1xufVxuXG4vKlxuQSBmdW5jdGlvbiB0byBzaG93IHRoZSB5IGFuc3dlciBsZWF2aW5nIHRoZSBmdW5jdGlvbiBtYWNoaW5lIHRvXG5zdGFydCB0aGUgbmV4dCBhbmltYXRpb24gb2YgZ29pbmcgYmFjayB0byB0aGUgeSBjb2x1bW4uXG4qL1xuZnVuY3Rpb24gbWluaUFuaShhbmlTZXR0aW5ncykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuXG4gICAgICAgIHZhciBwbGFjZWhvbGRlciA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXSxcbiAgICAgICAgICAgIHl2YWx1ZSA9IHBsYWNlaG9sZGVyLnksXG4gICAgICAgICAgICBwYXJhID0gJChgPHA+JHt5dmFsdWV9PC9wPmApO1xuXG4gICAgICAgICQoXCJib2R5XCIpLmFwcGVuZChwYXJhKTtcblxuICAgICAgICBwYXJhXG4gICAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgICAgICAgbGVmdDogNTUwLFxuICAgICAgICAgICAgICAgIHRvcDogNTBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICB0b3A6IDEwMFxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBwYXJhLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwibm9uZVwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuLypcbkEgcHJvbWlzZSBjaGFpbiB0byBydW4gdGhyb3VnaCB0aGUgd2hvbGUgYW5pbWF0aW9uIHByb2Nlc3NcblxuTk9URVxuQSBwcm9taXNlIGNoYWluIGhhcyBiZWVuIHV0aXppbGVkIGluIG9yZGVyIHRvIGVhc2lseSBwbHVnaW5cbmV4dHJhIGZ1bmN0aW9ucyB0aGF0IHdvdWxkIGJlIGdyZWF0IHRvIGhhdmUgaW4gdGhlIGFuaW1hdGlvblxucHJvY2Vzcy4gIEEgcHJvbWlzZSBjaGFpbiBoYXMgYWxzbyBiZWVuIHVzZWQgaW4gb3JkZXIgdG8gd2FpdFxuZm9yIGEgYW5pbWF0aW9uIHRvIGVuZCB0byBzdGFydCB0aGUgbmV4dCBhbmltYXRpb24uXG4qL1xuXG5mdW5jdGlvbiBhbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xuICAgIFxuICAgIHBsb3RHcmFwaC5zZXR1cChkcHMsIFwiI2dyYXBoXCIpO1xuICAgIFxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBjaGFpbiA9IGNoYWluXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieFRvTWFjaGluZVwiLCBkYXRhcG9pbnQueCkpXG4gICAgICAgICAgICAgICAgLnRoZW4oYW5pbWF0ZUZ1bmNNYWNoaW5lKVxuICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoXCJDYWxjdWxhdGluZ1wiKSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXBsYWNlWEVxdSlcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RXZhbHVhdGVFcXUpXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd1lBbnMpXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvd0VxdWF0aW9uQWdhaW4pXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RvcEFuaUZ1bmNNYWNoaW5lKVxuICAgICAgICAgICAgICAgIC50aGVuKG1pbmlBbmkpXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwibWFjaGluZVRvWVwiLCBkYXRhcG9pbnQueSkpXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXG4gICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieVRvU3RhdHVzQmFyXCIsIGAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShgUGxvdHRpbmcgKCR7ZGF0YXBvaW50Lnh9LCR7ZGF0YXBvaW50Lnl9KWApKVxuICAgICAgICAgICAgICAgIC50aGVuKHBsb3R0ZXIpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzZXRSb3VuZClcbiAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBgKSlcbiAgICAgICAgICAgICAgICAudGhlbihzaG93RGVmYXVsdEVxdSk7XG4gICAgICAgIH1cbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcbiAgICB9KTtcbn1cblxuLypcbklmIHRoZSBcIkhpZGUgQW5pbWF0aW9uXCIgY2hlY2tib3ggaXMgY2hlY2tlZCB0aGVuIHNraXAgdGhlIHdob2xlIGFuaW1hdGlvblxucHJvbWlzZSBjaGFpbiBhbmQganVzdCBhcHBlbmQgdGhlIHkgdmFsdWVzXG4qL1xuZnVuY3Rpb24gbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xuICAgICAgICBpZiAoZGF0YXBvaW50LnVwZGF0ZVBvaW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBjaGFpbiA9IGNoYWluXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxvdHRlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcbiAgICB9KTtcbn1cblxuLypcbkhhbmRsZSBhbGwgQ1NTIGFuaW1hdGlvbnMgYnkgY3JlYXRpbmcgYSBQcm9taXNlIGNoYWluIHRocm91Z2ggYSBmb3IgbG9vcC5cbiovXG5mdW5jdGlvbiBhbmltYXRvckNvbnRyb2woZHBzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgbnVtQ29udGFpbmVyID0gJChcIiNudW1Db250YWluZXJcIiksXG4gICAgICAgIGNoYWluID0gUHJvbWlzZS5yZXNvbHZlKGRwcyk7XG5cbiAgICBudW1Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcblxuICAgIGlmIChkcHMuZ3JhcGhPcHQuYW5pbWF0ZUhpZGUpIHtcbiAgICAgICAgbm9BbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
