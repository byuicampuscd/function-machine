"use strict";!function(){for(var t,a,d,p,r=$("tbody"),n=19,e=1;e<=n;e++)p=$("<input>"),t=$("<td></td>"),a=$("<td></td>"),d=$("<tr></tr>"),$(d).attr("id","row"+e),$(p).attr("name","input"+e).attr("type","number"),$(a).attr("id","yval"+e),$(t).append(p),$(d).append(t).append(a),$(r).append(d)}();
"use strict";$(document).ready(function(){function n(n){var o=$("<option></option>").append(n.name);$(o).val(n.equation),$("select").append(o)}var o=location.search.substring(1),t=o.split("=")[1]+".json";$.getJSON(t,function(o){window.professorConfigFile=o,$.each(o,function(o,t){n(t),0===o&&changePlot(t.equation)})})});
"use strict";function stairStep(t){var n=246.5;lastSheet.insertRule("@keyframes "+t.name+" {\n                            0% {\n                                opacity: 1;\n                                top: "+t.startTopOff+"px;\n                                left: "+t.startLeftOff+"px;\n                            }\n                            10% {\n                                opacity: 1;\n                            }\n                            33% {\n                                top: "+t.startTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            66% {\n                                top: "+t.endTopOff+"px;\n                                left: "+n+"px;\n                            }\n                            90% {\n                                opacity: 1;\n                            }\n                            100% {\n                                opacity: 0;\n                                top: "+t.endTopOff+"px;\n                                left: "+t.endLeftOff+"px;\n                            }\n                        }",lastSheet.cssRules.length)}function makeXToMachine(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.left+30,endTopOff:55,endLeftOff:300,name:"xToMachine"+n})}function makeMachineToY(t,n){stairStep({startTopOff:55,startLeftOff:300,endTopOff:t.top+5,endLeftOff:t.right+5,name:"machineToY"+n})}function makeYToStatusBar(t,n){stairStep({startTopOff:t.top+5,startLeftOff:t.right+10,endTopOff:150,endLeftOff:300,name:"yToStatusBar"+n})}function startFuncMach(){var t=$("input[type='number']"),n=$("#animate:checked").length>0,e=$("#showGraph:checked").length>0,o={callback:function(t){return new Promise(function(n){console.log("finished plotting datapoint!"),n(t)})},animateHide:n,graphHide:e,equation:profOpt.equation,view:profOpt.view},a={datapoints:[],currentRound:0,graphOpt:o};t.each(function(t){var n,e=$(this).val();if(e&&(n=+e,profOpt.view.x.min<=n&&n<=profOpt.view.x.max)){var i=o.equation.replace("x","("+n+")"),p=math.eval(i),u=(this.getBoundingClientRect(),{x:n,y:p,id:t,changeEqu:profOpt.equation.replace("x","("+n+")"),updatePoint:xMemory[t]!==n,element:$("#numContainer p").get(t)});u.updatePoint&&$("td#yval"+(t+1)).html(""),xMemory[t]=n,a.datapoints.push(u)}}),animatorControl(a)}function checkConfig(t){var n;return $.each(professorConfigFile,function(e,o){o.equation===t&&(n=o)}),n}function clearValues(){var t=$("input[type='number']"),n=$("tr td:nth-of-type(2)");t.each(function(t,n){n.value=""}),n.each(function(t,n){n.innerHTML=""})}function changePlot(t){xMemory=[],clearValues(),window.profOpt=checkConfig(t);var n="y = ",e=""+t,o=$("#functionMachine #equ")[0],a=$("#functionMachine #y");$(o).empty(""),katex.render(n,a[0]),katex.render(e,o)}for(var xMemory=[],inputs=document.querySelectorAll("input[type='number']"),inputCount=inputs.length,lastSheet=document.styleSheets[document.styleSheets.length-1],i=0;i<inputCount;i++){xMemory[i]=null;var inputCoor=inputs[i].getBoundingClientRect();makeXToMachine(inputCoor,i),makeMachineToY(inputCoor,i),makeYToStatusBar(inputCoor,i),$("#numContainer").append($("<p></p>"))}for(var inputs=document.querySelectorAll("input[type='number']"),run=!0,i=0;i<inputs.length;i++)inputs[i].oninput=function(t){var n=t.srcElement.value;profOpt.view.x.min<=n&&n<=profOpt.view.x.max?(run=!0,$("input[type='button'][value='Go!']").prop("disabled",!1),console.log("Validated!")):(run=!1,$("input[type='button'][value='Go!']").prop("disabled",!0),$("#status p").html("<p>"+n+" x-value out of domains.</p>"),console.log("Not Validated!"))};$("select").change(function(t){changePlot(t.target.value)}),$(document).keypress(function(t){13==t.which&&run&&startFuncMach()}),$("input[type='button'][value='Go!']").click(function(){startFuncMach()});
"use strict";function runAnimation(n,t){return function(a){var e=a.datapoints[a.currentRound],i=e.element;return new Promise(function(e){$(i).html(t).css({animation:""+n+a.currentRound+" "+aniDuration+"s ease-in-out"}).one("animationend",function(n){e(a)})})}}function statusMessage(n){return function(t){return new Promise(function(a){statusBar.html("<p>"+n+"</p>"),a(t)})}}function replaceXEqu(n){return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),t(n)})})}function showEvaluateEqu(n){var t=n.datapoints[n.currentRound],a=t.changeEqu;return new Promise(function(t){katex.render(""+a,equPara),$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function showYAns(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(){$(equPara).css("opacity",0),katex.render(""+t.y,equPara),a(n)})})}function showEquationAgain(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function placeYValue(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){var e=$("td#yval"+(t.id+1))[0];$(e).html(""),$(e).append("<p>"+t.y+"</p>"),a(n)})}function resetRound(n){n.datapoints[n.currentRound];return new Promise(function(t){$(equPara).css("animation","textDisappear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",0),katex.render(""+profOpt.equation,equPara),t(n)})})}function showDefaultEqu(n){return new Promise(function(t){$(equPara).css("animation","textAppear "+aniDuration+"s ease-in-out").one("animationend",function(a){$(equPara).css("opacity",1),t(n)})})}function plotter(n){n.datapoints[n.currentRound];return new Promise(function(t){n.graphOpt.callback(),t(n)})}function updateRound(n){var t=n.datapoints[n.currentRound];return new Promise(function(a){n.currentRound+=1,t.updatePoint=!1,a(n)})}function aniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(runAnimation("xToMachine",n.x)).then(statusMessage("Calculating")).then(replaceXEqu).then(showEvaluateEqu).then(showYAns).then(showEquationAgain).then(runAnimation("machineToY",n.y)).then(placeYValue).then(runAnimation("yToStatusBar","("+n.x+","+n.y+")")).then(statusMessage("Plotting ("+n.x+","+n.y+")")).then(plotter).then(resetRound).then(statusMessage("")).then(showDefaultEqu)),t=t.then(updateRound)})}function noAniPromiseChain(n,t){n.datapoints.forEach(function(n){n.updatePoint===!0&&(t=t.then(placeYValue).then(plotter)),t=t.then(updateRound)})}function animatorControl(n){var t=$("#numContainer"),a=Promise.resolve(n);t.innerHTML="",n.graphOpt.animateHide?noAniPromiseChain(n,a):aniPromiseChain(n,a)}var statusBar=$("#status p"),lastSheet=document.styleSheets[document.styleSheets.length-1],equPara=$("#functionMachine #equ")[0],aniDuration=1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhamF4LmpzIiwiZXZlbnRzLmpzIiwiYW5pbWF0b3Jjb250cm9sLmpzIl0sIm5hbWVzIjpbInRkMSIsInRkMiIsInRyIiwiaW5wdXQiLCJ0Ym9keSIsIiQiLCJyb3dDb3VudCIsImoiLCJhdHRyIiwiYXBwZW5kIiwiZG9jdW1lbnQiLCJyZWFkeSIsInNob3dQcm9mT3B0aW9ucyIsImZpZWxkIiwib3B0IiwibmFtZSIsInZhbCIsImVxdWF0aW9uIiwicXVlcnlTdHJpbmciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5Iiwic3BsaXQiLCJnZXRKU09OIiwicmVzdWx0Iiwid2luZG93IiwicHJvZmVzc29yQ29uZmlnRmlsZSIsImVhY2giLCJpIiwiY2hhbmdlUGxvdCIsInN0YWlyU3RlcCIsIm9wdGlvbnMiLCJoaWdod2F5UGF0aCIsImxhc3RTaGVldCIsImluc2VydFJ1bGUiLCJzdGFydFRvcE9mZiIsInN0YXJ0TGVmdE9mZiIsImVuZFRvcE9mZiIsImVuZExlZnRPZmYiLCJjc3NSdWxlcyIsImxlbmd0aCIsIm1ha2VYVG9NYWNoaW5lIiwiaW5wdXRDb3JkcyIsImluZGV4IiwidG9wIiwibGVmdCIsIm1ha2VNYWNoaW5lVG9ZIiwicmlnaHQiLCJtYWtlWVRvU3RhdHVzQmFyIiwic3RhcnRGdW5jTWFjaCIsInhpbnB1dHMiLCJoaWRlQW5pbWF0aW9uQ2hlY2tlZCIsImhpZGVHcmFwaENoZWNrZWQiLCJncmFwaE9wdCIsImNhbGxiYWNrIiwiYW5pU2V0dGluZ3MiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvbnNvbGUiLCJsb2ciLCJhbmltYXRlSGlkZSIsImdyYXBoSGlkZSIsInByb2ZPcHQiLCJ2aWV3IiwiZGF0YXBvaW50cyIsImN1cnJlbnRSb3VuZCIsInh2YWwiLCJ4dmFsdWUiLCJ0aGlzIiwieCIsIm1pbiIsIm1heCIsInJlcGxhY2VYIiwicmVwbGFjZSIsInl2YWwiLCJtYXRoIiwiZXZhbCIsInBvaW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieSIsImlkIiwiY2hhbmdlRXF1IiwidXBkYXRlUG9pbnQiLCJ4TWVtb3J5IiwiZWxlbWVudCIsImdldCIsImh0bWwiLCJwdXNoIiwiYW5pbWF0b3JDb250cm9sIiwiY2hlY2tDb25maWciLCJpdGVtIiwiY2xlYXJWYWx1ZXMiLCJ5aW5wdXRzIiwidmFsdWUiLCJpbm5lckhUTUwiLCJlcXVhdCIsImVxdVBhcmEiLCJ5UGFyYSIsImVtcHR5Iiwia2F0ZXgiLCJyZW5kZXIiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRDb3VudCIsInN0eWxlU2hlZXRzIiwiaW5wdXRDb29yIiwicnVuIiwib25pbnB1dCIsImUiLCJ4SW5wdXRWYWwiLCJzcmNFbGVtZW50IiwicHJvcCIsImNoYW5nZSIsInRhcmdldCIsImtleXByZXNzIiwid2hpY2giLCJjbGljayIsInJ1bkFuaW1hdGlvbiIsImRhdGFwb2ludCIsIm51bVBhcmEiLCJjc3MiLCJhbmltYXRpb24iLCJhbmlEdXJhdGlvbiIsIm9uZSIsInN0YXR1c01lc3NhZ2UiLCJtZXNzYWdlIiwic3RhdHVzQmFyIiwicmVwbGFjZVhFcXUiLCJkYXRhIiwic2hvd0V2YWx1YXRlRXF1IiwicG9pbnREYXRhIiwic2hvd1lBbnMiLCJzaG93RXF1YXRpb25BZ2FpbiIsInBsYWNlWVZhbHVlIiwicmVzZXRSb3VuZCIsInNob3dEZWZhdWx0RXF1IiwicGxvdHRlciIsInVwZGF0ZVJvdW5kIiwicGxhY2Vob2xkZXIiLCJhbmlQcm9taXNlQ2hhaW4iLCJkcHMiLCJjaGFpbiIsImZvckVhY2giLCJ0aGVuIiwibm9BbmlQcm9taXNlQ2hhaW4iLCJudW1Db250YWluZXIiXSwibWFwcGluZ3MiOiJBQUFBLGNBQUMsV0FhRyxJQUFLLEdBTkRBLEdBQ0FDLEVBQ0FDLEVBQ0FDLEVBSkFDLEVBQVFDLEVBQUUsU0FLVkMsRUFBVyxHQUVOQyxFQUFJLEVBQUdBLEdBQUtELEVBQVVDLElBQzNCSixFQUFRRSxFQUFFLFdBQ1ZMLEVBQU1LLEVB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ZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIE1ha2UgdGhlIHdob2xlIHRhYmxlIGFuZCBjZWxscyBmb3IgdGhlIGlucHV0IGJveGVzIGFuZCB1c2VyIGludGVyYWN0aW9uLlxyXG4gICAgKi9cclxuICAgIHZhciB0Ym9keSA9ICQoXCJ0Ym9keVwiKSxcclxuICAgICAgICB0ZDEsXHJcbiAgICAgICAgdGQyLFxyXG4gICAgICAgIHRyLFxyXG4gICAgICAgIGlucHV0LFxyXG4gICAgICAgIHJvd0NvdW50ID0gMTk7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gcm93Q291bnQ7IGorKykge1xyXG4gICAgICAgIGlucHV0ID0gJChcIjxpbnB1dD5cIik7XHJcbiAgICAgICAgdGQxID0gJChcIjx0ZD48L3RkPlwiKTtcclxuICAgICAgICB0ZDIgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG4gICAgICAgIHRyID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHJcbiAgICAgICAgJCh0cikuYXR0cihcImlkXCIsIGByb3cke2p9YCk7XHJcblxyXG4gICAgICAgICQoaW5wdXQpLmF0dHIoXCJuYW1lXCIsIGBpbnB1dCR7an1gKS5hdHRyKFwidHlwZVwiLCBcIm51bWJlclwiKTtcclxuXHJcbiAgICAgICAgJCh0ZDIpLmF0dHIoXCJpZFwiLCBgeXZhbCR7an1gKTtcclxuXHJcbiAgICAgICAgJCh0ZDEpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgJCh0cikuYXBwZW5kKHRkMSkuYXBwZW5kKHRkMik7XHJcbiAgICAgICAgJCh0Ym9keSkuYXBwZW5kKHRyKTtcclxuICAgIH1cclxufSgpKTtcclxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIFF1ZXJ5IHN1YnN0cmluZ1xyXG4gICAgKi9cclxuICAgIHZhciBxdWVyeVN0cmluZyA9IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSksXHJcbiAgICAgICAgcXVlcnkgPSBxdWVyeVN0cmluZy5zcGxpdChcIj1cIilbMV0gKyBcIi5qc29uXCI7XHJcblxyXG4gICAgZnVuY3Rpb24gc2hvd1Byb2ZPcHRpb25zKGZpZWxkKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBBcHBlbmQgdGhlIHByb2Zlc3NvcidzIGNob3NlbiBlcXVhdGlvbnMgdG8gdGhlIGFwcGxpY2F0aW9uXHJcbiAgICAgICAgKi9cclxuXHJcbiAgICAgICAgdmFyIG9wdCA9ICQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hcHBlbmQoZmllbGQubmFtZSk7XHJcblxyXG4gICAgICAgICQob3B0KS52YWwoZmllbGQuZXF1YXRpb24pO1xyXG5cclxuICAgICAgICAkKFwic2VsZWN0XCIpLmFwcGVuZChvcHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBMb2FkIHRoZSBwcm9mZXNzb3IgY29uZmlndXJhdGlvbiBmaWxlXHJcbiAgICAqL1xyXG5cclxuICAgICQuZ2V0SlNPTihxdWVyeSwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZmVzc29yQ29uZmlnRmlsZSA9IHJlc3VsdDtcclxuXHJcbiAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGksIGZpZWxkKSB7XHJcblxyXG4gICAgICAgICAgICBzaG93UHJvZk9wdGlvbnMoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgRGlzcGxheSB0aGUgZGVmYXVsdCBlcXVhdGlvbiB0byB0aGUgZnVuY3Rpb24gbWFjaGluZVxyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVBsb3QoZmllbGQuZXF1YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxufSk7XHJcbiIsIiAgICB2YXIgeE1lbW9yeSA9IFtdLFxyXG4gICAgICAgIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICBpbnB1dENvdW50ID0gaW5wdXRzLmxlbmd0aCxcclxuICAgICAgICBsYXN0U2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGggLSAxXTtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0aW9uIHBhdGggZm9yIHRoZSBzdGFpcnN0ZXBcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdGFpclN0ZXAob3B0aW9ucykge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHZhciBoaWdod2F5UGF0aCA9IDI0Ni41O1xyXG4gICAgICAgIGxhc3RTaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7b3B0aW9ucy5uYW1lfSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke29wdGlvbnMuc3RhcnRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMzMlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5zdGFydFRvcE9mZn1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke2hpZ2h3YXlQYXRofXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNjYlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7b3B0aW9ucy5lbmRUb3BPZmZ9cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHtoaWdod2F5UGF0aH1weDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDkwJSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCUge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAke29wdGlvbnMuZW5kVG9wT2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICR7b3B0aW9ucy5lbmRMZWZ0T2ZmfXB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9YCwgbGFzdFNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIEEgc2V0IG9mIGZ1bmN0aW9ucyB1c2luZyB0aGUgc3RhaXJzdGVwIGFuaW1hdGlvbiB0ZW1wbGF0ZVxyXG4gICAgdG8gY3JlYXRlIHBhdGh3YXlzIHdpdGggY29vcmRpbmF0ZSBkYXRhXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWFrZVhUb01hY2hpbmUoaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogaW5wdXRDb3Jkcy50b3AgKyA1LFxyXG4gICAgICAgICAgICBzdGFydExlZnRPZmY6IGlucHV0Q29yZHMubGVmdCArIDMwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDU1LFxyXG4gICAgICAgICAgICBlbmRMZWZ0T2ZmOiAzMDAsXHJcbiAgICAgICAgICAgIG5hbWU6IGB4VG9NYWNoaW5lJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZU1hY2hpbmVUb1koaW5wdXRDb3JkcywgaW5kZXgpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBzdGFpclN0ZXAoe1xyXG4gICAgICAgICAgICBzdGFydFRvcE9mZjogNTUsXHJcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IGlucHV0Q29yZHMudG9wICsgNSxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDUsXHJcbiAgICAgICAgICAgIG5hbWU6IGBtYWNoaW5lVG9ZJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZVlUb1N0YXR1c0JhcihpbnB1dENvcmRzLCBpbmRleCkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHN0YWlyU3RlcCh7XHJcbiAgICAgICAgICAgIHN0YXJ0VG9wT2ZmOiBpbnB1dENvcmRzLnRvcCArIDUsXHJcbiAgICAgICAgICAgIHN0YXJ0TGVmdE9mZjogaW5wdXRDb3Jkcy5yaWdodCArIDEwLFxyXG4gICAgICAgICAgICBlbmRUb3BPZmY6IDE1MCxcclxuICAgICAgICAgICAgZW5kTGVmdE9mZjogMzAwLFxyXG4gICAgICAgICAgICBuYW1lOiBgeVRvU3RhdHVzQmFyJHtpbmRleH1gXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIFNldCB1cCB0aGUgeE1lbW9yeSBhcnJheSBhbmQgdGhlIGFuaW1hdGlvbiBwYXRocyBmb3IgZWFjaCBpbnB1dCBib3guXHJcblxyXG4gICAgTk9URTogU2V0dGluZyB1cCB0aGUgeE1lbW9yeSBhcnJheSBhbHNvIG1ha2VzIGl0IHNvIHRoYXQgbm8gYW5pbWF0aW9uc1xyXG4gICAgICAgICAgYXJlIHJlcGVhdGVkIGJ5IG11bHRpcGxlIGNsaWNrcyBvbiB0aGUgXCJHbyFcIiBidXR0b24uXHJcbiAgICAqL1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dENvdW50OyBpKyspIHtcclxuICAgICAgICB4TWVtb3J5W2ldID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGlucHV0Q29vciA9IGlucHV0c1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgbWFrZVhUb01hY2hpbmUoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICBtYWtlTWFjaGluZVRvWShpbnB1dENvb3IsIGkpO1xyXG4gICAgICAgIG1ha2VZVG9TdGF0dXNCYXIoaW5wdXRDb29yLCBpKTtcclxuICAgICAgICAkKFwiI251bUNvbnRhaW5lclwiKS5hcHBlbmQoJChgPHA+PC9wPmApKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgU2V0IGFsbCB0aGUgZGF0YSB0byBhbiBhcnJheSBvZiBvYmplY3RzIHRvIGJlIGl0ZXJhdGVkXHJcbiAgICBvdmVyIGJ5IHRoZSBwcm9taXNlIGNoYWluIGluIGFuaW1hdG9yY29udHJvbC5qc1xyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIHN0YXJ0RnVuY01hY2goKSB7XHJcblxyXG4gICAgICAgIHZhciB4aW5wdXRzID0gJChcImlucHV0W3R5cGU9J251bWJlciddXCIpLFxyXG4gICAgICAgICAgICBoaWRlQW5pbWF0aW9uQ2hlY2tlZCA9ICQoXCIjYW5pbWF0ZTpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGhpZGVHcmFwaENoZWNrZWQgPSAkKFwiI3Nob3dHcmFwaDpjaGVja2VkXCIpLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgICAgIGdyYXBoT3B0ID0ge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChhbmlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmlzaGVkIHBsb3R0aW5nIGRhdGFwb2ludCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGFuaW1hdGVIaWRlOiBoaWRlQW5pbWF0aW9uQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoSGlkZTogaGlkZUdyYXBoQ2hlY2tlZCxcclxuICAgICAgICAgICAgICAgIGVxdWF0aW9uOiBwcm9mT3B0LmVxdWF0aW9uLFxyXG4gICAgICAgICAgICAgICAgdmlldzogcHJvZk9wdC52aWV3XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFuaVNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YXBvaW50czogW10sXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Um91bmQ6IDAsXHJcbiAgICAgICAgICAgICAgICBncmFwaE9wdDogZ3JhcGhPcHRcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgeGlucHV0cy5lYWNoKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgIHZhciB4dmFsdWUgPSAkKHRoaXMpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgeHZhbDtcclxuXHJcbiAgICAgICAgICAgIGlmICh4dmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHh2YWwgPSAreHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb2ZPcHQudmlldy54Lm1pbiA8PSB4dmFsICYmIHh2YWwgPD0gcHJvZk9wdC52aWV3LngubWF4KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXBsYWNlWCA9IGdyYXBoT3B0LmVxdWF0aW9uLnJlcGxhY2UoXCJ4XCIsIGAoJHt4dmFsfSlgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeXZhbCA9IG1hdGguZXZhbChyZXBsYWNlWCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0Q29vciA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogeHZhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHl2YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUVxdTogcHJvZk9wdC5lcXVhdGlvbi5yZXBsYWNlKFwieFwiLCBgKCR7eHZhbH0pYCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQb2ludDogeE1lbW9yeVtpXSAhPT0geHZhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6ICQoXCIjbnVtQ29udGFpbmVyIHBcIikuZ2V0KGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXIgb3V0IHRoZSBZcyB3aGVuIHRoZXkgZG9uJ3QgZXF1YWwgZWFjaCBvdGhlciBhbmQgbmVlZCB0byBiZSB1cGRhdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnQudXBkYXRlUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChgdGQjeXZhbCR7aSArIDF9YCkuaHRtbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8qVXBkYXRlIHRoZSB4bWVtb3J5Ki9cclxuICAgICAgICAgICAgICAgICAgICB4TWVtb3J5W2ldID0geHZhbDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYW5pU2V0dGluZ3MuZGF0YXBvaW50cy5wdXNoKHBvaW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYW5pbWF0b3JDb250cm9sKGFuaVNldHRpbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0Z1bmN0aW9uIHRvIHNlbGVjdCB0aGUgY2hvc2VuIGVxdWF0aW9uIHdpdGggaXRzIG5hbWUgYW5kIGdyYXBoIHdpbmRvdyBib3VuZGFyaWVzLlxyXG4gICAgZnVuY3Rpb24gY2hlY2tDb25maWcodmFsKSB7XHJcbiAgICAgICAgdmFyIHByb2ZPcHQ7XHJcbiAgICAgICAgJC5lYWNoKHByb2Zlc3NvckNvbmZpZ0ZpbGUsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmVxdWF0aW9uID09PSB2YWwpIHtcclxuICAgICAgICAgICAgICAgIHByb2ZPcHQgPSBpdGVtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gcHJvZk9wdDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbGVhclZhbHVlcygpIHtcclxuICAgICAgICB2YXIgeGlucHV0cyA9ICQoXCJpbnB1dFt0eXBlPSdudW1iZXInXVwiKSxcclxuICAgICAgICAgICAgeWlucHV0cyA9ICQoYHRyIHRkOm50aC1vZi10eXBlKDIpYCk7XHJcblxyXG4gICAgICAgIHhpbnB1dHMuZWFjaChmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICBpdGVtLnZhbHVlID0gXCJcIjtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgeWlucHV0cy5lYWNoKGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIGl0ZW0uaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvL0RpcHNsYXkgS2F0ZXggZXF1YXRpb25cclxuICAgIGZ1bmN0aW9uIGNoYW5nZVBsb3QodmFsKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgeE1lbW9yeSA9IFtdO1xyXG5cclxuICAgICAgICBjbGVhclZhbHVlcygpO1xyXG5cclxuICAgICAgICB3aW5kb3cucHJvZk9wdCA9IGNoZWNrQ29uZmlnKHZhbCk7XHJcblxyXG4gICAgICAgIHZhciB5ID0gYHkgPSBgLFxyXG4gICAgICAgICAgICBlcXVhdCA9IGAke3ZhbH1gLFxyXG4gICAgICAgICAgICBlcXVQYXJhID0gJChcIiNmdW5jdGlvbk1hY2hpbmUgI2VxdVwiKVswXSxcclxuICAgICAgICAgICAgeVBhcmEgPSAkKFwiI2Z1bmN0aW9uTWFjaGluZSAjeVwiKTtcclxuXHJcbiAgICAgICAgJChlcXVQYXJhKS5lbXB0eShcIlwiKTtcclxuXHJcbiAgICAgICAga2F0ZXgucmVuZGVyKHksIHlQYXJhWzBdKTtcclxuICAgICAgICBrYXRleC5yZW5kZXIoZXF1YXQsIGVxdVBhcmEpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT0nbnVtYmVyJ11cIiksXHJcbiAgICAgICAgcnVuID0gdHJ1ZTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlucHV0c1tpXS5vbmlucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciB4SW5wdXRWYWwgPSBlLnNyY0VsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChwcm9mT3B0LnZpZXcueC5taW4gPD0geElucHV0VmFsICYmIHhJbnB1dFZhbCA8PSBwcm9mT3B0LnZpZXcueC5tYXgpIHtcclxuICAgICAgICAgICAgICAgIHJ1biA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkKFwiaW5wdXRbdHlwZT0nYnV0dG9uJ11bdmFsdWU9J0dvISddXCIpLnByb3AoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlZhbGlkYXRlZCFcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBydW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzdGF0dXMgcFwiKS5odG1sKGA8cD4ke3hJbnB1dFZhbH0geC12YWx1ZSBvdXQgb2YgZG9tYWlucy48L3A+YCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdCBWYWxpZGF0ZWQhXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgIE9uY2hhbmdlIGV2ZW50IGhhbmRsZXIgZm9yIHRoZSBzZWxlY3QgaHRtbCBlbGVtZW50LlxyXG4gICAgKi9cclxuICAgICQoXCJzZWxlY3RcIikuY2hhbmdlKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgY2hhbmdlUGxvdChlLnRhcmdldC52YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgRE9DVU1FTlQga2V5ZG93biBldmVudCBoYW5kbGVyXHJcbiAgICAqL1xyXG4gICAgJChkb2N1bWVudCkua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS53aGljaCA9PSAxMyAmJiBydW4pIHtcclxuICAgICAgICAgICAgc3RhcnRGdW5jTWFjaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBHTyEgQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gICAgKi9cclxuICAgICQoXCJpbnB1dFt0eXBlPSdidXR0b24nXVt2YWx1ZT0nR28hJ11cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHN0YXJ0RnVuY01hY2goKTtcclxuICAgIH0pO1xyXG4iLCJ2YXIgc3RhdHVzQmFyID0gJChcIiNzdGF0dXMgcFwiKSxcclxuICAgIGxhc3RTaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2RvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCAtIDFdLFxyXG4gICAgZXF1UGFyYSA9ICQoXCIjZnVuY3Rpb25NYWNoaW5lICNlcXVcIilbMF0sXHJcbiAgICBhbmlEdXJhdGlvbiA9IDE7XHJcblxyXG4vL1RPRE86IEdldCB0aGUgZnVuY3Rpb24gbWFjaGluZSBpbiB0aGVyZS5cclxuLy9UT0RPOiBWYWxpZGF0ZSB4IHZhbHVlcyB3aXRoaW4gdGhlIHNldCBkb21haW4gb2YgdGhlIHByb2ZPcHRcclxuLy9UT0RPOiBDaGVjayBicm93c2VyIGNvbXBhdGliaWxpdHkgKFByb21pc2VzIGluIElFKS5cclxuXHJcbmZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiBhbmltYXRpb24oYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICB2YXIgZGF0YXBvaW50ID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgICAgICBudW1QYXJhID0gZGF0YXBvaW50LmVsZW1lbnQ7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgTWFrZSB0aGUgcHJvbWlzZSB0aGF0IHdoZW4gdGhlIGR5bmFtaWNcclxuICAgICAgICBhbmltYXRpb24gcGF0aCBpcyBkb25lIHRoZW4gdGhpcyBwcm9taXNlIGlzIGZpbmlzaGVkXHJcbiAgICAgICAgKi9cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgJChudW1QYXJhKVxyXG4gICAgICAgICAgICAgICAgLmh0bWwodmFsdWUpXHJcbiAgICAgICAgICAgICAgICAuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBcImFuaW1hdGlvblwiOiBgJHtuYW1lfSR7YW5pU2V0dGluZ3MuY3VycmVudFJvdW5kfSAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vbmUoJ2FuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdGF0dXNNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgLypcclxuICAgIFRoaXMgaXMgYSBmdW5jdGlvbiBmYWN0b3J5IHdoaWNoIHdpbGwgZ3JhYiB0aGVcclxuICAgIG5lY2Vzc2FyeSBkYXRhIGFuZCB0aGVuIHJldHVybiB0aGUgZnVuY3Rpb24gcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHJldHVybiBmdW5jdGlvbiAoYW5pU2V0dGluZ3MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgc3RhdHVzQmFyLmh0bWwoYDxwPiR7bWVzc2FnZX08L3A+YCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlcGxhY2VYRXF1KGRhdGEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIC8qXHJcbiAgICBSZXBsYWNlIHRoZSB4IGluIHRoZSBkaXNhcHBlYXJlZCBlcXVhdGlvbiB3aXRob3V0IGhhdmluZyB0aGUgeSBkaXNhcHBlYXIuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFdmFsdWF0ZUVxdShhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgeSBhbnN3ZXIgYW5kIHRoZSB4LWNoYW5nZWQgZXF1YXRpb25cclxuICAgICovXHJcbiAgICB2YXIgcG9pbnREYXRhID0gYW5pU2V0dGluZ3MuZGF0YXBvaW50c1thbmlTZXR0aW5ncy5jdXJyZW50Um91bmRdLFxyXG4gICAgICAgIGNoYW5nZUVxdSA9IHBvaW50RGF0YS5jaGFuZ2VFcXU7XHJcblxyXG4gICAgLypcclxuICAgIFNob3cgdGhlIG5ldyBlcXVhdGlvbiB3aXRoIHRoZSByZXBsYWNlZCB4LXZhbHVlIGVxdWF0aW9uXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAga2F0ZXgucmVuZGVyKGAke2NoYW5nZUVxdX1gLCBlcXVQYXJhKTtcclxuXHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0QXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICQoZXF1UGFyYSkuY3NzKFwib3BhY2l0eVwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dZQW5zKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAvKlxyXG4gICAgQW5pbWF0ZSB0aGUgbmV3IHkgdmFsdWUgdG8gdGhlIGNvb3JkaW5hdGVkIHkgY29sdW1uIGFuZCBvbmNlXHJcbiAgICBhbmltYXRpb24gaXMgZG9uZSB0aGVuIHJldHVybiB0aGUgcHJvbWlzZVxyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgJChlcXVQYXJhKVxyXG4gICAgICAgICAgICAuY3NzKFwiYW5pbWF0aW9uXCIsIGB0ZXh0RGlzYXBwZWFyICR7YW5pRHVyYXRpb259cyBlYXNlLWluLW91dGApXHJcbiAgICAgICAgICAgIC5vbmUoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3BvaW50RGF0YS55fWAsIGVxdVBhcmEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFcXVhdGlvbkFnYWluKGFuaVNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHRBcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYWNlWVZhbHVlKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIHktdmFsdWUgYXBwZWFycyBpbiB0aGUgY29ycmVjdCB5LWNvbHVtbiB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2UuXHJcbiAgICAqL1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgdmFyIGlucHV0ID0gJChgdGQjeXZhbCR7cG9pbnREYXRhLmlkICsgMX1gKVswXTtcclxuICAgICAgICAkKGlucHV0KS5odG1sKFwiXCIpO1xyXG4gICAgICAgICQoaW5wdXQpLmFwcGVuZChgPHA+JHtwb2ludERhdGEueX08L3A+YCk7XHJcbiAgICAgICAgcmVzb2x2ZShhbmlTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVzZXRSb3VuZChhbmlTZXR0aW5ncykge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgLypcclxuICAgIEdldCB0aGUgY3VycmVudCByb3VuZCBhbmQgY3VycmVudCBkYXRhIHBvaW50c1xyXG4gICAgKi9cclxuICAgIHZhciBwb2ludERhdGEgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIE9uY2UgdGhlIGVxdWF0aW9uIGlzIGNsZWFyZWQgYW5kIHJlc2V0IHRvIHRoZSBkZWZhdWx0IGVxdWF0aW9uXHJcbiAgICB0aGVuIGZ1bGZpbGwgdGhlIHByb21pc2VcclxuICAgICovXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAkKGVxdVBhcmEpXHJcbiAgICAgICAgICAgIC5jc3MoXCJhbmltYXRpb25cIiwgYHRleHREaXNhcHBlYXIgJHthbmlEdXJhdGlvbn1zIGVhc2UtaW4tb3V0YClcclxuICAgICAgICAgICAgLm9uZShcImFuaW1hdGlvbmVuZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgJChlcXVQYXJhKS5jc3MoXCJvcGFjaXR5XCIsIDApO1xyXG4gICAgICAgICAgICAgICAga2F0ZXgucmVuZGVyKGAke3Byb2ZPcHQuZXF1YXRpb259YCwgZXF1UGFyYSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0RlZmF1bHRFcXUoYW5pU2V0dGluZ3MpIHtcclxuICAgIC8qXHJcbiAgICBSZXR1cm4gdG8gZGVmYXVsdCBiZWdpbm5pbmcgZXF1YXRpb24gZm9yIHRoZSBuZXh0IGFuaW1hdGlvbiBvciBmb3IgdGhlIGVuZFxyXG4gICAgKi9cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgICQoZXF1UGFyYSlcclxuICAgICAgICAgICAgLmNzcyhcImFuaW1hdGlvblwiLCBgdGV4dEFwcGVhciAke2FuaUR1cmF0aW9ufXMgZWFzZS1pbi1vdXRgKVxyXG4gICAgICAgICAgICAub25lKFwiYW5pbWF0aW9uZW5kXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVxdVBhcmEpLmNzcyhcIm9wYWNpdHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGFuaVNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLypcclxuQWNjZXB0IHRoZSBkYXRhcG9pbnQgYW5kIGl0cyBpdGVyYXRvciBhbmQgcGxvdCB0aGF0IHBvaW50IGJlaW5nIHBhc3NlZCB0aHJvdWdoXHJcbiovXHJcbmZ1bmN0aW9uIHBsb3R0ZXIoYW5pU2V0dGluZ3MpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIHBvaW50RGF0YSA9IGFuaVNldHRpbmdzLmRhdGFwb2ludHNbYW5pU2V0dGluZ3MuY3VycmVudFJvdW5kXTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICBhbmlTZXR0aW5ncy5ncmFwaE9wdC5jYWxsYmFjaygpO1xyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVJvdW5kKGFuaVNldHRpbmdzKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgcGxhY2Vob2xkZXIgPSBhbmlTZXR0aW5ncy5kYXRhcG9pbnRzW2FuaVNldHRpbmdzLmN1cnJlbnRSb3VuZF07XHJcblxyXG4gICAgLypcclxuICAgIFRoaXMgZnVuY3Rpb24gYWN0cyBhcyBhbiBpdGVyYXRvciBzbyB0aGF0IHRoZSBwcm9taXNlIGNoYWluIGtub3dzIHdoaWNoXHJcbiAgICBkYXRhcG9pbnQgdG8gaGFuZGxlIGFuZCB0byBhbmltYXRlXHJcbiAgICAqL1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGFuaVNldHRpbmdzLmN1cnJlbnRSb3VuZCArPSAxO1xyXG4gICAgICAgIHBsYWNlaG9sZGVyLnVwZGF0ZVBvaW50ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJlc29sdmUoYW5pU2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBhbmlQcm9taXNlQ2hhaW4oZHBzLCBjaGFpbikge1xyXG4gICAgZHBzLmRhdGFwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YXBvaW50KSB7XHJcbiAgICAgICAgaWYgKGRhdGFwb2ludC51cGRhdGVQb2ludCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJ1bkFuaW1hdGlvbihcInhUb01hY2hpbmVcIiwgZGF0YXBvaW50LngpKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHN0YXR1c01lc3NhZ2UoXCJDYWxjdWxhdGluZ1wiKSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXBsYWNlWEVxdSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihzaG93RXZhbHVhdGVFcXUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oc2hvd1lBbnMpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oc2hvd0VxdWF0aW9uQWdhaW4pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwibWFjaGluZVRvWVwiLCBkYXRhcG9pbnQueSkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocnVuQW5pbWF0aW9uKFwieVRvU3RhdHVzQmFyXCIsIGAoJHtkYXRhcG9pbnQueH0sJHtkYXRhcG9pbnQueX0pYCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oc3RhdHVzTWVzc2FnZShgUGxvdHRpbmcgKCR7ZGF0YXBvaW50Lnh9LCR7ZGF0YXBvaW50Lnl9KWApKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHBsb3R0ZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzZXRSb3VuZClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihzdGF0dXNNZXNzYWdlKGBgKSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihzaG93RGVmYXVsdEVxdSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBjaGFpbiA9IGNoYWluLnRoZW4odXBkYXRlUm91bmQpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vQW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pIHtcclxuICAgIGRwcy5kYXRhcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFwb2ludCkge1xyXG4gICAgICAgIGlmIChkYXRhcG9pbnQudXBkYXRlUG9pbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2hhaW4gPSBjaGFpblxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGxhY2VZVmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwbG90dGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2hhaW4gPSBjaGFpbi50aGVuKHVwZGF0ZVJvdW5kKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKlxyXG5IYW5kbGUgYWxsIENTUyBhbmltYXRpb25zIGJ5IGNyZWF0aW5nIGEgUHJvbWlzZSBjaGFpbiB0aHJvdWdoIGEgZm9yIGxvb3AuXHJcbiovXHJcbmZ1bmN0aW9uIGFuaW1hdG9yQ29udHJvbChkcHMpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBudW1Db250YWluZXIgPSAkKFwiI251bUNvbnRhaW5lclwiKSxcclxuICAgICAgICBjaGFpbiA9IFByb21pc2UucmVzb2x2ZShkcHMpO1xyXG5cclxuICAgIG51bUNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG5cclxuICAgIGlmIChkcHMuZ3JhcGhPcHQuYW5pbWF0ZUhpZGUpIHtcclxuICAgICAgICBub0FuaVByb21pc2VDaGFpbihkcHMsIGNoYWluKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYW5pUHJvbWlzZUNoYWluKGRwcywgY2hhaW4pO1xyXG4gICAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
